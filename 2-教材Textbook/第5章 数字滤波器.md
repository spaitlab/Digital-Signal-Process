# **第5章** **数字滤波器**

## 5.1 **引言**

​	数字滤波器是指完成信号滤波处理功能的，用有限精度算法实现的离散时间线性非时变系统，其输入是一组由模拟信号采样和量化的数字量，其输出是经过变换或处理的另一组数字量。数字滤波器既可以是用数字硬件装配成的一台完成给定运算的专用数字计算机，也可将所需的运算编成程序，由通用计算机来执行。数字滤波器具有稳定性高、精度高、灵活性大等突出优点。随着数字技术的发展，用数字技术实现滤波器的功能愈来愈受到人们的注意和广泛的应用。

### **5.1.1** **滤波器的分类**

​	数字滤波器总体来讲可以分成两大类。一类称为经典滤波器，即一般滤波器，特点是输入信号中有用的频率成分和希望滤除的频率成分各占有不同的频带，通过一个合适的选频滤波器达到滤波器的目的。例如，当输入信号中含有干扰时，如果信号和干扰的频带互不重叠，即可滤除干扰得到想要的信号。但对于一般滤波器，如果信号和干扰的频带互相重叠，则不能完成对干扰的有效滤除，这时需要采用另一类所谓的现代滤波器，例如维纳（Wiener）滤波器、卡尔曼（Kalman）滤波器、自适应滤波器等最佳滤波器；这些滤波器可按照随机信号内部的一些统计规律，从干扰中最佳地提取信号。本课程仅介绍经典滤波器的设计。

​	这些理想滤波器均是不可能实现的，因为它们的单位冲激响应均是非因果且无限长的，设计者只能按照某些准则设计实际滤波器，使之尽可能逼近它。另外，需要特别注意的是，数字滤波器的传输函数$ H\left( {{{\rm{e}}^{j\omega }}} \right) $ 都是以$ 2\pi $为周期的，滤波器的低通频带处于$ 2\pi $的整数倍处，而高通频带处于$ \pi $的奇数倍附近，如图5.1.1。

​	数字滤波器从实现的网络结构或单位冲激响应分类，可以分为**无限长单位冲激响应（IIR）滤波器**和**有限长单位冲激响应（FIR）滤波器**。它们的系统函数分别表示为：

$$
H\left( z \right) = \frac{{Y\left( z \right)}}{{X\left( z \right)}} = \frac{{\sum\limits_{r = 0}^M {{b_r}{z^{ - r}}} }}{{1 - \sum\limits_{k = 1}^N {{a_k}{z^{ - k}}} }}\tag{5.1.1}
$$
$$
H\left( z \right) = \sum\limits_{n = 0}^{N - 1} {h\left( n \right){z^{ - n}}}\tag{5.1.2}
$$
![5.1](./fig/5.1.png)
<center>图 5.1.1 各种数字滤波器的理想幅频响应 </center>

​	式(5.1.1)中，一般满足$ M < N $，这类系统称为$ N $阶IIR系统；当$ M \ge N $时，可视为一个$N$阶IIR子系统与一个$M-N$阶FIR子系统（多项式）的级联。式(5.1.2)所示系统称为$N-1$阶FIR系统。这两种类型的滤波器的设计方法有很大区别，下面将分别进行介绍。

### **5.1.2** **滤波器的技术指标**

​	实际中通常使用的数字滤波器一般属于选频滤波器，数字滤波器的传输函数$ H\left( {{{\rm{e}}^{j\omega }}} \right) $可以表示如下：

$$
H\left( {{{\rm{e}}^{j\omega }}} \right) = \left| {H\left( {{{\rm{e}}^{j\omega }}} \right)} \right|{{\rm{e}}^{j\theta \left( \omega  \right)}}
$$

​	$\left| {H\left( {{{\rm{e}}^{j\omega }}} \right)} \right|$称为幅频特性，$\theta \left( \omega  \right)$称为相频特性。幅频特性表示信号通过该滤波器后各频率的衰减情况，而相频特性反映各频率成分通过滤波器后在时间上的延时情况。因此，即使两个滤波器幅频特性相同，而相频特性不一样，对相同的输入，滤波器输出的信号波形也是不一样的。一般选频滤波器的技术要求由幅频特性给出，而对相频特性一般不做要求，但如果对输出波形有要求，则需要考虑相频特性的技术指标，例如语音合成、波形传输、图像信号处理等，则需要设计成线性相位数字滤波器。

​	滤波器的性能要求往往以频率响应的幅度特性的允许误差来表征，即通带和阻带都允许有一定的误差容限。按照实际需要，确定滤波器的性能要求。通常（但不总是）是在频域中给定数字滤波器的性能要求。图5.1.2所示为低通滤波器的性能要求。虚线表示满足预定性能要求的系统的频率响应，${\omega _p}$为通带截止频率，在通带内幅度响应以的$\pm {\delta _1}$误差接近于1，即

$$
1 - {\delta _1} \le \left| {H({{\rm{e}}^{j\omega }})} \right| \le 1 + {\delta _1}{\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\rm{      }}\left| \omega  \right| \le {\omega _p}
$$
​	${\omega _s}$为阻带起始频率，在阻带内幅度响应以小于的${\delta _2}$误差接近于零，即

$$
\left| {H\left( {{{\rm{e}}^{j\omega }}} \right)} \right| \le {\delta _2}{\rm{         }}{\omega _s} \le \left| \omega  \right| \le \pi
$$
![5.2](./fig/5.2.png)
<center>图5.1.2 逼近理想低通滤波器的误差容限 </center>

​	为了使逼近理想低通滤波器的方法成为可能，还必须提供一宽度为$\left( {{\omega _s} - {\omega _p}} \right)$的不为零的过滤频带。在这个频带内幅度响应从通带平滑地下落到阻带。这里，$\omega$包括${\omega _p}$和${\omega _ s}$，指的是数字域频率，而不是真实频率，或者说是$\omega$沿单位圆周的相角变化。相位特性除了受稳定性和因果性要求的限制，即要求系统函数的极点必须位于单位圆内部，没有其它任何限制。	

​	通带内和阻带内允许的衰减一般用dB数表示，通带内允许的最大衰减用${\alpha _p}$表示，阻带内允许的最小衰减用表${\alpha _s}$示，${\alpha _p}$和${\alpha _s}$分别定义为

$$
{\alpha _p} = 20\log \frac{{\left| {H\left( {{{\rm{e}}^{j0}}} \right)} \right|}}{{\left| {H\left( {{{\rm{e}}^{j{\omega _p}}}} \right)} \right|}}\tag{5.1.3}
$$
$$
{\alpha _s} = 20\log \frac{{\left| {H\left( {{{\rm{e}}^{j0}}} \right)} \right|}}{{\left| {H\left( {{{\rm{e}}^{j{\omega _s}}}} \right)} \right|}}\tag{5.1.4}
$$

​	对于低通滤波器，如将$H\left( {{e^{j0}}} \right)$归一化为1，式(5.1.3)和式(5.1.4)则可分别表示为

$$
{\alpha _p} =  - 20\log \left| {H\left( {{{\rm{e}}^{j{\omega _p}}}} \right)} \right|\tag{5.1.5}
$$
$$
{\alpha _s} =  - 20\log \left| {H\left( {{{\rm{e}}^{j{\omega _s}}}} \right)} \right|\tag{5.1.6}
$$

​	当幅度下降到$\sqrt 2 /2 \approx 0.707$时，$\omega  = {\omega _c}$，此时${\alpha _p} = 3$dB，称${\omega _c}$为3dB通带截止频率。

### **1.1.1** **数字滤波器的设计过程**

​	实际中的数字滤波器设计都是用有限精度算法实现，一般设计步骤包括：

​	（1）根据实际需要确定数字滤波器的技术指标。例如滤波器的频率响应的幅度特性和截止频率等。

​	（2）用一个因果稳定的离散线性非时变系统的系统函数去比逼近这些性能指标。具体而言，就是用这些指标来计算系统函数。IIR滤波器的系统函数是${z^{ - 1}}$的有理函数，FIR滤波器的系统函数是${z^{ - 1}}$的多项式。这样，滤波器的设计问题，变成了一个数学逼近问题，即用一个因果稳定的系统函数去逼近给定的性能要求，以确定滤波器系数。

​	（3）用有限精度的运算实现所设计的系统。这里包括选择运算结构，及对滤波器的系数、输入变童、中间变量，和输出变量量化到固定字长。

​	（4）通过模拟、验证所设计的系统是否符合给定性能要求。根据这步的结果决定是否对第 2步和第3步作修改，以满足技术要求。

​	IIR滤波器和FIR滤波器的设计方法是很不相同的。IIR滤波器设计方法有两类，经常采用借助于模拟滤波器的设计方法来进行。其设计步骤是：先设计模拟原型滤波器，得到其传输函数，然后将按某种方法转换成数字滤波器的系统函数。模拟滤波器设计方法已经很成熟，有完整的设计公式，还有完善的图表可供查阅，并且还有一些典型的滤波器类型可供设计者使用，得到的是闭合形式的公式。FIR滤波器不能采用先设计模拟滤波器然后再转换成数字滤波器的方法，经常使用的设计方法是窗函数法和频率采样法，需要通过计算机辅助设计来完成。



## 5.2 **无限长单位脉冲响应数字滤波器结构**

​	数字滤波器可以用差分方程、单位采样响应、以及系统函数等表示。实现一个数字滤波器需要几种基本的运算单元：加法器、单位延时和常数乘法器。这些基本的单元可以有两种表示法：方框图法和信号流图法，因而一个数字滤波器的运算结构也有这两种表示方法，如图5.2.1所示。用方框图表示比较直观，用信号流图表示则更加简单方便。 

![5.2.1](./fig/5.2.1.png)

<center>图 5.2.1 基本运算的方框图表示和信号流图表示</center>

​	一个给定的输入输出关系，可以用多种不同的数字网络来实现。在不考虑量化影响时，这些不同的实现方法是等效的；但在考虑量化影响时，这些不同的实现方法性能上就有差异。因此，运算结构是很重要的，同一系统函数$H(z)$，运算结构的不同，将会影响系统的精度、误差、 稳定性、经济性以及运算速度等许多重要性能。

​	不同结构所需的存储单元及乘法次数是不同的，前者影响复杂性，后者影响运算速度。无限长单位脉冲响应（IIR）滤波器与有限长单位脉冲响应（FIR）滤波器在结构上有各自不同的特点，我们将分别对它们加以讨论。

​	IIR数字滤波器的基本结构，包括：直接I型、直接II型（典范型）、级联型、并联型。

### **5.2.1** **直接型**

#### **1.** **直接**Ⅰ**型**

​	IIR滤波器的系统函数

$$
H(z) = \frac{{\sum\limits_{r = 0}^M {{b_r}{z^{ - r}}} }}{{1 - \sum\limits_{k = 1}^N {{a_k}{z^{ - k}}} }}\tag{5.2.1}
$$
​	对应的差分方程为

$$
y\left( n \right) = \sum\limits_{r = 0}^M {{b_r}x\left( {n - r} \right)}  + \sum\limits_{k = 1}^N {{a_k}y\left( {n - k} \right)} \tag{5.2.2}
$$

​	$y\left( n \right)$由两部分相加构成：第一部分$\sum\limits_{r = 0}^M {{b_r}x\left( {n - r} \right)}$是一个对输入$x\left( n \right)$的$M$节延时链结构，每节延时抽头后加权相加；第二部分$\sum\limits_{k = 1}^N {{a_k}y\left( {n - k} \right)} $是一个对$y\left( n \right)$的延时链结构，每级延时抽头后加权相加，因此是一个反馈网络。

​	这种结构型式称为直接I型，如图5.2.2所示。其中图5.2.2(a)为方框图，图5.2.2(b)为信号流图。为了方便，图中画的是$M = N$的情况，若$M \ne N$，$N$阶滤波器需要$N+M$级延时单元。

![5.2.2](./fig/5.2.2.png)
<center>图5.2.2 (a) 直接I型结构方框图</center>

![5.2.3](./fig/5.2.3.png)

<center>图 5.2.2 (b) 直接I型结构信号流图</center>

#### **2.** **直接II型**

​	将 (5.2.1) 式改写成下式（当$M=N$的情况）
$$
H\left( z \right) = \frac{{Y\left( z \right)}}{{X\left( z \right)}} = \frac{{Y\left( z \right)}}{{W\left( z \right)}} \cdot \frac{{W\left( z \right)}}{{X\left( z \right)}} = \left( {\sum\limits_{r = 0}^N {{b_r}{z^{ - r}}} } \right)\left( {\frac{1}{{1 - \sum\limits_{k = 1}^N {{a_k}{z^{ - k}}} }}} \right)\tag{5.2.3}
$$

​	因此$H\left( z \right)$可视为分子多项式$\sum\limits_{r = 0}^N {{b_r}{z^{ - r}}} $与分母多项式$1 - \sum\limits_{k = 1}^N {{a_k}{z^{ - k}}} $的倒数所构成的两个子系统函数的乘积，这相应于两子系统的级联。其中第一子系统实现零点为

$$
{H_1}\left( z \right) = \frac{{Y\left( z \right)}}{{W\left( z \right)}} = \sum\limits_{r = 0}^N {{b_r}{z^{ - r}}}
$$

​	故得

$$
Y\left( z \right) = \sum\limits_{r = 0}^N {{b_r}{z^{ - r}}} W\left( z \right)
$$

​	其时域表示为

$$
y\left( n \right) = \sum\limits_{r = 0}^N {{b_r}w\left( {n - r} \right)} 
$$

​	第二子系统实现极点为
$$
{H_2}\left( z \right) = \frac{{W\left( z \right)}}{{X\left( z \right)}} = \frac{1}{{1 - \sum\limits_{k = 1}^N {{a_k}{z^{ - k}}} }}
$$

​	经整理后得
$$
W\left( z \right) = X\left( z \right) + \sum\limits_{k = 1}^N {{a_k}{z^{ - k}}} W\left( z \right)
$$
​	其时域表示为
$$
w\left( n \right) = x\left( n \right) + \sum\limits_{k = 1}^N {{a_k}w\left( {n - k} \right)}\tag{5.2.4}
$$

​	综上所述，可得图5.2.3的实现结构。其中图5.2.3 (a)为方框图，图5.2.3 (b)为信号流图。

![5.2.4](./fig/5.2.4.png)
<center>图5.2.3(a) 直接II型的变型结构方框图</center>

![5.2.5](./fig/5.2.5.png)

<center>图 5.2.3(b) 直接II型的变型结构的信号流图<center>

​	如将图5.2.3中相同输出的延迟单元合成一个，则得图5.2.4的结构图。它比结构图5.2.3的延迟单元少一倍，$N$阶滤波器，只需$N$级延迟单元，这是实现$N$阶滤波器所必须的最少数量的延迟单元。这种结构称为直接II型。有时将直接I型简称为直接型，而将直接II型称为典范型。

![5.2.6](./fig/5.2.6.png)
<center>图5.2.4 (a) 直接II型结构方框图</center>

![5.2.7](./fig/5.2.7.png)

<center>图5.2.4 (a) 直接II型结构信号流图<center>

#### **3.** **转置型**

​	线性信号流图理论中有许多运算处理方法，可在保持输入和输出之间的传输关系不变的情况下，将信号流图变换成各种不同的形式。其中流图转置的方法可导出一种转置滤波器结构。具体地讲，就是把网络中所有支路方向都颠倒成反向，且输入输出的位置互相调换一下。对于单输入单输出系统来说，倒转后的结构和原结构的系统函数相同，但对有限字长的影响而言.转置结构与原结构性质不同。

​	将转置原理应用于图5.2.4的直接II型网络，并按照习惯，使输入在左边输出在右边，则得到图5.2.5所示的直接II型的转置。

​	直接I、II型结构优点是简单直观。它们的共同缺点是：系数${a_k}$对滤波器性能的控制关系不直接，因此调整不便。更严重的是这种结构的极点位置灵敏度太大，对字长效应太敏感，易于出现不稳定现象，产生较大误差。

![5.2.8](./fig/5.2.8.png)
<center>图5.2.5 转置的直接II型结构方框图<center>

### **5.2.2** **级联型** 

​	将(5.2.1)式的按零点和极点进行因式分解，则可表示成

$$
H\left( z \right) = {\rm{ }}\frac{{\sum\limits_{r = 0}^M {{b_r}{z^{ - r}}} }}{{1 - \sum\limits_{k = 1}^N {{a_k}{z^{ - k}}} }} = {\rm{ }}A\frac{{\prod\limits_{r = 1}^M {\left( {1 - {c_r}{z^{ - 1}}} \right)} }}{{\prod\limits_{k = 1}^N {\left( {1 - {d_k}{z^{ - 1}}} \right)} }}
$$
​	式中A为归一化常数。由于系统函数$ H\left( z \right) $的系数都是实系数，故零、极点${c_r}$，${d_k}$只有两种情况：或者是实根，或者是共轭复根，即

$$
H\left( z \right) = A\frac{{\prod\limits_{i = 1}^{{M_1}} {\left( {1 - {g_i}{z^{ - 1}}} \right)\prod\limits_{i = 1}^{{M_2}} {\left( {1 - {h_i}{z^{ - 1}}} \right)\left( {1 - {h_i}^*{z^{ - 1}}} \right)} } }}{{\prod\limits_{i = 1}^{{N_1}} {\left( {1 - {p_i}{z^{ - 1}}} \right)\prod\limits_{i = 1}^{{N_2}} {\left( {1 - {q_i}{z^{ - 1}}} \right)\left( {1 - {q_i}^*{z^{ - 1}}} \right)} } }}\tag{5.2.5}
$$
​	式中$M = {M_1} + 2{M_2}$，$N = {N_1} + 2{N_2}$，${g_i}$表示实零点，${p_i}$表示实极点，${h_i}$和$h_i^*$表示复共轭零点, ${q_i}$和$q_i^*$表示复共轭极点。每一对共轭因子合并起来，就可以构成一个实系数的二阶因子。因此

$$
H\left( z \right) = A\frac{{\prod\limits_{{\rm{i}} = 1}^{{M_1}} {\left( {1 - {g_i}{z^{ - 1}}} \right)\prod\limits_{i = 1}^{{M_2}} {\left( {1 + {\beta _{1i}}{z^{ - 1}} + {\beta _{2i}}{z^{ - 2}}} \right)} } }}{{\prod\limits_{i = 1}^{{N_1}} {\left( {1 - {p_i}{z^{ - 1}}} \right)\prod\limits_{i = 1}^{{N_2}} {\left( {1 - {\alpha _{1i}}{z^{ - 1}} - {\alpha _{2i}}{z^{ - 2}}} \right)} } }}\tag{5.2.6}
$$

​	(5.2.6) 式给出了任意系统均可由一阶和二阶子系统级联构成表达式。如果我们假设实数极点和实数零点已成对合并，井把单实根因子看作二阶因子的特例，即二次项系数${\alpha _{2i}}$，${\beta _{2i}}$等于零的二阶因子，同时假设$M \le N$，则整个函数$H\left( z \right)$可分解为实系数二项因子的形式。

$$
H\left( z \right) = A\prod\limits_{i = 1}^L {\frac{{1 + {\beta _{1i}}{z^{ - 1}} + {\beta _{2i}}{z^{ - 2}}}}{{1 - {\alpha _{1i}}{z^{ - 1}} - {\alpha _{2i}}{z^{ - 2}}}}}  = {\rm{A}}\prod\limits_{i = 1}^L {{H_i}\left( z \right)} \tag{5.2.7}
$$
​	其中${H_i}\left( z \right) = \frac{{1 + {\beta _{1i}}{z^{ - 1}} + {\beta _{2i}}{z^{ - 2}}}}{{1 - {\alpha _{1i}}{z^{ - 1}} - {\alpha _{2i}}{z^{ - 2}}}}$，$L$表示$\frac{{(N + 1)}}{2}$中最大整数。${H_i}\left( z \right)$称为滤波器的二阶基本节，可以采用直接 Ⅱ 型结构实现，如图5.2.6所示。其中图5.2.6 (a)为方框图，图5.2.6 (b)为信号流图。

![5.2.9](./fig/5.2.9.png)
<center>图5.2.6 (a) 方框图<center>

![5.2.10](./fig/5.2.10.png)
<center>(b) 信号流图<center>
<center>图 5.2.6 直接II型级联结构的二阶基本节<center>

​	整个滤波器则是${H_i}\left( z \right)$的级联，如图5.2.7所示。

![5.2.11](./fig/5.2.11.png)
<center>图5.2.7 级联型结构<center>

​	级联型结构的一个重要优点是存储单元需要较少，硬件实现时，可以用一个二阶节进行时分复用。

​	级联型结构的另一特点是，它的每一个基本节都是关系到滤波器的一对极点和一对零点。调整系数${\beta _{1i}}$、${\beta _{2i}}$，就单独的调整了滤波器的第$i$对零点而不影响其它任何零、极点。同样，调整系数${\alpha _{1i}}$、$ {\alpha _{2i}}$也就单独调整了第$i$对极点.因此，这种结构便于准确地实现滤波器的极、零点，也便于调整滤波器的频率k响应性能。

​	由 (5.2.7) 式可见，$H\left( z \right)$中的分子分母各有$L$个二阶因子，它们可以任意两两搭配形成$L!$个基本节,这些基本节中选出的任意$L$个的级联次序又可有$L!$种排法，但完成的却是同一个系统函数$H\left( z \right)$。实际工作时，由于二进制数的字长有一定限度，因此不同的排列，运算误差就会各不相同。如何才能得到最好的排列，以使运算误差最小，这是最优化问题，此处不作讨论。另外级联的各基本节间要有电平的放大或缩小，以使级间输出变量不要太大或太小。级间输出变量太大，易使数字滤波器在运算过程中产生溢出；级间输出变$M$太小，则输出端的信号噪声比会太小。

### **5.2.3** **并联型**

​	将 (5.2.1) 式的系统函数$H\left( z \right)$展成部分分式之和，即	
$$
H\left( z \right) = \sum\limits_{k = 1}^{{N_1}} {\frac{{{A_k}}}{{1 - {g_k}{z^{ - 1}}}}}  + \sum\limits_{k = 1}^{{N_2}} {\frac{{Bk\left( {1 - {e_k}{z^{ - 1}}} \right)}}{{\left( {1 - {d_k}{z^{ - 1}}} \right)\left( {1 - d_k^*{z^{ - 1}}} \right)}}}  + \sum\limits_{k = 0}^{M - N} {{G_k}{z^{ - k}}} \tag{5.2.8}
$$
​	式中${N_1} + 2{N_2} = N$，$d_k^*$是${d_k}$的共轭复数。由于 (5.2.1) 中系数${a_k}$，${b_r}$是实数，故${A_k}$，${B_k}$，${G_k}$，${g_k}$及${e_k}$为全是实数。如果$M < N$,则 (5.2.8) 式中不包含$\sum\limits_{k = 0}^{M - N} {{G_k}{z^{ - k}}} $项，如果$M = N$，则$\sum\limits_{k = 0}^{M - N} {{G_k}{z^{ - k}}} $项变为${G_0}$一般IIR系统皆满足$M \le N$的条件。当$M = N$时，(5.2.8) 式成为
$$
H\left( z \right) = \sum\limits_{k = 1}^{{N_1}} {\frac{{{A_k}}}{{1 - {g_k}{z^{ - 1}}}}}  + \sum\limits_{k = 1}^{{N_2}} {\frac{{{r_{0k}} + {r_{1k}}{z^{ - 1}}}}{{1 - {\alpha _{1k}}{z^{ - 1}} - {\alpha _{2k}}{z^{ - 2}}}}}  + {G_0}\tag{5.2.9}
$$
​	总系统函数为各部分系统函数之和时，则表示总系统为各相应子系统的并联。因此，(5.2.9) 式可以解释为一阶和二阶系统的并联组合，其结构实现如图5.2.8所示。每个一阶或二阶子系统可用直接II型实现，如图5.2.9所示。也可将 (5.2.9) 式中实根部分两两合并，形成二阶分式，以便系统全部采用二阶系统结构。

​	显然，并联结构运算速度快，也可以单独调整极点位置，但不能像级联型那样直接调整零点，因为并联型各二阶节网络的零点，并非整个系统函数的零点。因此，当要求准确传输零点时，以采用级联型为宜。另外，并联型各基本节的误差互不影响。

![5.2.12](./fig/5.2.12.png)
<center>图5.2.8  并联型结构方框图<center>

![5.2.13](./fig/5.2.13.png)
<center>图5.2.9 (a) 并联结构的一阶基本节方框图<center>

![5.2.14](./fig/5.2.14.png)
<center>图5.2.9 (c) 并联结构的二阶基本节方框图<center>

![5.2.15](./fig/5.2.15.png)
<center>图5.2.9 (b) 并联结构的一阶基本节信号流图  图5.2.9 (d) 并联结构的二阶基本节信号流图<center>
​	图5.2.9 (b) 并联结构的一阶基本节信号流图  图5.2.9 (d) 并联结构的二阶基本节信号流图

![5.2.16](./fig/5.2.16.png)
<center>图 5.2.10 基本节构成的并联型信号流图<center>
​	除以上三种最基本的递归型结构外，还有级并联混合结构，最少乘法结构，把$H\left( z \right)$展成连分式实现的梯形结构等。

**例程5.2.1**

​	采用直接型实现系统函数如下的IIR数字滤波器，并求单位脉冲响应$h\left( n \right)$。
$$
H\left( z \right) = \frac{{\sum\limits_{r = 0}^M {{b_r}{z^{ - r}}} }}{{1 - \sum\limits_{k = 1}^N {{a_k}{z^{ - k}}} }} = \frac{{1 - 3{z^{ - 1}} + 11{z^{ - 2}} + 27{z^{ - 3}} + 18{z^{ - 4}}}}{{16 + 12{z^{ - 1}} + 2{z^{ - 2}} - 4{z^{ - 3}} - 2{z^{ - 4}}}}\
$$

```matlab
b = [1,-3,13,27,18];
a = [16,12,2,-4,-2];
impz(b,a,30);
```

![5.2.17](./fig/5.2.17.png)

<center>图5.2.11 数字滤波器单位脉冲响应<center>

**例程5.2.2**

​	用级联结构实现如下系统函数的IIR数字滤波器，并求单位脉冲响应。
$$
H\left( z \right) = \frac{{\sum\limits_{r = 0}^M {{b_r}{z^{ - r}}} }}{{1 - \sum\limits_{k = 1}^N {{a_k}{z^{ - k}}} }} = \frac{{3\left( {1 + {z^{ - 1}}} \right)\left( {1 - 3.14{z^{ - 1}} + {z^{ - 2}}} \right)}}{{\left( {1 - 0.6{z^{ - 1}}} \right)\left( {1 + 0.7{z^{ - 1}} + 0.72{z^{ - 2}}} \right)}}\
$$

```matlab
sos = [3 3 0 1 -0.6 0; 1 -3.14 1 1 0.7 0.72];
impz(sos);
```

![5.2.18](./fig/5.2.18.png)

<center>图5.2.12 数字滤波器单位脉冲响应<center>

##           5.3  有限长单位脉冲响应数字滤波器结构

​	有限长单位冲激响应（FIR）数字滤波器的基本结构，包括：直接型（横截型、卷积型）、级联型、频率采样型、快速卷积型、线性相位FIR滤波器的结构。

​	FIR滤波器的系统函数为
$$
H\left( z \right) = \sum\limits_{n = 0}^{N - 1} {h\left( n \right){z^{ - n}}}\tag {5.3.1}
$$
其差分方程为
$$
y\left( n \right) = \sum\limits_{k = 0}^{N - 1} {h\left( k \right)x\left( {n - k} \right)}\tag {5.3.2}
$$
其基本结构形式有下述几种。

### 5.3.1 直接型 

​	由 (5.3.2) 式可得出图5.3.1所示的直接型结构。在第2章中我们称这种结构为抽头延迟线滤波器，或横向滤波器，由于 (5.3.2) 式就是信号的卷积型式，故称为卷积型结构。图5.3.1 也可看成是图5.2.4在各$${a_k} = 0$$，$${b_k} = h\left( k \right)$$时的特例。

![img](./fig/5.3.1(a).png)

​                                                                                                             (a) 方框图

![img](./fig/5.3.1(b).png)

​                                                                                                            (b) 信号流图

​                                                                                              图5.3.1 FIR滤波器直接型结构

 

​	将转置理论应用于图5.3.1 可得到图5.3.2 的转置直接型结构。

![img](./fig/5.3.2(a).png)

<center>(a) 转置型方框图</center>

![img](.\fig\5.3.2（b）.png)

<center>(b) 转置型信号流图


<center>图5.3.2




### 5.3.2 级联型 

​	将 (5.3.1) 式的系统函数分解成若干一阶和二阶多项式的连乘积


$$
H\left( z \right) = \prod\limits_{k = 1}^{{M_1}} {H1k} \left( z \right)\prod\limits_{k = 1}^{{M_2}} {H2k} \left( z \right)
$$
​	则可构成如图5.3.3(a)所示的级联型结构。其中，$${H_{1k}}(z) = a_{0k}^{\left( 1 \right)} + a_{1k}^{\left( 1 \right)}{z^{ - 1}}$$为一阶节；$${H_{2k}}(z) = a_{0k}^{\left( 2 \right)} + a_{1k}^{\left( 2 \right)}{z^{ - 1}} + a_{2k}^{\left( 2 \right)}{z^{ - 2}}$$为二阶节。每个一阶节、二阶节可用图5.3.1所示之直接型结抅实现。当时$${M_1} = {M_2} = 1$$，即可得图5.3.3(b)所示的具体结构。这种结构的每一节都便于控制零点，在需要控制传输零点时可以采用。但是它所需要的系数比直接型!$$h\left( n \right)$$的多，所需要的乘法运算也比直接型多。直接型结构和级联型结构在雷达信号处理中作为相关器和对消器等获得了广泛的应用。

![img](fig/5.3.3(a).png)

<center>(a) 方框图


![5.3.3(b)](fig\5.3.3(b).png)



<center>(b) 基本节方框图


<center>图5.3.3 FIR级



### 5.3.3 线性相位FIR系统网络结构 

​	FIR系统的最主要特性之一就是它可以构成具有线性相位特性的滤波器。所谓线性相位特性是指滤波器对不同频率的正弦波所产生的相移和正弦波的频率成直线关系。因此，在滤波器通带内的信号通过滤波器后，除了由相频特性的斜率决定的延迟外，可以不失真地保留通带以内的全部信号。

​	线性相位的因果的FIR系统的单位采样响应具有如下特性      
$$
h\left( n \right) =  \pm h\left( {N - 1 - n} \right)\tag {5.3.3}
$$
​      

此时 (5.3.1) 式可分两种情况写出。

当N为偶数时
$$
H\left( z \right) = \sum\limits_{n = 0}^{N - 1} {h\left( n \right){z^{ - n}} = } \sum\limits_{n = 0}^{\frac{N}{2} - 1} {h\left( n \right){z^{ - n}} + \sum\limits_{n = \frac{N}{2}}^{N - 1} {h\left( n \right){z^{ - n}}} }
$$

$$
= \sum\limits_{n = 0}^{\frac{N}{2} - 1} {h\left( n \right){z^{ - n}} + } \sum\limits_{n = 0}^{\frac{N}{2} - 1} {h\left( {N - 1 - n} \right){z^{ - \left( {N - 1 - n} \right)}}}
$$

利用 (5.3.3) 式可得到            
$$
H\left( z \right) = \sum\limits_{n = 0}^{\frac{N}{2} - 1} {h\left( n \right)\left[ {{z^{ - n}} \pm {z^{ - (N - 1 - n)}}} \right]} \tag {5.3.4}
$$


当$$N$$​为奇数时，易于证明    
$$
H\left( z \right) = \sum\limits_{n = 0}^{N - 1} {h\left( n \right){z^{ - n}}}  = \sum\limits_{n = 0}^{\frac{{N{\rm{ - }}1}}{2} - 1} {h\left( n \right)\left[ {{z^{ - n}} \pm {z^{ - \left( {N - 1 - n} \right)}}} \right] + h\left( {\frac{{N - 1}}{2}} \right)} {z^{ - \left( {\frac{{N - 1}}{2}} \right)}}\tag {5.3.5}
$$


​	(5.3.4) 式及 (5.3.5) 式的FIR系统的非递归型实现结构，分别如图5.3.3 所示。 由图可见，这里仅需$$\frac{N}{2}$$($$N$$为偶数时)个或$$\frac{{N + 1}}{2}$$（$$N$$为奇数时）个乘法运算，而不是如图5.3.1 所示的需$$N$$次乘法。在$$h\left( n \right) =  - h\left( {N - 1 - n} \right)$$（即$$h\left( n \right)$$为奇对称），$$N$$为奇数的情况下，$$h\left( {\frac{{N - 1}}{2}} \right) =  - h\left( {N - 1 - \frac{{N - 1}}{2}} \right) =  - h\left( {\frac{{N - 1}}{2}} \right)$$因此$$h\left( n \right)$$的中间项$$h\left( {\frac{{N - 1}}{2}} \right)$$必须为零，这时图5.3.3(c)(d)中的$$h\left( {\frac{{N - 1}}{2}} \right)$$为零。我们也可从图5.3.3 得到其相应的转置型式。

![5.3.4](.\fig\5.3.4(a).png)

<center>(a) N为偶数 方框图


![5.3.4（b）](.\fig\5.3.4（b）.png)

<center>(b) N为偶数 信号流图


![5.3.4](.\fig\5.3.4(c).png)

<center>(c) N为奇数 方框图


![5.3.4（d）](.\fig\5.3.4（d）.png)

<center>(d) N为奇数 信号流图


<center>图5.3.3线性相位FIR滤波器直接型结构


其中：$$h\left( n \right)$$偶对称时$$ \pm 1$$取+1，$$h\left( n \right)$$奇对称时取$$ \pm 1$$取-1

 

### 5.3.4 频率采样型 

​	系统函数$$H\left( z \right)$$在单位圆上作*N*等分采样的采样值就是的离散傅里叶变换$$H\left( k \right)$$

$$
H\left( k \right) = H\left( {W_N^{ - k}} \right) = \left| {H(k)} \right|{{\rm{e}}^{j\theta (k)}} = \sum\limits_{n = 0}^{N - 1} {h\left( n \right){{\rm{e}}^{ - j\frac{{2\pi }}{N}kn}}} 
$$
根据 (3.6.5) 式可得 
$$
H\left( z \right) = \left( {1 - {z^{ - N}}} \right)\frac{1}{N}\sum\limits_{k = 0}^{N - 1} {\frac{{H\left( k \right)}}{{1 - W_N^{ - k}{z^{ - 1}}}}}\tag {5.3.6}
$$
​	由上式可见，FIR系统可用一子FIR系统$$\left( {1 - {z^{ - N}}} \right)$$和一子IIR系统级$$\sum\limits_{k = 0}^{N - 1} {\frac{{H\left( k \right)}}{{1 - W_N^{ - k}{z^{ - 1}}}}} $$联实现，如图5.3.4所示。

![5.3.5](.\fig\5.3.5(a).png)

<center>(a) 方框图


![5.3.5](fig/5.3.5(b).png)

<center>(b)信号流图


<center>图5.3.4频率采样型结构




​	子FIR系统$$\left( {1 - {z^{ - N}}} \right)$$是一个由*N*节延迟单元组成的梳状滤波器，如图5.3.5所示。$$\left( {1 - {z^{ - N}}} \right)$$在单位圆上有*N*个等分的零点

$$
\begin{array}{l}
1 - {z^{ - N}} = 0\\
{z_k} = {{\rm{e}}^{j\frac{{2\pi }}{N}k}}{\rm{             }}k = 0,1, \ldots N - 1
\end{array}
$$
梳状滤波器的频率响应

$$
H\left( {{{\rm{e}}^{j\omega }}} \right) = 1 - {{\rm{e}}^{ - jN\omega }}
$$
其幅度特性为   

$$
\left| {H\left( {{{\rm{e}}^{j\omega }}} \right)} \right| = 2\left| {\sin \left( {\frac{N}{2}\omega } \right)} \right|
$$
​	子IIR系统是*N*个$$\frac{{H\left( k \right)}}{{1 - W_N^{ - k}{z^{ - 1}}}}$$型的分式和的形式，所以其实现采用了图5.3.4的并联结构。每一个一阶网络$$\frac{{H\left( k \right)}}{{1 - W_N^{ - k}{z^{ - 1}}}}$$在单位圆上有一极点$${z_k} = W_N^{ - k} = {{\rm{e}}^{j\frac{{2\pi }}{N}k}}$$因此网络对频率为是$$\omega  = \frac{{2\pi }}{N}k$$的响应是$$\infty $$，是一个谐振频率为的无耗谐振器。并联谐振器的极点正好各自抵消一个梳状滤波器的零点，从而使在频率点$$\omega  = \frac{{2\pi }}{N}k$$处的响应就是$$H\left( k \right)$$*。*因此控制滤波器的响应很直接，这正是频率采样型结构的特点。

 ![5.3.6](.\fig\5.3.6.png)

<center>图 5.3.5 梳状滤波器的结构及频率响应幅度


​	频率采样型结构有两个问题。第一个问题是所有谐振器的极点都在单位圆上，由系数$$W_N^{ - k}$$决定，当系数量化时，这此极点会移动,因此，系统稳定裕度为零，实际上是不能用的。实践中只好将所有谐振器的极点设置在半径$$r$$小于1又接近于1的圆周上，而子FIR系统的零点又需和这些极点重合以互相抵消，故梳状滤波器的零点也移到$$r$$圆上，如图5.3.6 所示。

![5.3.7](.\fig\5.3.7.png)

<center>图5.3.6 采样点改到r或近似等于1的圆上


实现修正后的系统函数为

$$
H\left( z \right) = \frac{{\left( {1 - {r^N}{z^{ - N}}} \right)}}{N}\sum\limits_{k = 0}^{N - 1} {\frac{{{H_r}\left( k \right)}}{{1 - r{W^{ - k}}_N{z^{ - 1}}}}} 
$$
其中${H_r}\left( k \right)$是修正点上的采样值，因$$r \approx 1$$，因此

$$
{H_r}\left( k \right) = H\left( z \right){|_{z = rW_N^{ - k}}} = H\left( {rW_N^{ - k}} \right) \approx H\left( {W_N^{ - k}} \right) = H\left( k \right)
$$
故            
$$
H\left( z \right) \approx \frac{{\left( {1 - {r^N}{z^{ - N}}} \right)}}{N}\sum\limits_{k = 0}^{N - 1} {\frac{{H\left( k \right)}}{{1 - rW_N^{ - k}{z^{ - 1}}}}}\tag {5.3.7}
$$
​	第二个问题：因$W_N^{ - k}$及$$H\left( k \right)$$都是复数，因此按图5.3.4结构实现FIR系统需要进行大量的复数运算，比实数运算复杂。但在系统的单位采样响应为$$h\left( n \right)$$实序列时，可得到局部改善。

​	由第3章讨论的DFT奇偶对称特性可知：当时间函数是实函数时，频率函数的模是偶函数，而相角是奇函数，即

$$
\begin{array}{l}
\left| {H\left( k \right)} \right| = \left| {H\left( {N - k} \right)} \right|\\
\theta \left( k \right) =  - \theta \left( {N - k} \right)
\end{array}
$$
或者表示为

$$
H\left( k \right) = {H^*}\left( {N - k} \right){\rm{   }}k = 1,2,....N - 1
$$
另外，为了使系数为实数，可将谐振器的共轭根合并。若谐振器的根为：

$$
{z_k} = W_N^{ - k} = {e^{j\frac{{2\pi }}{N}k}}
$$
​	与其对称的根${W^{ - \left( {N - k} \right)}} = W_N^k = {\left( {W_N^{ - k}} \right)^*}$是共轭的。

​	根据以上所述，可将第$k$个及第$N - k$个谐振器合并为一个二阶网络 

$$
\begin{array}{l}
H(z) \approx \frac{{H(k)}}{{1 - rW_N^{ - k}{z^{ - 1}}}} + \frac{{H(N - k)}}{{1 - rW_N^{ - (N - k)}{z^{ - 1}}}}{\rm{        }}\\
{\rm{          = }}\frac{{H(k)}}{{1 - rW_N^{ - k}{z^{ - 1}}}} + \frac{{H(N - k)}}{{1 - {{\left( {rW_N^{ - k}} \right)}^*}{z^{ - 1}}}}\\
{\rm{         }}{\kern 1pt} {\rm{ = }}\frac{{2\left| {H(k)} \right|\left\{ {\cos \left[ {\theta (k)} \right] - r{z^{ - 1}}\cos \left[ {\theta (k) - \frac{{2\pi k}}{N}} \right]} \right\}}}{{1 - 2r{z^{ - 1}}\cos \frac{{2\pi k}}{N} + {r^2}{z^{ - 2}}}}{\rm{       }}0 < k < \frac{N}{2}
\end{array}
$$
此系统函数所对应的结构如图5.3.7 所示，这里全部都是实数运算。

![img](.\fig\5.3.8(a).png)

<center>(a) 方框图


![5.3.8（b）](./fig/5.3.8（b）.png)

<center>(a)   信号流图


图5.3.7 二阶网络结构

​	可以发现，按照上述合并法，图5.3.4中的极点位于$W_N^0$的一阶网络，${H_0}\left( z \right)$与为$N$偶数时极点位于$W_N^{ - \frac{N}{2}}$的一阶网络${H_{\frac{N}{2}}}\left( z \right)$合并不了。

​	总结以上所述，可得改进后的总结构如图5.3.8所示。

​	当$N$为偶数时

$$
H\left( z \right) = \frac{{\left( {1 - {r^N}{z^{ - N}}} \right)}}{N}\left[ {\frac{{H\left( 0 \right)}}{{1 - r{z^{ - 1}}}} + \frac{{H\left( {\frac{N}{2}} \right)}}{{1 + r{z^{ - 1}}}} + \sum\limits_{k = 1}^{\frac{N}{2} - 1} {\frac{{2\left| {H\left( k \right)} \right|\left\{ {\cos \left[ {\theta \left( k \right)} \right] - r{z^{ - 1}}\cos \left[ {\theta \left( k \right) - \frac{{2\pi k}}{N}} \right]} \right\}}}{{1 - 2r{z^{ - 1}}\cos \frac{{2\pi k}}{N} + {r^2}{z^{ - 2}}}}} } \right]
$$
其中                     
$$
[\begin{array}{l}
{H_0}\left( z \right) = \frac{{H\left( 0 \right)}}{{1 - r{z^{ - 1}}}}{\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} \\
{\kern 1pt} {H_{\frac{N}{2}}}\left( z \right) = \frac{{H\left( {\frac{N}{2}} \right)}}{{1 + r{z^{ - 1}}}}
\end{array}
$$
是一阶网络，其结构如图5.3.9所示。其余网络都是二阶的。

​	当$N$为奇数时

$$
H\left( z \right) = \frac{{\left( {1 - {r^N}{z^{ - N}}} \right)}}{N}\left[ {\frac{{H\left( 0 \right)}}{{1 - r{z^{ - 1}}}} + \sum\limits_{k = 1}^{\frac{N}{2} - 1} {\frac{{2\left| {H\left( k \right)} \right|\left\{ {\cos \left[ {\theta \left( k \right)} \right] - r{z^{ - 1}}\cos \left[ {\theta \left( k \right) - \frac{{2\pi k}}{N}} \right]} \right\}}}{{1 - 2r{z^{ - 1}}\cos \frac{{2\pi k}}{N} + {r^2}{z^{ - 2}}}}} } \right]
$$
只有一个$${H_0}\left( z \right)$$一阶网络

![5.3.9](.\fig\5.3.9(a).png)

<center>(a) 方框图


![5.3.9](fig/5.3.9(b).png)

<center>(b)   信号流图


<center>图5.3.8修正后的频率采样型结构




![5.3.10（a）](.\fig\5.3.10（a）.png)

<center>(a) 方框图


![5.3.10（b）](.\fig\5.3.10（b）.png)

<center>(b) 信号流图


<center>图5.3.9实根一阶网络结构


​	一般来说，频率采样结构比较复杂，所需存储器及乘法器也比较多，但频率采样法也有其优点。由图5.3.8可见，每个二阶节均要乘一与频率采样值成比例的数值$2\left| {H(k)} \right|$，如这些值中某些是零（比如窄带低通或带通滤波器的情况），则对应的二阶节就可省去，从而使结构大为简化。另外，它的每个部分都具有很高的规范性，二阶节很多时，设计也并不复杂。

### 5.3.5 快速卷积型

​	FIR滤波器的系统函数为$H\left( z \right) = \sum\limits_{n = 0}^{N - 1} {h\left( n \right){z^{ - n}}} $，其差分方程为$x\left( n \right)$与$h\left( n \right)$的线性卷积

$$
y\left( n \right) = \sum\limits_{k = 0}^{n - 1} {h\left( k \right)x\left( {n - k} \right)} 
$$
​	由4.9节可知，列长顺次为${N_1}$,${N_2}$点的上$x\left( n \right)$和$h\left( n \right)$的两序列的线性卷积，可通过将两序列分别补零到列长$$N > {N_1} + {N_2} - 1$$后，再求该两序列的$N$点DFT乘积的逆变换得到两序列的圆周卷积，这时该两序列的圆周卷积等于两序列的线性卷积。可把FIR数字滤波器的运算过程表示为     
$$
y\left( n \right) = IDFT\left\{ {X\left( k \right)H\left( k \right)} \right\}{\rm{     }}k = 0, \ldots ,N - 1\tag {5.3.8}
$$


式中           

$$
\begin{array}{l}
X\left( k \right) = DFT\left[ {x\left( n \right)} \right]\\
H\left( k \right) = DFT\left[ {h\left( n \right)} \right]
\end{array}
$$
计算DFT和IDFT，存在快速算法FFT和 IFFT,因此，据 (5.3.8) 式可得实现数字滤波器的快速卷积结构，如图5.3.10所示。其中$$H\left( k \right)$$是滤波器的频率采样值，可事先存放在存储器中。快速卷积型结构的特点是可进行高速处理，适合宽带雷达信号的实时数字滤波。

![5.3.11](.\fig\5.3.11.png)

<center>图5.3.10 快速卷积型结构方框图

##                            5.4  无限长单位脉冲响应数字滤波器设计

### 5.4.1 概述

​	滤波器设计过程归纳为四个步骤，而设计任务的中心是求得系统函数。IIR 滤波器的系统函数一般形式为：
$$
H\left( z \right) = \frac{{\sum\limits_{r = 0}^M {{b_r}{z^{ - r}}} }}{{1 - \sum\limits_{k = 1}^N {{a_k}{z^{ - k}}} }} = A\frac{{\prod\limits_{i = 1}^M {\left( {1 - {c_i}{z^{ - 1}}} \right)} }}{{\prod\limits_{i = 1}^N {\left( {1 - {d_i}{z^{ - 1}}} \right)} }}\tag {5.4.1}
$$


​	本节讨论的所有设计都是假设$$M \le N$$。

​	数字滤波器的系统函数最主要特性有三个，即：幅度平方响应，相位响应及群延迟。这是因为系统函数是$$\omega $$ 的复函数的缘故。幅度平方响应定义为：
$$
{\left| {H\left( {{{\rm{e}}^{j\omega }}} \right)} \right|^2} = {\left| {H\left( z \right)H\left( {{z^{ - 1}}} \right)} \right|_{{\rm{z}} = {{\rm{e}}^{j\omega }}}}\tag {5.4.2}
$$
​	当只需幅度逼近而不考虑相位来设计IIR滤波器时，根据幅度平方响应进行设计很方便。滤波器的设计问题就成为求出一组$${a_k}$$$${b_r}$$系数或者零极点!$${c_i}{\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {d_i}$$，以使得在规定的意义上，如最小均方误差、最大误差最小化等时，滤波器的响应，如时间响应、频率响应、群延迟等逼近一给定的特性。如在$$s$$域求解，则逼近为模拟滤波器；如在$$z$$域求解，则逼近为数字滤波器。

​	设计无限长单位脉冲响应数字滤波器一般可有三种方法：

​	方法1：先设计一个合适的模拟滤波器，然后将其数字化，即将$$s$$平面映射到$$z$$平面得到所需的数字滤波器。模拟滤波器的设计技巧非常成熟，不仅得到的是闭合形式的公式，而且设计系数已经表格化了。因此，由模拟滤波器设计数字滤波器的方法准确、简便，得到普遍的采用。应该指出，IIR数字滤波器的设计本质上井不取决于连续时间滤波器的设计。

​	方法2：在$$z$$平面直接设汁IIR数字滤波器，给出闭合形式的公式，或是以所希望的滤波器响应作为依据，直接在$$z$$平面通过多次选定极点和零点的位置，以逼近该响应。

​	方法3：是利用最优化技术设计参数，选定极点和零点在$$z$$平面上的合适位置，在某种最优化准则意义上逼近所希望的响应。但一般不能得到滤波器系数（即零、极点位置)作为给定响应的闭合形式函数表达式。优化设计法需要完成大量的迭代运算，这种设计法实际上也是IIR滤波器的直接设计。

​	下面着重介绍由模拟滤波器设计相应的IIR数字滤波器的方法。

### 5.4.2 模拟原型滤波器

​	为了从模拟滤波器设计IIR数字滤波器，必须先设计一个满足技术指标的模拟原型滤波器。设计模拟原型有多种办法，如模拟低通逼近有巴特渥斯（Butterworth）型，切比雪夫（Chebyshev）型，或椭圆（Elliptic）型滤波器。低通滤波器是最基本的，至于高通、带通、带阻等滤波器可以用频率变换的方法，由低通型转变得到。

​	模拟滤波器的设计就是要将一组规定的设计要求，转换为相应的模拟系统函数使其逼近某个理想滤波器的特性，例如逼近图5.4.1所示的理想低通滤波器的特性。这种逼近是根据幅度平方函数来确定的。



图5.4.1 理想低通滤波器特性

![5.4.1](.\fig\5.4.1.png)

<center>图5.4.1 理想低通滤波器特性



​	模拟滤波器幅度响应常采用幅度平方函数$${A^2}\left( \Omega  \right)$$表示。
$$
{A^2}\left( \Omega  \right) = {\left| {{H_a}\left( {j\Omega } \right)} \right|^2} = {H_a}\left( s \right){H_a}\left( { - s} \right)\left| {_{s = j\Omega }} \right.\tag {5.4.3}
$$


​	式中$${H_a}\left( s \right)$$是模拟滤波器的系统函数，它是$$s$$的有理函数。$${H_a}\left( {j\Omega } \right)$$是其稳态响应，又称为滤波器的频率特性。$$\left| {{H_a}\left( {j\Omega } \right)} \right|$$是滤波器的稳态振幅特性。

​	从模拟滤波器变换为数字滤波器是从$${H_a}(j\Omega )$$开始的，为此必须由已知$${A^2}\left( \Omega  \right)$$求得$${H_a}(s)$$。这就要将 (5.4.3) 式与$$s$$平面的解释联系起来。设$${H_a}\left( s \right)$$有一临界频率（极点或零点）位于$$s = {s_0}$$，则$${H_a}\left( { - s} \right)$$必有一相应的临界频率位于$$s =  - {s_0}$$，当$${H_a}\left( s \right)$$的临界频率是落在$$ - a \pm jb$$位置时，则$${H_a}\left( { - s} \right)$$相应的临界频率必落在$$ - a \pm jb$$的位置。应该指出，纯虚数的临界频率必然是二阶的。在$$s$$平面上，上述临界频率的特性如图5.4.2 所示。所得到的对称型式称为象限对称。图中在$$j\Omega $$轴上零点处所标的数表示零点的阶次是二阶的。

![5.4.2](.\fig\5.4.2.png)

​                                       图5.4.2 $${H_a}(s)$$、$${H_a}( - s)$$象限对称的零极点分布

​	任何实际的滤波器都是稳定的，因此，极点必落于$$s$$平面的左半平面。所以落于左半平面的极点都属于$${H_a}\left( s \right)$$，落于右半平面的极点属于$${H_a}\left( { - s} \right)$$。

​	零点的分布与滤波器的相位特性有关。如要求最小相位特性，则应选取$$s$$ 平面左半平面的零点。如要求具有特殊相位的滤波器，则可以各种不同的组合来分配左半平面和右半平面内的零点。

​	综上所述，可归纳出由$${A^2}\left( \Omega  \right)$$确定的方法是:

1) 根据(5.4.3)式，代入$${\Omega ^{\rm{2}}} =  - {s^{\rm{2}}}$$到$${A^2}\left( \Omega  \right)$$中即得$$ - s$$平面函数。
2) 将$${A^2}\left( \Omega  \right)$$的分子多项式和分母多项式分解为因子形式，得到零点和极点。若系统函数是最小相位函数，则$$s$$平面内左半平面的极点和零点都属于$${H_a}\left( s \right)$$的极点和零点，而任何$$j\Omega $$轴上的零点和极点都是偶次的，其中一半属于$${H_a}\left( s \right)$$。
3) 根据具体情况，对此$A\left( \Omega  \right)$与$${H_a}\left( s \right)$$的低频或高频特性就可以确定出增益常数。
4) 求出零，极点及增益常数后，便可得到系统函数$${H_a}\left( s \right)$$。

​	下面介绍两种常用的模拟低通滤波器特性。有关模拟高通、带通、带阻滤波器的内容，在IIR数字滤波器频率变换这部分介绍。

### 5.4.3 巴特渥斯滤波器

​	巴特渥斯模拟滤波器幅度平方函数的形式是
$$
{A^2}\left( \Omega  \right) = {\left| {{H_a}\left( {j\Omega } \right)} \right|^2} = \frac{1}{{1 + {{\left( {\frac{{j\Omega }}{{j\Omega {{\kern 1pt} _c}}}} \right)}^{2N}}}}\tag {5.4.4}
$$


​	式中$$N$$为整数，是滤波器的阶次。$$\Omega {{\kern 1pt} _c}$$定义为截止频率，当$$\Omega  = \Omega {{\kern 1pt} _c}$$时，$${A^2}\left( \Omega  \right) = \frac{1}{2}$$或$${\left| {{H_a}\left( {j\Omega } \right)} \right|^2} = \frac{1}{{\sqrt 2 }}$$，这相当3.01dB的衰减，所以$$\Omega {{\kern 1pt} _c}$$又称为3分贝带宽。巴特渥斯滤波器在通带中有最大平坦的振幅特性，这就是说，$$N$$阶低通滤波器在$$\Omega  = 0$$处幅度平方函数的前$$\left( {2N - 1} \right)$$阶导数等于零，在止带内的逼近是单调变化的。巴特渥斯滤波器振幅特性对阶数$$N$$的依赖关系如图5.4.3所示。

**例程 5.4.1**

绘制巴特沃斯模拟滤波器振幅特性对阶数$N$依赖关系图。

```
N = 6;
str = ["N=1","N=2","N=3","N=4","N=5","N=6"];
for n = 1:N
[z, p, k] = buttap(n);
[num,den] = zp2tf(z,p,k);
w = linspace(0, 2*pi); 
h = freqs(num,den,w);
mag = abs(h)/abs(h(1));
plot(w/pi,mag)
hold on; 
end
title('巴特沃斯滤波器振幅特性对阶数N的依赖关系')
legend(str(1),str(2),str(3),str(4),str(5),str(6));

```

![5.4.3](.\fig\5.4.3.png)

​                              图5.4.3 巴特渥斯滤波器振幅特性对阶数$N$的依赖关系

​	滤波器的特性完全由其阶数$$N$$决定，当$$N$$增大时，滤波器的特性曲线变得更陡峭，这时虽然由 (5.4.4) 式决定了在$$\Omega  = \Omega {{\kern 1pt} _c}$$处的幅度函数总是$${\rm{1/}}\sqrt 2 $$，但是它们将在通带的更大范围内接近于 1，在阻带内更迅速地接近于零，因而振幅特性更接近于理想的矩形频率特性。滤波器的振幅特性对参数$$N$$的依赖关系如图5.4.3所示。
$$
{H_a}\left( s \right){H_a}\left( { - s} \right) = \frac{1}{{1 + {{\left( {\frac{{\rm{s}}}{{j\Omega {{\kern 1pt} _c}}}} \right)}^{2N}}}}\sqrt {{b^2} - 4ac}\tag {5.4.5}
$$


​	所以巴特渥斯滤波器属于全极点设计，即零点全在无穷处。于是幅度平方函数的各极点为


$$
{s_p} = {\left( { - 1} \right)^{\frac{1}{{2N}}}}\left( {j\Omega {{\kern 1pt} _c}} \right) = \Omega {{\kern 1pt} _c}{{\rm{e}}^{j\pi \left[ {\frac{1}{2} + \frac{{2p - 1}}{{2N}}} \right]}},{\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} p = 1,2, \ldots 2N
$$


**例程** 5.4.2

绘制3阶巴特沃斯模拟滤波器零极点图。

```
% 设计一个3阶巴特沃斯滤波器 
n = 3; % 滤波器阶数 
Wn = 1; % 截止频率，这里设为归一化值1 
[b, a] = butter(n, Wn, 's'); % 获取滤波器系数，'s'表示模拟滤波器 
% 计算滤波器的极点 
poles = roots(a); % a是滤波器的分母多项式系数，其根即为极点 
% 绘制极点图 
figure; 
plot(real(poles), imag(poles), 'rx', 'MarkerSize', 10); % 绘制极点 
hold on; 
% 绘制单位圆（对于归一化频率而言） 
theta = linspace(0, 2*pi, 100); 
plot(cos(theta), sin(theta), 'b--'); 
% 设置图表标题和坐标轴标签 
title('Pole-Zero Plot of a 3rd-Order Butterworth Analog Filter'); 
xlabel('Real Axis'); 
ylabel('Imaginary Axis'); 
grid on; 
axis equal; % 设置坐标轴等比例 

```

![5.4.4](.\fig\5.4.4.png)

<center>图5.4.4 3阶巴特渥斯滤波器在s平面上零极点图


​	它分布在$$s$$平面半径为$$\Omega {{\kern 1pt} _c}$$的圆(称为巴特渥斯圆)上，共有$$2N$$个角度间隔是$$\pi /N$$弧度的极点。例如$$N = 3$$时，极点间间隔为$$\pi /3$$弧度或$${60^ \circ }$$，如图5.4.4所示。极点对虚轴是对称的，且不会落在虚轴上。当$$N$$是奇数时，实轴上有极点；当$$N$$是偶数时，则实轴上也没有极点。

​	由$${A^2}\left( \Omega  \right)$$在$$s$$​平面左半平面的巴特渥斯圆上的极点可以直接写出滤波器的系统函数为
$$
{H_a}\left( s \right) = \frac{{{K_0}}}{{\prod\limits_{k = 1}^N {\left( {s - {s_k}} \right)} }}\tag {5.4.6}
$$
式中$${K_0}$$为归一化常数，由的低频特性决定。而$$s$$​平面左半平面巴特渥斯圆上极点为
$$
{s_k} = {\Omega _c}{{\rm{e}}^{j\pi \left( {\frac{1}{2} + \frac{{2k - 1}}{{2N}}} \right)}}{\rm{      }}k = 1,2 \ldots ,N\tag {5.4.7}
$$
作出表格，如表5.4.1所示以供査用。

​                                                                                      **低阶巴特渥斯滤波器的系统函数**                                                                               表5.4.1

| 阶次 | 系统函数$${H_a}\left( s \right)$$                            |
| ---- | ------------------------------------------------------------ |
| 1    | $$\frac{{\Omega {{\kern 1pt} _c}}}{{s + \Omega {{\kern 1pt} _c}}}$$ |
| 2    | $$\frac{{\Omega {\kern 1pt} _c^2}}{{{s^2} + \sqrt 2 \Omega {{\kern 1pt} _c}s + \Omega {\kern 1pt} _c^2}}$$ |
| 3    | $$\frac{{\Omega {\kern 1pt} _c^3}}{{{s^3} + 2\Omega {{\kern 1pt} _c}{s^2} + 2\Omega {\kern 1pt} _c^2s + \Omega {\kern 1pt} _c^3}}$$ |
| 4    | $$\frac{{\Omega {\kern 1pt} _c^4}}{{{s^4} + 2.613\Omega {{\kern 1pt} _c}{s^3} + 3.414\Omega {\kern 1pt} _c^2{s^2} + 2.613\Omega {\kern 1pt} _c^3s + \Omega {\kern 1pt} _c^4}}$$ |
| 5    | $$\frac{{\Omega {\kern 1pt} _c^5}}{{{s^5} + 3.236\Omega {{\kern 1pt} _c}{s^4} + 5.236\Omega {\kern 1pt} _c^2{s^3} + 5.236\Omega {\kern 1pt} _c^3{s^2} + 3.236\Omega {\kern 1pt} _c^4s + \Omega {\kern 1pt} _c^5}}$$ |
| 6    | $$\frac{{\Omega {\kern 1pt} _c^6}}{{{s^6} + 3.863\Omega {{\kern 1pt} _c}{s^5} + 7.464\Omega {\kern 1pt} _c^2{s^4} + 9.141\Omega {\kern 1pt} _c^3{s^3} + 7.464\Omega {\kern 1pt} _c^4{s^2} + 3.863\Omega {\kern 1pt} _c^5s + \Omega {\kern 1pt} _c^6}}$$ |

​	若在$$\Omega  > \Omega {{\kern 1pt} _c}$$范围内选一$$\Omega {{\kern 1pt} _s}$$作为阻带的起始点，则有
$$
{A^2}\left( {\Omega {{\kern 1pt} _s}} \right) = \frac{1}{{1 + {{\left( {\frac{{\Omega {{\kern 1pt} _s}}}{{\Omega {{\kern 1pt} _c}}}} \right)}^{2N}}}}\tag {5.4.8}
$$
​	当衰减值$${A^2}\left( {\Omega {{\kern 1pt} _s}} \right)$$和$$\Omega {{\kern 1pt} _c}$$给定时，即可由上式求出$$\Omega {{\kern 1pt} _s}$$值(当阶次$$N$$为已知时)或求出$$N$$(当$$\Omega {{\kern 1pt} _s}$$为已知时)；或者当$$\Omega {{\kern 1pt} _c}$$，$$N$$及$$\Omega {{\kern 1pt} _s}$$已知时，可以求出$${A^2}\left( {\Omega {{\kern 1pt} _s}} \right)$$值。

### 5.4.4 切比雪夫滤波器  

​	巴特渥斯滤波器的频率特性曲线，无论在通带和阻带中都是频率的单调函数。因此，当通带的边界处满足指标要求时，通带内肯定会有裕量。所以更有效的设计方法应该是将精确度均匀地分布在整个通带或阻带内，或者同时分布在两者之内，这样就可用阶数较低的系统满足要求。这可通过选择具有等波纹特性的逼近函数来达到。

​	切比雪夫滤波器的振幅特性就具有这种等波纹特性。它有两种型式：振幅特性在通带内是等波纹的，在阻带内是单调的称为切比雪夫I型滤波器；振幅特性在通带内是单调的，在阻带内是等波纹的称为切比雪夫II型滤波器。采用何种型式切比雪夫滤波器取决于实际用途。图5.4.5和5.4.6分别画出了阶次为奇数与偶数时的切比雪夫I、II型滤波器的频率特性。

 

**例程 5.4.3**

绘制切比雪夫滤波器振幅特性对阶数N的依赖关系图。

I型

```
% Chebyshev Type I filter 滤波器振幅特性对阶数N的依赖关系
N = 6;
str = ["N=1","N=2","N=3","N=4","N=5","N=6"];
for n = 1:N
    [z,p,k] = cheb1ap(n,3);  
    [num,den] = zp2tf(z,p,k);
    w = linspace(0, pi);        
    h = freqs(num,den,w);
    if n == 1
    max_h = h(1);
    end
    mag = abs(h)/abs(max_h);

    if mod(n,2) == 1 %奇数
    subplot(2,1,1), plot(w/pi,mag)
    xlabel('频率');
    ylabel('振幅');
    title('切比雪夫-I 滤波器振幅特性对阶数N的依赖关系-N为奇数')
    hold on;  
    else %偶数
    subplot(2,1,2), plot(w/pi,mag)
    subplot(2,1,2), plot(w/pi,mag)
    xlabel('频率');
    ylabel('振幅');
    title('切比雪夫-I 滤波器振幅特性对阶数N的依赖关系-N为偶数')
    hold on;  
    end
end
subplot(2,1,1); legend(str(1),str(3),str(5)); %奇数
subplot(2,1,2); legend(str(2),str(4),str(6)); %偶数

```

![5.4.5](.\fig\5.4.5.png)

<center>图5.4.5 切比雪夫I型滤波器的振幅特性


 II型

```
N = 6;
str = ["N=1","N=2","N=3","N=4","N=5","N=6"];
for n = 1:N
    [z,p,k] = cheb2ap(n,3);       
    [num,den] = zp2tf(z,p,k);     
    w = linspace(0, pi);        
    h = freqs(num,den,w);
    mag = abs(h)/abs(h(1));
    if mod(n,2) == 1 %奇数
    subplot(2,1,1), plot(w/pi,mag)
    xlabel('频率');
    ylabel('振幅');
    title('切比雪夫-II 滤波器振幅特性对阶数N的依赖关系-N为奇数')
    hold on;  
    else %偶数
    subplot(2,1,2), plot(w/pi,mag)
    xlabel('频率');
    ylabel('振幅');
    title('切比雪夫-II 滤波器振幅特性对阶数N的依赖关系-N为偶数')
    hold on;  
    end 
end
subplot(2,1,1); legend(str(1),str(3),str(5)); %奇数
subplot(2,1,2); legend(str(2),str(4),str(6)); %偶数
```

![5.4.6](.\fig\5.4.6.png)

<center>图5.4.6 切比雪夫II型滤波器的振幅特性


​	现在介绍切比雪夫I型滤波器，其幅度平方函数为
$$
{A^2}\left( \Omega  \right) = {\left| {{H_a}\left( {j\Omega } \right)} \right|^2} = \frac{1}{{1 + {\varepsilon ^2}c_N^2\left( {\frac{\Omega }{{\Omega {{\kern 1pt} _c}}}} \right)}}\tag {5.4.9}
$$


​	$$\varepsilon $$为小于1的正数，表示通带内振幅波动的程度。$$\varepsilon $$愈大，波动也愈大。$$\Omega /{\Omega _c}$$为$$\Omega $$对$$\Omega {{\kern 1pt} _c}$$频率的归一化频率，$$\Omega {{\kern 1pt} _c}$$为截止频率，也是滤波器的通带宽度。$${C_N}(x)$$是$$N$$​阶切比雪夫多项式，定义为
$$
{C_N}\left( x \right) = \left\{ {\begin{array}{*{20}{c}}
{\cos \left( {N{{\cos }^{ - 1}}x} \right)}\\
{{\rm{ch}}\left( {N{\kern 1pt} {\kern 1pt} {\rm{c}}{{\rm{h}}^{ - 1}}x} \right){\kern 1pt} }
\end{array}} \right.\begin{array}{*{20}{c}}
{{\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\rm{0}} < x \le 1}\\
{x \ge 1}
\end{array}\tag {5.4.10}
$$
上式可展开为多项式。

​	当$$N = 0$$时，$${C_0}(x) = 1$$；

​	当$$N = 1$$时，$${C_1}(x) = x$$；

​	当$$N = 2$$时，$${C_2}(x) = 2{x^2} - 1$$；

​	当$$N = 3$$时, $${C_3}(x) = 4{x^3} - 3x$$；

由此可归纳出高阶切比雪夫多项式的递推公式为
$$
{C_{N + 1}}\left( x \right) = 2x{C_N}\left( x \right) - {C_{N - 1}}\left( x \right)\tag {5.4.11}
$$
图5.4.7示出了$$N = 0 \sim 4$$阶时的I型和II型切比雪夫多项式的特性。

**例程 5.4.4**

绘制切比雪夫滤波器多项式图。

```
% I型
syms x y
fplot(chebyshevT(0:4,x))
axis([0 3 -2 4])
ylabel('T_n(x)')
legend('T_0(x)','T_1(x)','T_2(x)','T_3(x)','T_4(x)','Location','Best')
title('切比雪夫-I型 多项式')

% II型
syms x y
fplot(chebyshevU(0:4, x))
axis([0 3 -2 4])
ylabel('U_n(x)')
legend('U_0(x)', 'U_1(x)', 'U_2(x)', 'U_3(x)', 'U_4(x)', 'Location', 'Best')
title('切比雪夫-II型 多项式')
```

![5.4.7](fig/5.4.7(a).png)

<center>I型


![5.4.7](fig/5.4.7(b).png)

<center>II型


<center>图5.4.7 0~4阶切比雪夫多项式曲线


由图可见

1) 切比雪夫多项式的零值在$$0 < x < 1$$的间隔内。
2) $$\left| {{C_N}(x)} \right| \le 1,{\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} x \le 1$$。即在$$x \le 1$$时，该多项式具有等波纹幅度特性。
3) 在$$x \le 1$$的区间之外，$${C_N}(x)$$是双曲余弦函数，随$$x$$而单调地增加。

​	再看一新函数$${\varepsilon ^2}C_N^2(x)$$。$$\varepsilon $$是小于1的实数，$${\varepsilon ^2}C_N^2(x)$$的值在$$x \le 1$$之内将在0至$${\varepsilon ^2}$$之间改变。而函数$$1 + {\varepsilon ^2}C_N^2(x)$$的值在$$x \le 1$$时，将在1与$$1 + {\varepsilon ^2}$$之间变化。然后$$1 + {\varepsilon ^2}C_N^2(x)$$将变成倒数，即得 (5.4.9) 式的切比雪夫I型滤波器幅度平方函数。

​	根据以上所述可见，在$$\Omega /\Omega {{\kern 1pt} _c}{\kern 1pt}  \le 1$$即$$0 \le \Omega  \le \Omega {{\kern 1pt} _c}$$范围内，$${\left| {{H_a}\left( {j\Omega } \right)} \right|^2}$$在接近1处振荡，其最大值为1，最小值为$\frac{1}{1 + \epsilon^2}$。在此范围之外，随$$\Omega /\Omega {{\kern 1pt} _c}$$增大，$${\varepsilon ^2}C_N^2(x) \gg 1$$，则$${\left| {H\left( {j\Omega } \right)} \right|^2}$$很快接近于零。切比雪夫I型滤波器的振幅特性已示于图5.4.5。振幅特性$${\left| {{H_a}\left( {j\Omega } \right)} \right|^2}$$的起伏为$$1 - \frac{1}{{\sqrt {1 + {\varepsilon ^2}} }}$$，因$$C_N^2\left( 1 \right) = 1$$，在$$\Omega  = {\Omega _c}$$时，$${\left| {{H_a}\left( {j\Omega } \right)} \right|^2} = \frac{1}{{\sqrt {1 + {\varepsilon ^2}} }}$$ 。

​	图5.4.8画出了切比雪夫I型滤波器的$${A^2}\left( \Omega  \right)$$与$$\Omega $$的关系曲线，为了比较，图中也画了同阶的巴特渥斯滤波器的$${A^2}\left( \Omega  \right)$$与$$\Omega $$的关系曲线。

**例程 5.4.5**

绘制巴特沃斯-切比雪夫滤波器特性比较图。

```
n = 4; str = ["N=4 巴特沃斯", "N=4 切比雪夫-I"];
%巴特沃斯
[z, p, k]=buttap(n);
[num,den] = zp2tf(z,p,k);
w = linspace(0, pi);        
h = freqs(num,den,w);
mag = abs(h)/abs(h(1));
plot(w/pi,mag);
hold on;   
%切比雪夫-I
Rp = 1; 
n = 1;
[z,p,k] = cheb1ap(n,Rp);       
[num,den] = zp2tf(z,p,k);     
w = linspace(0, pi);        
h = freqs(num,den,w);
max_h = h(1);

n = 3;
[z,p,k] = cheb1ap(n,Rp);       
[num,den] = zp2tf(z,p,k);     
w = linspace(0, pi);        
h = freqs(num,den,w);
mag = abs(h)/abs(max_h);
plot(w/pi,mag);

xlabel('频率'); ylabel('振幅'); 
title('巴特沃斯/切比雪夫-I 滤波器振幅特性对阶次N的依赖关系');
legend(str(1),str(2));
```

![5.4.8](.\fig\5.4.8.png)

​                              图5.4.8 切比雪夫及巴特沃斯滤波器的$${A^2}\left( \Omega  \right)$$特性

​                     （对于巴特沃斯滤波器$$\Omega {{\kern 1pt} _c} = \Omega {{\kern 1pt} _{3dB}}$$，对于切比雪夫滤波器$$\Omega  \ne \Omega {{\kern 1pt} _{3dB}}$$)

​	由 (5.4.9) 式可见，确定切比雪夫滤波器特性有三个参数$$\varepsilon ,{\kern 1pt} {\kern 1pt} {\kern 1pt} \Omega {{\kern 1pt} _c}$$及$$N$$。下面研究如何确定这三个参数。

​	为确定$$\varepsilon $$，我们先定义通带波纹$$\delta $$(以dB表示)为
$$
\delta  = 10{\log _{10}}\frac{{\left| {{H_a}\left( {j\Omega } \right)} \right|_{\max }^2}}{{\left| {{H_a}\left( {j\Omega } \right)} \right|_{\min }^2}}{\rm{ = 20}}{\log _{10}}\frac{{{{\left| {{H_a}\left( {j\Omega } \right)} \right|}_{\max }}}}{{{{\left| {{H_a}\left( {j\Omega } \right)} \right|}_{\min }}}}\tag {5.4.12}
$$
​	这里$${\left| {{H_a}\left( {j\Omega } \right)} \right|_{\max }}$$及$${\left| {{H_a}\left( {j\Omega } \right)} \right|_{\min }}$$是幅度响应的最大值和最小值，且$$\left| {{H_a}\left( {j\Omega } \right)} \right|_{\max }^2 = 1$$，$$\left| {{H_a}\left( {j\Omega } \right)} \right|_{\min }^2 = \frac{1}{{1 + {\varepsilon ^2}}}$$。这样，由 (5.4.12) 式便可得到$$\delta  = 10{\log _{10}}\left( {1 + {\varepsilon ^2}} \right)$$​ ，因而
$$
{\varepsilon ^2} = {10^{\frac{\delta }{{10}}}} - 1\tag {5.4.13}
$$
​	阶数$$N$$等于通带内最大和最小值个数的总和，如$$N$$是奇数，则在$$\Omega  = 0$$处有一最大值，如$$N$$是偶数，则在$$\Omega  = 0$$处为一最小值（见图5.4.5)。

根据 (5.4.9) 式，由阻带起始点$${\Omega _s}$$​处的关系可以求出切比雪夫滤波器的阶数
$$
{A^2}\left( {\Omega {{\kern 1pt} _s}} \right) = \frac{1}{{1 + {\varepsilon ^2}C_N^2\left( {\frac{{\Omega {{\kern 1pt} _s}}}{{\Omega {{\kern 1pt} _c}}}} \right)}}\tag {5.4.14}
$$


由于$$\Omega {{\kern 1pt} _s}/\Omega {{\kern 1pt} _c} > 1$$​，所以按 (5.4.10) 第二式定义有
$$
{C_N}\left( {\frac{{\Omega {{\kern 1pt} _s}}}{{\Omega {{\kern 1pt} _c}}}} \right) = {\mathop{\rm ch}\nolimits} \left[ {N{{{\mathop{\rm ch}\nolimits} }^{ - 1}}\left( {\frac{{\Omega {{\kern 1pt} _s}}}{{\Omega {{\kern 1pt} _c}}}} \right)} \right] = \frac{1}{\varepsilon }\sqrt {\frac{1}{{{A^2}\left( {\Omega {{\kern 1pt} _s}} \right)}} - 1}
$$
由上式解得
$$
N = \frac{{{{{\mathop{\rm ch}\nolimits} }^{ - 1}}\left[ {\frac{1}{\varepsilon }\sqrt {\frac{1}{{{A^2}\left( {\Omega {{\kern 1pt} _s}} \right)}} - 1} } \right]}}{{{{{\mathop{\rm ch}\nolimits} }^{ - 1}}\left( {\frac{{\Omega {{\kern 1pt} _s}}}{{\Omega {{\kern 1pt} _c}}}} \right)}}\tag {5.4.15}
$$
或对$$\Omega {{\kern 1pt} _s}$$求解得
$$
\Omega {{\kern 1pt} _s} = \Omega {{\kern 1pt} _c}{\mathop{\rm ch}\nolimits} \left\{ {\frac{1}{N}{{{\mathop{\rm ch}\nolimits} }^{ - 1}}\left[ {\frac{1}{\varepsilon }\sqrt {\frac{1}{{{A^2}\left( {\Omega {{\kern 1pt} _s}} \right)}} - 1} } \right]} \right\}\tag {5.4.16}
$$
$$\Omega {{\kern 1pt} _c}$$是切比雪夫滤波器的通带宽度，但不是3dB带宽，一般是预先给定的。3dB带宽$$\Omega {{\kern 1pt} _{3dB}}$$​应由下式决定
$$
{A^2}\left( {\Omega {{\kern 1pt} _{3dB}}} \right) = {\left| {{H_a}\left( {j\Omega {{\kern 1pt} _{3dB}}} \right)} \right|^2} = \frac{1}{2}\tag {5.4.17}
$$
由 (5.4.17) 式得

$${\varepsilon ^2}C_N^2\left( {\frac{{\Omega {{\kern 1pt} _{3dB}}}}{{{\Omega _c}}}} \right) = 1$$  通常可认为$$\frac{{\Omega {{\kern 1pt} _{3dB}}}}{{{\Omega _c}}} > 1$$

因此          
$$
{C_N}\left( {\frac{{\Omega {{\kern 1pt} _{3dB}}}}{{{\Omega _c}}}} \right) =  \pm \frac{1}{\varepsilon } = {\mathop{\rm ch}\nolimits} \left[ {N{{{\mathop{\rm ch}\nolimits} }^{ - 1}}\left( {\frac{{\Omega {{\kern 1pt} _{3dB}}}}{{{\Omega _c}}}} \right)} \right]
$$
取正号并解得   
$$
\Omega {{\kern 1pt} _{3dB}} = {\Omega _c}{\mathop{\rm ch}\nolimits} \left[ {\frac{1}{N}{{{\mathop{\rm ch}\nolimits} }^{ - 1}}\left( {\frac{1}{\varepsilon }} \right)} \right]
$$
$$\varepsilon $$、$$N$$、$${\Omega _c}$$数值确定之后，就可求出滤波器的极点，确定$${\Omega _c}$$。设滤波器的系统函数$${H_a}\left( s \right)$$的极点（由$$1 + {\varepsilon ^2}c_N^2\left( {\frac{s}{{j\Omega {{\kern 1pt} _c}}}} \right) = 0$$决定)为
$$
{s_i} = {\sigma _i} + j\Omega {{\kern 1pt} _i}
$$
则可证明
$$
\left\{ {\begin{array}{*{20}{c}}
{{\sigma _i} =  - \Omega {{\kern 1pt} _c}{\mathop{\rm sh}\nolimits} \xi \sin \left( {\frac{{2i - 1}}{{2N}}\pi } \right)}\\
{{\Omega _i} = \Omega {{\kern 1pt} _c}{\mathop{\rm ch}\nolimits} \xi \cos \left( {\frac{{2i - 1}}{{2N}}\pi } \right)}
\end{array}} \right. & i = 1,2, \ldots N\tag {5.4.18}
$$
若将 (5.4.18) 式中的$${\sigma _i}$$除以$$\Omega {{\kern 1pt} _c}{\mathop{\rm sh}\nolimits} \xi $$，$${\Omega _i}$$除以$$\Omega {{\kern 1pt} _c}{\mathop{\rm ch}\nolimits} \xi $$​并求它们平方之和，

  即得  
$$
\frac{{\sigma _i^2}}{{\Omega {\kern 1pt} _c^2{{{\mathop{\rm sh}\nolimits} }^2}\xi }} + \frac{{\Omega {\kern 1pt} _i^2}}{{\Omega {\kern 1pt} _c^2{{{\mathop{\rm ch}\nolimits} }^2}\xi }} = 1 \to\tag {5.4.19}
$$
因具有相同宗量的双曲余弦总大于双曲正弦，所以 (5.4.19) 式是长半轴为$$\Omega {{\kern 1pt} _c}{\mathop{\rm ch}\nolimits} \xi $$（在虚轴上），和短半轴为$$\Omega {{\kern 1pt} _c}{\mathop{\rm sh}\nolimits} \xi $$​（在实轴上)的椭圆方程。

 若令   
$$
\left\{ {\begin{array}{*{20}{c}}
{b{\kern 1pt} {\kern 1pt} \Omega {{\kern 1pt} _c} = {\mathop{\rm ch}\nolimits} \left( {\frac{1}{N}{{{\mathop{\rm sh}\nolimits} }^{ - 1}}\frac{1}{\varepsilon }} \right)\Omega {{\kern 1pt} _c}}\\
{a{\kern 1pt} {\kern 1pt} \Omega {{\kern 1pt} _c} = {\mathop{\rm sh}\nolimits} \left( {\frac{1}{N}{{{\mathop{\rm sh}\nolimits} }^{ - 1}}\frac{1}{\varepsilon }} \right)\Omega {{\kern 1pt} _c}}
\end{array}} \right.
$$
经过推导，可得出确定$$a$$和$$b$$得公式如下
$$
a = \frac{1}{2}\left( {{\alpha ^{\frac{1}{N}}} - {\alpha ^{ - \frac{1}{N}}}} \right)\tag {5.4.20}
$$

$$
b = \frac{1}{2}\left( {{\alpha ^{\frac{1}{N}}} + {\alpha ^{ - \frac{1}{N}}}} \right)\tag {5.4.21}
$$

式中
$$
\alpha  = \frac{1}{\varepsilon } + \sqrt {\frac{1}{{{\varepsilon ^2}}} + 1}\tag {5.4.22}
$$
​	因此切比雪夫滤波器的极点，就是一组分布在以$$b{\kern 1pt} {\kern 1pt} \Omega {{\kern 1pt} _c}$$为长轴，$$a{\kern 1pt} {\kern 1pt} \Omega {{\kern 1pt} _c}$$为短轴的椭圆上的点。图5.4.9示出了$$N = 3$$的三阶切比雪夫滤波器的幅度平方函数$${A^2}\left( \Omega  \right)$$的极点分布。其中左半平面的极点才是$${H_a}\left( s \right)$$的极点。求得$${H_a}\left( s \right)$$的极点$${s_i}$$​后即可求得切比雪夫滤波器的系统函数为
$$
{H_a}\left( s \right) = \frac{c}{{\prod\limits_{i = 1}^N {\left( {s - {s_i}} \right)} }}\tag {5.4.23}
$$
增益常数$$c$$可由对比$$A\left( \Omega  \right)$$与$${H_a}\left( s \right)$$的低频或高频特性确定。

​	图5.4.9中的虚线表示如何利用几何法求解切比雪夫滤波器的极点。首先考察以为$$b{\kern 1pt} {\kern 1pt} \Omega {{\kern 1pt} _c}$$半径的大圆和以$$a{\kern 1pt} {\kern 1pt} \Omega {{\kern 1pt} _c}$$为半径的小圈上按等角间隔$$\pi /N$$均匀分布的诸点。这些点与虚轴对称，并且没有一点落在虚轴上。$$N$$为奇数时这些点之一落在实轴上，$$N$$为偶数时，则实轴上也没有极点。然后通过大圆上的这些等角间隔均匀分布的诸点作实轴的平行线，再通过小圆上的等角间隔均匀分布的诸点作虚轴方向的平行线，两组互相垂直的平行线的交点，就是切比雪夫滤波器的极点位置。关于切比雪夫Ⅱ型滤波器，限于篇幅，这里就不作介绍了。

![5.4.9](.\fig\5.4.9.png)

<center>图5.4.9 三阶切比雪夫滤波器的极点位置


​	还有一种在通带和阻带内都具有“等波纹”振幅特性的滤波器，由于其振幅特性是由雅可比椭圆函数决定的，故称为“椭圆滤波器”。因为本节主要是讨论由模拟滤波器设计数字滤波器的方法问题，而椭圆滤波器又比较专门，所以对模拟椭圆滤波器也就不作介绍了。

​	从$$\Omega {{\kern 1pt} _p}$$至$$\Omega {{\kern 1pt} _s}$$间的过渡带陡峭角度看，切比雪夫滤波器比巴特渥斯滤波器过渡带陡，而椭圆滤波器又比切比雪夫滤波器过渡带陡。换言之，如果过渡带的特性要求相同，则选用椭圆滤波器时所要求的阶数$$N$$最低，切比雪夫滤波器次之,选用巴特渥斯滤波器时所要求的阶数最高。不过从设计的复杂性和对参数的灵敏度要求看，情况恰巧相反。选用何种滤波器应视实际用途和指标要求而定。

### 5.4.5 从模拟滤波器设计数字滤波器的方法

​	从模拟滤波器设计$${\mathop{\rm IIR}\nolimits} $$数字滤波器就是要由列出的$${H_a}\left( s \right)$$进一步求得$$H\left( z \right)$$。归根结底是一个由$$s$$平面到$$z$$平面的变换，这个变换应遵循两个基本的目标：

1) $$H\left( z \right)$$的频响必须要模仿$${H_a}\left( s \right)$$的频响，也即$$s$$平面的虚轴$$j\Omega $$应该映射到$$z$$平面的单位圆上。
2) $${H_a}\left( s \right)$$的因果稳定性，通过映射后仍应在所得到的$$H\left( z \right)$$中保持，也即$$s$$平面的左半平面$$({\kern 1pt} {\kern 1pt} {\kern 1pt} {\mathop{\rm Re}\nolimits} \left[ s \right] < 0{\kern 1pt} {\kern 1pt} {\kern 1pt} )$$应该映射到平面单位圆以内$$({\kern 1pt} {\kern 1pt} {\kern 1pt} |z| < 1{\kern 1pt} {\kern 1pt} {\kern 1pt} )$$。

​	从模拟滤波器映射(变换)成数字滤波器有四种方法：

​	(1) 微分—差分变换法；

​	(2) 脉冲响应不变变换法；

​	(3) 双线性变换法；

​	(4) 匹配变换法。

​	其中(1)、(4)两种方法都有一定的局限性，工程上常用的是脉冲响应不变变换法和双线性变换法两种。

## 5.5脉冲响应不变变换法

### 5.5.1 变换原理 

脉冲响应不变变换法又称为标准$z$变换法。它是保证从模拟滤波器变换所得的数字滤波器的单位采样响应$h\left( n \right)$,是相应的模拟滤波器的单位脉冲响应${h_a}\left( t \right)$的等间隔采样值，即$h\left( n \right) = {h_a}\left( {nT} \right)$

如图5.5.1所示，这里*T*为采样周期。

<img src=".\fig\5.5.1.png">

<center>图5.5.1 脉冲响应不变概念示意图


${h_a}(t)$的拉氏变换为
$$
L\left[ {{h_a}\left( t \right)} \right] = {H_a}\left( s \right)
$$
$h\left( {nT} \right)$的$z$变换即为数字滤波器的系统函数$H\left( z \right)$
$$
Z\left[ {h\left( {nT} \right)} \right] = H\left( z \right)
$$
由第二章证明可知，$h\left( n \right)$的z变换和${h_a}\left( t \right)$的拉氏变换之间的关系为
$$
\H\left( z \right)\left| {_{z = {{\rm{e}}^{sT}}}} \right. = \frac{1}{T}\sum\limits_{m =  - \infty }^\infty  {{H_a}\left( {s + j\frac{{2\pi }}{T}m} \right)}  = \hat H\left( s \right) \tag{5.5.1}
$$
即时域的采样，使连续时间信号的拉氏变换${H_a}\left( s \right)$在$s$平面上沿虚轴周期延拓，然后再经过$z = {{\rm{e}}^{sT}}$的映射关系，将${H_a}\left( s \right)$映射到$z$平面上，即得$H\left( z \right)$。

第2章讨论$z = {{\rm{e}}^{sT}}$的映射关系表明: $s$平面上每一宽为$2\pi /T$的条带，都将重叠地映射到全部$z$平面上。而每一条带的左半部分映射在$z$平面单位圆以内，条带的右半部分映射在单位圆以外。$s$平面的虚轴$j\Omega $映射到单位圆上，但是$j\Omega $轴上的每一段$2\pi /T$的虚轴，都对应于绕单位圆一周。所以按照脉冲响应不变变换法，从$s$平面到$z$平面的映射不是单值关系，千万不可错误地认为经过$z = {{\rm{e}}^{sT}}$的简单代数变换即可由${H_a}\left( s \right)$得到$H\left( z \right)$。这里除了这一变换之外，还同时含有为${H_a}\left( s \right)$以$2\pi /T$周期对作周期延拓的过程。脉冲响应不变变换法$s$平面与平面$z$的映射关系示于图5.5.2。

由(5.5.1) 式可得数字滤波器与模拟滤波器频率响应之间关系为

<img src=".\fig\5.5.2.png">

<center>图5.5.2 脉冲响应不变变换法 平面与 平面的映射关系


$$
H\left( {{{\rm{e}}^{j\omega }}} \right) = \frac{1}{T}\sum\limits_{m =  - \infty }^\infty  {{H_a}\left( {j\frac{\omega }{T}m + j\frac{{2\pi }}{T}m} \right)} 
$$

即数字滤波器的频率响应是模拟滤波器频率响应的周期延拓。如果模拟滤波器的频响是限带于折叠频率之内的，即
$$
H{}_a\left( {j\Omega } \right) = 0{\rm{     }}\left| \Omega  \right| \ge \frac{\pi }{T}
$$
这时才使数字滤波器的频率响应在折叠频率以内，重现模拟滤波器的频率响应而不产生混叠失真。
$$
H\left( {{{\rm{e}}^{j\omega }}} \right) = \frac{1}{T}{H_a}\left( {j\frac{\omega }{T}} \right){\rm{       }}\left| \omega  \right| \le \pi 
$$
但是任何一实际的模拟滤波器，都不是带宽绝对有限的，因此，通过脉冲响应不变变换法所得的数字滤波器就不可避免地要出现频谱的混叠失真如图5.5.3所示。只有当模拟滤波器频响在折叠频率以上衰减很大。混叠失真很小时，采用脉冲响应不变法设计的数字滤波器才能满足精度的要求。

<img src=".\fig\5.5.3.png">

<center>图5.5.3 脉冲响应不变变换法中的频谱混叠现象


应该注意，在设计中，当滤波器的指标用数字域频率$\omega $给定时，不能用减小$T$的办法解决混叠问题。如设计截止频率为叫$\omega {{\kern 1pt} _ c}$的低通滤波器，则要求相应模拟滤波器的截止频率为$\Omega {{\kern 1pt} _ c} = \frac{\omega }{T}$，$T$减小时，只有让$\Omega {{\kern 1pt} _ c}$倍数的增大，才能保证给定的_$\omega {{\kern 1pt} _c}$不变。$T$减小使带域$\left[ { - \frac{\pi }{T},\frac{\pi }{T}} \right]$加宽了，但也$\Omega {{\kern 1pt} _c}$倍数加宽，所以如果在$\left[ { - \frac{\pi }{T},\frac{\pi }{T}} \right]$一带域外有非零的${H_a}\left( s \right)$值，即$\Omega {{\kern 1pt} _c}{\kern 1pt}  > \frac{\pi }{T}$则不论如何减小$T$,由于$\Omega $与$T$成同样倍数变化，总还是$\Omega {{\kern 1pt} _c}{\kern 1pt}  > \frac{\pi }{T}$，不能解决混叠问题。

### 5.5.2 模拟滤波器的数字化

在脉冲响应不变变换法设计中，由一个较为复杂的模拟系统函数(或脉冲响应)求出数字滤波器系统函数(或单位采样响应)是一个很麻烦的变换过程。因为乘积的$z$变换并不等于各部分变换的乘积，所以在这里不宜采用级联分解。但各项和的$z$变换是线性关系，因而用部分分式表达系统函数，特别适合于对复杂模拟系统函数的变换。现实的系统通常是分母的阶数$N$，高于分子的阶数$M$，这时系统若只有单极点(若不是单极点情况，则求逆拉氏变换要复杂一些)，则可将模拟滤波器的系统函数${H_a}\left( s \right)$表达为如下的部分分式形式
$$
{H_a}\left( s \right) = \sum\limits_{i = 1}^N {\frac{{{A_i}}}{{s + {s_i}}}}  \tag{5.5.3}
$$
相应的单位脉冲响应是
$$
{h_a}\left( s \right) = {L^{ - 1}}\left[ {{H_a}\left( s \right)} \right] = \sum\limits_{i = 1}^N {{A_i}} {{\rm{e}}^{ - {s_i}t}}u\left( n \right) \tag{5.5.4}
$$
式中$u\left( t \right)$是单位阶跃响应。根据脉冲响应不变变换法的意义，数字滤波器的单位采样响应是
$$
h\left( n \right) = {h_a}\left( {nT} \right) = \sum\limits_{i = 1}^N {{A_i}} {{\rm{e}}^{ - {s_i}nT}}u\left( n \right) = \sum\limits_{i = 1}^N {{A_i}{{\left( {{{\rm{e}}^{ - {s_i}T}}} \right)}^n}} u\left( n \right)
$$


数字滤波器的系统函数$H\left( z \right)$则为
$$
\begin{array}{l}
H\left( z \right) = \sum\limits_{m =  - \infty }^\infty  {h\left( n \right){z^{ - n}} = \sum\limits_{n = 0}^\infty  {\sum\limits_{i = 1}^N {{A_i}} } } {{\rm{e}}^{ - {s_i}nT}}{z^{ - n}}\\
{\rm{                                }} = {\sum\limits_{i = 1}^N {{A_i}\sum\limits_{n = 0}^\infty  {\left( {{{\rm{e}}^{ - {s_i}T}}{z^{ - 1}}} \right)} } ^n}\\
{\rm{                                }} = \sum\limits_{i = 1}^N {\frac{{{A_i}}}{{1 - {{\rm{e}}^{ - {s_i}T}}{z^{ - 1}}}}} 
\end{array} \tag{5.5.5}
$$
将上式与 (5.5.3) 式相比可见，由${H_a}\left( s \right)$至$H\left( z \right)$间的变换关系为
$$
\frac{1}{{s + {s_i}}} \Leftrightarrow \frac{1}{{1 - {{\rm{e}}^{ - {s_i}T}}{z^{ - 1}}}} = \frac{z}{{z - {{\rm{e}}^{ - {s_i}T}}}}\tag{5.5.6}
$$
(5.5.6) 式说明：

${H_a}\left( s \right)$与$H\left( z \right)$的各部分分式的系数是相同的均为${A_i}$；

极点是以$z = {{\rm{e}}^{ - {s_i}T}}$的关系进行映射的，${H_a}\left( s \right)$的极点$s =  - {s_i}$变成了$H\left( z \right)$的$z = {{\rm{e}}^{ - {s_i}T}}$的极点；${H_a}\left( s \right)$与$H\left( z \right)$间的零点没有一一对应的关系，一般说来，它是由极点和各系数${A_i}$决定的一个函数关系。

根据以上分析，脉冲响应不变变换法的设计步骤可不再经历${H_a}\left( s \right) \to {h_a}\left( t \right) \to $$h\left( {nT} \right) \to H\left( z \right)$的过程，而是直接将${H_a}\left( s \right)$写成许多单极点的部分分式之和的形式，然后将备个部分分式用  (5.5.6) 式的关系进行替代,即可得所需的数字滤波器系统函数$H\left( z \right)$。

**例** 设已给定模拟滤波器的系统函数为
$$
{H_a}\left( s \right) = \frac{{s + a}}{{{{\left( {s + a} \right)}^2} + {b^2}}} = \frac{{\frac{1}{2}}}{{s + a + jb}} + \frac{{\frac{1}{2}}}{{s + a - jb}}
$$
直接应用 (5.5.6) 式得到脉冲响应不变变换法设计的数字滤波器的系统函数为
$$
H\left( z \right) = \frac{{\frac{1}{2}}}{{1 - {{\rm{e}}^{ - aT}}{{\rm{e}}^{ - jbT}}{z^{ - 1}}}} + \frac{{\frac{1}{2}}}{{1 - {{\rm{e}}^{ - aT}}{{\rm{e}}^{jbT}}{z^{ - 1}}}} = \frac{{z\left( {z - {{\rm{e}}^{ - aT}}\cos bT} \right)}}{{\left( {z - {{\rm{e}}^{ - aT}}{{\rm{e}}^{ - jbT}}} \right)\left( {z - {{\rm{e}}^{ - aT}}{{\rm{e}}^{jbT}}} \right)}}\tag{5.5.7}
$$
由此例可见，模拟系统函数仅一个零点：$s =  - a$，而相应的数字系统却有两个零点：$z = 0$和$z = {{\rm{e}}^{ - aT}}\cos bT$，而且都不是用$s =  - a$经$z = {{\rm{e}}^{ - sT}}$映射后得到的。

图5.5.4 画出了此例的极，零点分布图和频率特性图。由图可见，所设计出的数字滤波器是稳定的，由于${H_a}\left( {j\Omega } \right)$在$\Omega  > \frac{\pi }{T}$点以上仍有明显的非零值，因而数字滤波器频率响应中混叠效应明显，使得$H\left( {{{\rm{e}}^{j\omega }}} \right)$的图形在$\omega  \to \pi $时比${H_a}\left( {j\Omega } \right)$的图形在$\Omega {{\kern 1pt} _c} \to \frac{\pi }{T}$时下降得慢。

雷道(Rader)和戈尔德(Gold)提出了脉冲响应不变变换法的又一问题。由(5.5.2)式可见，频响$H\left( {{{\rm{e}}^{j\omega }}} \right)$与$T$成反比。数字滤波器在$T$很小(或说采样频率很高)时,可能具有不希望的高增益，故作以下简单修正：取$h\left( n \right) = T{h_a}\left( {nT} \right)$为数字系统的单位采样响应。因此实际中通常不是取 (5.5.5) 式而是取下式进行设计
$$
H\left( z \right) = \sum\limits_{i = 1}^N {\frac{{TA}}{{1 - {{\rm{e}}^{ - {s_i}T}}{z^{ - 1}}}}} 
$$
这时
$$
H\left( {{{\rm{e}}^{j\omega }}} \right) = \sum\limits_{m =  - \infty }^\infty  {{H_a}\left( {j\frac{{\omega  + 2\pi m}}{T}} \right)}  \approx {H_a}\left( {j\frac{\omega }{T}} \right){\rm{       }}\left| \omega  \right| < \pi \tag{5.5.8}
$$
从而数字滤波器的增益，不随采样频率而变化。

<img src=".\fig\5.5.3.png">

<center>图5.5.4 脉冲响应不变变换法设计数字滤波器的例图


<center>(a)	某二阶模拟系统的极、零点图和频率响应图


<center>(b)	上述系统经采样后得到的时域离散系统的极、零点图和频率响应图


### 5.5.3 逼近的情况

首先，稳定的模拟滤波器所有极点在平面$s$的左半平面内，其实部${\delta _i} < 0$,则${{\rm{e}}^{{s_i}T}}$的模${{\rm{e}}^{{\delta _i}T}} < 1$，故在脉冲响应不变变换法设计的相应的数字滤波器中，极点是在单位圆的内部，因而脉冲响应不变变换法所设计的数字滤波器也是稳定的。

其次，由图5.5.2 可见，当稳态时，$s$平面的虚轴映射在$z$平面的单位圆上，而且处处落在此圆上，所以脉冲响应不变变换法的逼近是良好的，但仅限于$\Omega $自$ - \frac{\pi }{T}$至$\frac{\pi }{T}$的范围。

### 5.5.4 优缺点

脉冲响应不变变换法的一个重要特点是频率坐标的变换是线性的，$\omega  = \Omega T$。因此，如果模拟滤波器的频响是限带于折叠频率以内的话，则通过变换后所得的数字滤波器的频响可以不失真的反映原响应与频率的关系
$$
H\left( {{{\rm{e}}^{j\Omega T}}} \right) = H\left( {j\Omega } \right)
$$
脉冲响应不变变换法最大缺点是有频谱的周期延拓效应，因此，只能用于限带的频响特性，如衰减特性很好的低通，或带通，而且高頻衰减越大，頻响的混叠效应就越小。对于高通、带阻滤波器，由于它们在高频部分不衰减，当一定要追求频率线性关系而采用脉冲响应不变变换法时，必须先对模拟高通和带阻滤波器加一保护滤波器，滤掉髙于折叠频率以上的频率，然后再转变为数字滤波器以避免混叠失真。

脉冲响应不变变换法或阶跃响应不变变换法，主要用于设计某些要求在时域上能模仿模拟滤波器的功能（例如控制脉冲响应或阶跃响应）的数字滤波器。这样，可把模拟滤波器时域特性的许多优点在相应的数字滤波器中保留下来。其它情况下设计IIR数字滤波器时，多用下面介绍的双线性变换。

### 5.5.5 用脉冲响应不变变换法设计数字巴特渥斯滤波器

由模拟低通滤波器设计数字低通滤波器这种设计法，首先的和主要的工作是根据模拟域指标设计出满足技术要求的模拟滤波器。如果给定的是数字域指标，则必须要把它转换为模拟域指标进行设计剩下的工作就是通过脉冲响应不变变换法或双线性变换法将所求得的模拟滤波器的系统函数${H_a}\left( s \right)$数字化为数字滤波器的系统函数$H\left( z \right)$。下面给出实例，具体说明模拟低通—数字低通的变换方法。

要求其指标为：在如$\omega  \le 0.2\pi $的通带范围内幅度特性变化（下降)小于l dB，在$0.3 \le \omega  \le \pi $的阻带范围内，衰减大于15dB。按照衰减的定义
$$
\left\{ {\begin{array}{*{20}{c}}
{20{{\log }_{10}}\left| {\frac{{H\left( {{{\rm{e}}^{j0}}} \right)}}{{H\left( {{{\rm{e}}^{j0.2\pi }}} \right)}}} \right| \le 1}\\
{20{{\log }_{10}}\left| {\frac{{H\left( {{{\rm{e}}^{j0}}} \right)}}{{H\left( {{{\rm{e}}^{j0.3\pi }}} \right)}}} \right| \ge 15}
\end{array}} \right.
$$
如果通带幅度在$\omega  = 0$处归一化为1，即$\left| {H\left( {{{\rm{e}}^{j0}}} \right)} \right| = 1$

，则上两式变为
$$
20{\log _{10}}\left| {H\left( {{{\rm{e}}^{j0.2\pi }}} \right)} \right| \ge  - 1\tag{5.5.9}
$$
及
$$
20{\log _{10}}\left| {H\left( {{{\rm{e}}^{j0.3\pi }}} \right)} \right| \le  - 15\tag{5.5.10}
$$
设计步骤如下

将设计要求转变为按模拟频率表示的对模拟滤波器的要求

已经指出，当不存在混叠时，脉冲响应不变变换法从模拟频率到数字频率映射是线性的。通常先忽略混叠效应.待设计完成后再对所得滤波器的性能进行校验。

由 (5.5.8) 式可知$H\left( {{{\rm{e}}^{j\omega }}} \right) = {H_a}\left( {j\frac{\omega }{T}} \right) = {H_a}\left( {j\Omega } \right)$，$\left| \omega  \right| \le \pi $。同时为简便计，假设参数*T*为1。

因此，可直接写出本例题的模拟指标如下。
$$
20{\log _{10}}\left| {{H_a}\left( {j0.2\pi } \right)} \right| \ge  - 1\tag{5.5.11}
$$

$$
20{\log _{10}}\left| {{H_a}\left( {j0.3\pi } \right)} \right| \le  - 15\tag{5.5.12}
$$

计算滤波器所需阶数$N$及截止频率$\Omega {{\kern 1pt} _c}$

巴特渥斯滤波器的形式为：
$$
{\left| {{H_a}\left( {j\Omega } \right)} \right|^2} = \frac{1}{{1 + {{\left( {\frac{\Omega }{{\Omega {{\kern 1pt} _c}}}} \right)}^{2N}}}}
$$
因而设计归结为根据给定指标来确定参数$N$及$\Omega {{\kern 1pt} _c}$。将上式以dB表示则得
$$
20{\log _{10}}\left| {{H_a}\left( {j\Omega } \right)} \right| =  - 10{\log _{10}}\left[ {1 + {{\left( {\frac{\Omega }{{\Omega {{\kern 1pt} _c}}}} \right)}^{2N}}} \right]
$$
将给定指标代入得
$$
 - 10{\log _{10}}\left[ {1 + {{\left( {\frac{{0.2\pi }}{{\Omega {{\kern 1pt} _c}}}} \right)}^{2N}}} \right] \ge  - 1\tag{5.5.13}
$$

$$
 - 10{\log _{10}}\left[ {1 + {{\left( {\frac{{0.3\pi }}{{\Omega {{\kern 1pt} _c}}}} \right)}^{2N}}} \right] \le  - 15\tag{5.5.14}
$$

首先考虑用等号来满足指标，于是
$$
1 + {\left( {\frac{{0.2\pi }}{{\Omega {{\kern 1pt} _c}}}} \right)^{2N}} = {10^{0.1}}\tag{5.5.15}
$$

$$
1 + {\left( {\frac{{0.3\pi }}{{\Omega {{\kern 1pt} _c}}}} \right)^{2N}} = {10^{1.5}}\tag{5.5.16}
$$

解上二方程得$N = 5.8858$和${\Omega _c} = 0.70474$。N为滤波器阶次，只能取整数，为满足或超过给定指标，取$N = 6$。将$N = 6$代入通带条件条件 (5.5.15) 式中，得${\Omega _c} = 0.7032$。显然采用此值正好可满足通带指标，同时还给阻带的要求留下一定的裕量,这对更好地防止数字滤波器中的频谱混叠效应是有好处的。

由求得的$N$，${\Omega _c}$确定s平面上滤波器的极点分布。

取${\Omega _c} = 0.7032$，$N = 6$带入到 (5.4.7) 式中，解出左半s平面的三对极点，其坐标分别为
$$
\Omega {{\kern 1pt} _c}\left( {\cos {{105}^\circ } \pm j\sin {{105}^\circ }} \right) =  - 0.182001553 \pm j0.67923
$$

$$
\Omega {{\kern 1pt} _c}\left( {\cos {{135}^\circ } \pm j\sin {{135}^\circ }} \right) =  - 0.497237489 \pm j0.497237489$\Omega {{\kern 1pt} _c}\left( {\cos {{105}^\circ } \pm j\sin {{105}^\circ }} \right) =  - 0.182001553 \pm j0.679239041$
$$

$$
\Omega {{\kern 1pt} _c}\left( {\cos {{165}^\circ } \pm j\sin {{165}^\circ }} \right) =  - 0.679239041 \pm j0.182001553
$$



由 (5.4.6) 式可得模拟滤波器系统函数
$$
{H_a}\left( s \right) = \frac{{0.12093}}{{\left( {{s^2} + 0.3640{\rm{s}} + 0.4945} \right)\left( {{s^2} + 0.9945{\rm{s}} + 0.4945} \right)\left( {{s^2} + 1.3585{\rm{s}} + 0.4945} \right)}}
$$
系数0.12093是根据$s = 0$时，${H_a}\left( 0 \right) = 1$而得到的。也可由表5.4.1查得。

将${H_a}(s)$展成部分分式，并作 (5.5.8) 式变换,求得数字滤波器的系统函数
$$
H\left( z \right) = \frac{{0.2871 - 0.4466{z^{ - 1}}}}{{1 - 1.297{z^{ - 1}} + 0.6949{z^{ - 2}}}} + \frac{{ - 2.1428 + 1.1454{z^{ - 1}}}}{{1 - 1.0691{z^{ - 1}} + 0.3699{z^{ - 2}}}} + \frac{{1.8558 - 0.6304{z^{ - 1}}}}{{1 - 0.9972{z^{ - 1}} + 0.2570{z^{ - 2}}}}
$$
用级联型或直接型结构实现，则还需将各二阶子式按一定方式组合起来。

当$z = {{\rm{e}}^{j\omega }}$，即得数字滤波器的频率响应，如图5.5.5所示。由图可见，所设的滤波器在通带边缘$\left( {0.2\pi } \right)$处恰好满足指标要求，而在阻带边缘,则超出要求。这表明滤波器的带宽是充分受限的，因而混叠的影响可以忽略。若得出的数字滤波器并不满足指标要求，则可用更高阶的滤波器或者调节滤波器的参数而维持阶数不变，再行试算。

**例程****5.5.1**

实现上述滤波器

% 指标

T = 1;

fs = 1;

Wp = 0.2*pi;

Ws = 0.3*pi;

Ap = 1; %dB

As = 15; %dB

% 模拟原型滤波器

[N,Wc] = buttord(Wp,Ws,Ap,As,'s'); 

[z,p,k] = buttap(N);

[num,den] = zp2tf(z,p,k);

% 数字滤波器

[B,A] = butter(N,Wc,'s');

[D,C] = impinvar(B,A,fs);

W = linspace(0,pi); 

H = freqz(D,C,W);

mag = abs(H)/abs(H(1));

dbmag = 20*log10(mag);

phase = angle(H); 

degphase = phase*180/pi; 

subplot(3,1,1), plot(W/pi,abs(H))；

subplot(3,1,2), plot(W/pi,dbmag)；

subplot(3,1,3), plot(W/pi,degphase)；

<img src=".\fig\5.5.5.png">

<center>图5.5.5 用脉冲响应不变变换法所设计的六阶巴特沃斯滤波器频率响应


## 5.6  双线性变换法

### 5.6.1 变换原理

为了克服脉冲响应不变变换法可能产生的频谱混叠效应的缺点，凯塞(Kaiser)和戈尔登(Golden)建议用一种新的有效的变换，这就是双线性变换。双线性变换可认为是基于对微分方程的积分，利用对积分的数值逼近得到的。

研究一阶微分方程描述的系统
$$
{C_1}y'\left( t \right) = {C_0}y\left( t \right) = {d_0}x\left( t \right)\tag{5.6.1}
$$
对上式取拉氏变换即得模拟系统函数
$$
{H_a}\left( s \right) = \frac{{Y\left( s \right)}}{{X\left( s \right)}} = \frac{{{d_0}}}{{{C_1}s + {C_0}}}
$$
$y\left( t \right)$可以写成$y'\left( t \right)$的积分
$$
y\left( t \right) = \int_{{t_0}}^t {y'\left( t \right)d\tau  + y\left( {{t_0}} \right)} 
$$
以采样形式表示，令$t = nT$，${t_0} = (n - 1)T$可得到
$$
y\left( {nT} \right) = \int_{\left( {n - 1} \right)T}^{nT} {y'\left( \tau  \right)d\tau  + y\left[ {\left( {n - 1} \right)T} \right]} 
$$
用梯形近似求定积分，则上式逼近为
$$
$y\left( {nT} \right) = \left\{ {\frac{{y'\left( {nT} \right) + y'\left[ {\left( {n - 1} \right)T} \right]}}{2}} \right\}T + y\left[ {\left( {n - 1} \right)T} \right]$
$$
或写作
$$
y\left( {nT} \right) - y\left[ {\left( {n - 1} \right)T} \right] = \frac{T}{2}\left[ {y'\left( {nT} \right) + y'\left( {n - 1} \right)T} \right]
$$
式中微分由 (5.6.1) 式采样得到，即
$$
y'\left( {nT} \right) = \frac{{ - {C_0}}}{{{C_1}}}y\left( {nT} \right) + \frac{{{d_0}}}{{{C_1}}}x\left( {nT} \right)
$$
式中
$$
\begin{array}{l}
y\left( n \right) = y\left( {nT} \right)\\
y\left( {n - 1} \right) = y\left[ {\left( {n - 1} \right)T} \right]\\
x\left( n \right) = x\left( {nT} \right)\\
x\left( {n - 1} \right) = x\left[ {\left( {n - 1} \right)T} \right]
\end{array}
$$
对上式取$z$变换，并解得$H\left( z \right)$为
$$
H\left( z \right) = \frac{{Y\left( z \right)}}{{X\left( z \right)}} = \frac{{{d_0}}}{{{C_1}\frac{2}{T}\frac{{1 - {z^{ - 1}}}}{{1 + {z^{ - 1}}}} + {C_0}}}
$$
比较${H_a}\left( s \right)$和$H\left( z \right)$的表达式可见，$H\left( z \right)$可由${H_a}\left( s \right)$作下述的变量代换而得到
$$
s = \frac{2}{T}\frac{{1 - {z^{ - 1}}}}{{1 + {z^{ - 1}}}}\tag{5.6.2}
$$
由(5.6.2)式可以解得
$$
z = \frac{{1 + \left( {\frac{T}{2}} \right)s}}{{1 - \left( {\frac{T}{2}} \right)s}} = \frac{{\frac{2}{T} + s}}{{\frac{2}{T} - {\rm{s}}}}\tag{5.6.3}
$$
这样就得到了 *j*平面与*z*平面的双线性变换关系。它所以叫做“双线性”变换，仅仅是指变换公式中*s*与*z*的关系无论是分子部分，还是分母部分都是“线性”而言。上述结果显然是由一阶系统得出的，但它对高阶系统也照样成立，因为*N*阶微分方程可以写成*N*个一阶微分方程。

### 5.6.2 模拟滤波器的数字化

由于双线性变换法中，$s$与$z$之间有简单的代数关系，故可由模拟系统函数通过代数置换直接得到数字滤波器的系统函数,即:
$$
H\left( z \right) = {H_a}\left( s \right)\left| {_{s = \frac{2}{T}\frac{{1 - {z^{ - 1}}}}{{1 + {z^{ - 1}}}}}} \right. = {H_a}\left( {\frac{2}{T}\frac{{1 - {z^{ - 1}}}}{{1 + {z^{ - 1}}}}} \right)\tag{5.6.4}
$$
可见数字滤波器的极点数等于模拟滤波器的极点数。

频率响应也可用直接置换得到
$$
H\left( {{{\rm{e}}^{j\omega }}} \right) = {H_a}\left( {j\Omega } \right)\left| {_{\Omega  = \frac{2}{T}tg\left( {\frac{\omega }{2}} \right)}} \right. = {H_a}\left[ {j\frac{2}{T}tg\left( {\frac{\omega }{2}} \right)} \right]\tag{5.6.5}
$$
这一公式可用于将滤波器的数字域指标，转换为模拟域指标。

再者，可在未进行双线性变换前把原模拟系统函数分解成并联或级联子系统函数，然后再对每个子系统函数分别加以双线性变换。就是说，所有的分解，都可以就模拟滤波器系统函数来进行，因为模拟滤波器已有大量图表可资利用，且分解模拟系统函数比较容易。

### 5.6.3 逼近的情况

双线性变换具备模拟域到数字域映射变换的总要求。

将$s = \sigma  + j\Omega $代入到 (5.6.3) 式则得
$$
z = \frac{{\frac{2}{T} + \sigma  + j\Omega }}{{\frac{2}{T} - \sigma  - j\Omega }}
$$
或
$$
\left| Z \right| = {\left| {\frac{{{{\left( {\frac{2}{T} + \sigma } \right)}^2} + {\Omega ^2}}}{{{{\left( {\frac{2}{T} - \sigma } \right)}^2} + {\Omega ^2}}}} \right|^{\frac{1}{2}}}\tag{5.6.6}
$$
由上式可见，当$\sigma  < 0$时，$\left| z \right| = 1$；当$\sigma  > 0$时，$\left| z \right| > 1$。这就是说双线性变换把*s*左半开平面映射在单位圆$\left| z \right| = 1$的内部；把平面的整个$j\Omega $

轴映射成单位圆$\left| z \right| = 1$，把*s*右半开平面映射在单位圆$\left| z \right| = 1$的外部。双线性变换的*s*平面与*z*平面的映射关系如图5.6.1所示。

<img src=".\fig\5.6.1.png">

<center>图5.6.1 双线性变换的映射关系


令$s = j\Omega ,z = {{\rm{e}}^{j\omega }}$，则由(5.6.3)式得
$$
{{\rm{e}}^{j\omega }} = \frac{{\frac{2}{T} + j\Omega }}{{\frac{2}{T} - j\Omega }}
$$
所以
$$
\omega  = arctg\left( {\frac{{\Omega T}}{2}} \right)
$$
由此得出模拟滤波器的频率$\Omega $和导出的数字滤波器频率$\omega $的关系式为
$$
\Omega  = \frac{2}{T}tg\left( {\frac{\omega }{2}} \right)\tag{5.6.7}
$$
这一公式的关系如图5.6.2所示。可以看出，当$\Omega  = 0$时，$\omega  = 0$，当$\Omega  =  + \infty $时，$\omega  = \pi $。当$\Omega  =  - \infty $时，$\omega  =  - \pi $，这就是说*s*平面的原点映射为*z*平面(1, 0)点，而*s*平面的正$j\Omega $轴和负$j\Omega $轴分別映射成*z*平面单位圆$\left| z \right| = 1$上半圆和下半圆。

<img src=".\fig\5.6.2.png">

<center>图5.6.2 双线性变换的频率非线性关系


由上所述，可得如下结论：

模拟滤波器${H_a}\left( s \right)$中最大和最小值将保留在数字滤波器$H\left( {{{\rm{e}}^{j\omega }}} \right)$中，因此模拟滤波器的通带或阻带变换成数字滤波器的通带或阻带。

如果模拟滤波器是稳定的，则通过双线性变换后所得的数字滤波器也一定是稳定的。

由于$s$平面的整个$j\Omega $轴映射为$z$平面上的单位圆，因此双线性变换法确实消除了脉冲响应不变变换法所存在的混叠误差，所以逼近是良好的。但由 (5.6.7) 式可见，在频率与$\omega $间存在严重的非线性。

### 5.6.4 优缺点

线性变换法的主要优点是消除了脉冲响应不变变换法所固有的混叠误差。这是由于$s$平面的整个沿$j\Omega $轴单值地对应于$z$平面单位圆一周的缘故。数字域频率$\omega $与模拟频率$\Omega $关系已在 (5.6.7) 式中示出，并已画于图5.6.2上。由图可见，在零频附近，模拟频率$\Omega $与数字频率$\omega $如的关系接近于线性值。*T*值愈小，即采样频率愈高，则成线性关系的频率范围愈大。当$\Omega $进一步增长时，$\omega $增长变慢，二者不再是线性关系了。最后当$\Omega  \to \infty $, $\omega $终止在折叠频率$\omega  = \pi $处，从而双线性变换不会出现由干高频部分超过折叠频率而混叠到低频部分去的现象。这意味着，模拟滤波器全部频率响应特性被压缩于等效的数字频率范围$0 < \omega  < \pi $之内。这种情况如图5.6.3所示。可见，双线性变换消除混叠的这个特点是靠频率的严重非线性而得到的。

<img src=".\fig\5.6.2.png">

<center>图5.6.3 双线性变换法频谱压缩示意图


双线性变换法的缺点是频率$\Omega $与$\omega $间的非线性。这种非线性关系要求被变换的连续时间系统的幅度响应必须是分段常数型的(某一段频率范围幅度响应近似于某一常数)，不然所映射出的数双线性变换法的缺点是频率$\Omega $与$\omega $间的非线性。这种非线性关系要求被变换的连续时间系统的幅度响应必须是分段常数型的（某一段频率范围幅度响应近似于某一常数），不然所映射出的数字频率响应相对于原来的模拟频率响应会产生变形。例如，双线性变换不能将模拟微分器变换成数字微分器，但是对于低通、高通、带通、带阻模拟滤波器，频率响应都是分段常数型的，可采用双线性变换，只要截止频率点映射正确，即可消除变换中所带来的频率间的非线性畸变。实际解决双线性变换中的频率非线性关系的方法有两种。

1) 在低频段，模拟与数字两滤波器的频率关系处于近似的线性范围之内，故可忽略非线性影响。
2) 采用补偿的办法，也可称为预畸的方法

预畸设计法如图5.6.4所示。设所希望的数字滤波器的四个截止频率为$\omega {{\kern 1pt} _1}$、$\omega {{\kern 1pt} _2}$、$\omega {{\kern 1pt} _3}$、$\omega {{\kern 1pt} _4}$。利用 (5.6.7) 式的频率变换关系，求出对应的4个模拟截止频率为$\Omega {{\kern 1pt} _1}$、$\Omega {{\kern 1pt} _2}$、$\Omega {{\kern 1pt} _3}$、$\Omega {{\kern 1pt} _4}$，

而模拟滤波器 就按此畸变了的截止频率组进行设计。对这个模拟滤波器作双线性变换，便可得到具有要求的截止频率$\omega {{\kern 1pt} _1}$、$\omega {{\kern 1pt} _2}$、$\omega {{\kern 1pt} _3}$、$\omega {{\kern 1pt} _4}$的数字滤波器。

模拟与数字两域频率间的非线性关系还会造成变换后滤波器的相位特性失真。对线性相位特性的模拟滤波器进行双线性变换后所得的数字滤波器就不再保持线性相位特性了。

<img src=".\fig\5.6.4.png">

<center>图5.6.4 双线性变换时频率的预畸


### 5.6.5 用双线性变换法设计数字切比雪夫滤波器

应该指出，双线性变换法设计数字滤波器时，如果是在模拟域给定指标的，则应该首先将模拟频率$\Omega $按照$\omega  = \Omega T$的线性关系得到数字域频$\omega $，然后再按照预畸的关系得到相应的模拟域指标，按此指标进行模拟滤波器设计后，按双线变换法将模拟滤波器转换为数字滤波器即可。

针对5.5.5案例指标，用双线性变换法设计数字切比雪夫滤波器，仍按 (5.5.9) 式，(5.5.10) 式的技术条件进行设计，步骤如下：

将数字域指标变为相应的模拟域指标

为解决双线性变换频率非线性关系，模拟域频率必须对于相应的数字域频率作预畤，即按$\Omega  = \frac{2}{T}tg\left( {\frac{\omega }{2}} \right)$求出对应的模拟滤波器频率，故有${H_a}\left( {j\Omega } \right) = {H_a}\left( {j\frac{2}{T}tg\left( {\frac{\omega }{2}} \right)} \right)$为简便计，仍取$T = 1$，则所给出的对数字滤波器的设计要求转化为如下的对模拟滤波器的要求
$$
20{\log _{10}}\left| {{H_a}\left( {j2tg\left( {\frac{{0.2\pi }}{2}} \right)} \right)} \right| \ge  - 1\tag{5.6.8}
$$
及
$$
20{\log _{10}}\left| {{H_a}\left( {j2tg\left( {\frac{{0.3\pi }}{2}} \right)} \right)} \right| \le  - 15\tag{5.6.9}
$$
由此可见，在实现由数字滤波器的设计要求转化为对模拟滤波器的设计要求中，就已经考虑了频率预畸。

求$\varepsilon $

显然，$\Omega {{\kern 1pt} _c} = 2tg\left( {\frac{{0.2\pi }}{2}} \right) = 0.6498394$。我们选择在$\Omega {{\kern 1pt} _c}$处精确地满足技术指标，在$\Omega  = 0 - \Omega {{\kern 1pt} _c}$处具有等波纹的频率响应。根据 (5.4.13) 式可求得
$$
\varepsilon  = \sqrt {{{10}^{\frac{\delta }{{10}}}} - 1}  = \sqrt {{{10}^{0.1}} - 1}  = 0.50885
$$
根据 (5.4.15) 式计算阶次N

由$10{\log _{10}}{A^2}\left( {\Omega {{\kern 1pt} _s}} \right) \le  - 15$的指标要求可求出
$$
10{\log _{10}}{A^2}\left( {\Omega {{\kern 1pt} _s}} \right) \le {10^{ - 1.5}} = 0.0316227
$$
因此
$$
N \ge \frac{{c{h^{ - 1}}\left[ {\frac{1}{\varepsilon }\sqrt {\frac{1}{{{A^2}\left( {{\Omega _s}} \right)}} - 1} } \right]}}{{c{h^{ - 1}}\left( {\frac{{{\Omega _s}}}{{{\Omega _c}}}} \right)}} = \frac{{c{h^{ - 1}}\left[ {\frac{1}{{0.50885}}\sqrt {{{10}^{0.1}} - 1} } \right]}}{{c{h^{ - 1}}\left( {\frac{{2tg(\frac{{0.3\pi }}{2})}}{{2tg(\frac{{0.2\pi }}{2})}}} \right)}} \ge 3.014066\tag{5.6.10}
$$
选定$N = 4$

计算$\alpha$，及$a,b$

由 (5.4.22) 式得
$$
\alpha  = \frac{1}{\varepsilon } + \sqrt {\frac{1}{{{\varepsilon ^2}}} + 1}  = 4.1702
$$
由 (5.4.20) 式得
$$
a = \frac{1}{2}\left( {{a^{\frac{1}{N}}} - {a^{ - \frac{1}{N}}}} \right) = 0.3646235
$$
由 (5.4.21) 式得
$$
b = \frac{1}{2}\left( {{a^{\frac{1}{N}}} - {a^{ - \frac{1}{N}}}} \right) = 1.0644015
$$
进而求得
$$
\begin{array}{l}
a{\kern 1pt} {\kern 1pt} \Omega {{\kern 1pt} _c} = 0.2369322\\
b{\kern 1pt} {\kern 1pt} \Omega {{\kern 1pt} _c} = 0.691648
\end{array}
$$
求左半$s$平面的两对极点
$$
 - a{\kern 1pt} {\kern 1pt} {\Omega _c}\sin \frac{\pi }{8} \pm jb{\kern 1pt} {\kern 1pt} \Omega {{\kern 1pt} _c}\cos \frac{\pi }{8} =  - 0.0906699 \pm j0.6389997
$$

$$
 - a{\kern 1pt} {\kern 1pt} \Omega {{\kern 1pt} _c}\sin \frac{{3\pi }}{8} \pm jb{\kern 1pt} {\kern 1pt} \Omega {{\kern 1pt} _c}\cos \frac{{3\pi }}{8} = 0.2188969 \pm j0.2646819
$$

求模拟滤波器的系统函数${H_a}(s)$

由所求极点及 (5.4.23) 式得
$$
{H_a}\left( s \right) = \frac{C}{{\prod\limits_{i = 1}^N {\left( {s - {s_i}} \right)} }} = \frac{{0.04381}}{{\left( {{s^2} + 0.4378{\rm{s}} + 0.1180} \right)\left( {{s^2} + 0.1814{\rm{s}} + 0.4166} \right)}}\tag{5.6.11}
$$
式中分子$C$是这样求得的：由图5.4.5(b) 可见，切比雪夫I型滤波器，当*N*为偶数时,在$s = 0$处,${H_a}(s) = 1/\sqrt {1 + {\varepsilon ^2}} $,应与 (5.6.11) 式在$s = 0$时的值相等，从而求得$c = 0.04381$。

求数字滤波器的系统函数$H\left( z \right)$

对$H\left( z \right)$作双线性变换后求得
$$
H\left( z \right) = {\left. {{H_a}\left( s \right)} \right|_{s = \frac{{2\left( {1 - {z^{ - 1}}} \right)}}{{T\left( {1 + {z^{ - 1}}} \right)}}}} = \frac{{0.001836{{\left( {1 + {z^{ - 1}}} \right)}^4}}}{{\left( {1 - 1.4996{z^{ - 1}} + 0.8482{z^{ - 2}}} \right)\left( {1 - 1.5548{z^{ - 1}} + 0.6493{z^{ - 2}}} \right)}}\tag{5.6.12}
$$
所设汁的数字滤波器的幅频和相频响应示于图5.6.5。

**例程****5.6.1**

实现上述滤波器

% 数字域指标：

T = 1;

fs = 1;

Wp = 0.2*pi; % 数字频率

Ws = 0.3*pi; % 数字频率

Ap = 1;    %dB

As = 15;   %dB

% 预畸：

wp = 2/T*tan(Wp/2); % 模拟角频率

ws = 2/T*tan(Ws/2); % 模拟角频率

% 求N，wp：

[N,wp] = cheb1ord(wp,ws,Ap,As,'s')

%设计模拟滤波器：

[B,A] = cheby1(N,Ap,wp,"low","s");

% 采用双线性变换法设计：

[Dz,Cz] = bilinear(B,A,fs);

% 画幅频、相频图：

W = linspace(0,pi); 

H = freqz(Dz,Cz,W);

mag = abs(H)/abs(H(1));

dbmag = 20*log10(mag);

phase = angle(H); 

degphase = phase*180/pi; 

subplot(3,1,1), plot(W,abs(H));

subplot(3,1,2), plot(W,dbmag);

subplot(3,1,3), plot(W,degphase);

<img src=".\fig\5.6.5.png">

<center>图5.6.5 双线性变换法所设计的四阶切比雪夫滤波器频率响应


样，在上面的举例中，也可应用脉冲响应不变变换法设计切比雪夫数字滤波器。这时应按 (5.5.8) 式将数字域指标转换为模拟域指标,并且最后对所求得的${H_a}\left( s \right)$进行脉冲响应不变变换，以求得数字滤波器的系统函数$H\left( z \right)$，其余步骤与按双线性变换法设计切比雪夫数字滤波器相同。请读者按照上述思路，并根据例中给出的指标要求，用双线性变换法设计巴特沃斯数字滤波器及用脉冲响应不变变换法设计切比雪夫数字滤波器。

### 5.6.6 用双线性变换法设计数字巴特沃斯滤波器

应该指出，在上面的举例中，也可用双线性变换法设计巴特渥斯数字滤波器。这时除在将数字域指标转换为模拟域指标时应按 (5.6.5) 式进行及最后应将所求得的${H_a}\left( s \right)$按$s = \left( {s/T} \right)\left( {1 - {z^{ - 1}}} \right)/\left( {1 + {z^{ - 1}}} \right)$的双线性转换关系变换至数字滤波器的系统函数$H\left( z \right)$外，其余设计步骤和脉冲响应不变变换法是一样的。

针对5.5.5案例指标，用双线性变换法设计数字巴特沃斯滤波器，例程如下：

**例程****5.6.2**

T = 1;

fs = 1;

Wp = 0.2*pi; % 数字频率

Ws = 0.3*pi; % 数字频率

Ap = 1; %dB

As = 15; %dB

wp = Wp/T; % 模拟角频率

ws = Ws/T; % 模拟角频率

fp = wp/(2*pi); %Hz 模拟频率

fst = ws/(2*pi); %Hz 模拟频率

% 预畸：

wp = 2/T*tan(Wp/2); % 预畸 模拟角频率

ws = 2/T*tan(Ws/2); % 预畸 模拟角频率

% 求N，wc：

[N,wc] = buttord_z(wp,ws,Ap,As,'s'); 

%设计模拟原型滤波器。

[Bs,As] = butter(N,wc,'s'); 

% 采用双线性变换法设计：

[Dz,Cz] = bilinear(Bs,As,fs);

Hz = filt(Dz,Cz);

% 画幅频、相频图：

figure;

W = linspace(0,pi); 

H = freqz(Dz,Cz,W);

mag = abs(H)/abs(H(1));

dbmag = 20*log10(mag);

phase = angle(H); %输出scale:-pi~pi

degphase = phase*180/pi; %转为degree

subplot(3,1,1), plot(W,abs(H));

subplot(3,1,2), plot(W,dbmag);

subplot(3,1,3), plot(W,degphase);

<img src=".\fig\5.6.6.png">

## 5.7 无限长单位脉冲响应数字滤波器的频率变换

实际中使用的数字滤波器除低通型外，还有高通型、带通型、带阻型等，其理想的频率特性如图5.7.1所示。设计高通、带通、带阻等数字滤波器，可有如下办法：

方法1：把一个归一化原型模拟低通滤波器变换成另一个所需类型的模拟滤波器变换成另一个所需类型的模拟滤波器，然后再通过脉冲相应的不变变换法或双线性变换法转化为数字滤波器，如图5.7.1(a)所示。

方法2：可把方法1中两步合成一次做，即把由模拟低通原型，变换得到模拟低通、高通、带通、带阻等滤波器的公式，与用双线性变换所得到相应的数字滤波器的公式合并，就可得到直接从模拟低通滤波器通过一定的频率变换关系一步完成各种数字滤波器的设计，如图5.7.1(b)所示。但这时不能直接采用脉冲响应不变变换法来变换高通、带阻等滤波器，因为这时将出现频率混叠失真。一般脉冲响应不变变换法使用到直接频率变换时，要加保护滤波器或其它特殊考虑。以上两种方法本质上属于一种，我们将结合一起介绍。

方法3：先设计低通型的数字滤波器，然后用数字频率变换法将它转换成某种类型的数字滤波器，如图5.7.1(c)所示。

<img src=".\fig\5.7.1.png" style="zoom:50%;" />

<div align = "center">图5.7.1 数字滤波器的各种理想相应形式</div>

<div align = "center">(a)低通 (b)高通 (c)带通 (d)带阻</div>

<img src=".\fig\5.7.2.png" style="zoom:50%;" />

<div align = "center">图5.7.2 IIR数字滤波器频率变换方案</div>

<div align = "center">(a)由模拟原型变换为所需类型的模拟滤波器，再变为相应的数字滤波器</div>

<div align = "center">(b)直接由模拟原型变换为各种数字滤波器</div>

<div align = "center">(c)由模拟原型数字化后再通过数字频率变换得到各种数字滤波器</div>

##### **5.7.1** **由模拟低通设计数字带通滤波器** 

1.模拟低通到模拟带通的变换

低通到带通的变换是
$$
P = \bar{s} + \frac{\bar{\Omega} _{2}^{2}}{s} \tag{5.7.1}
$$
这里$$P$$是模拟低通拉普拉斯变量，$$p = \sigma_{p} + j \Omega _{p}$$（前面我们是用s来表示模拟低通滤波器的拉普拉斯变量的，即$$s = \sigma+ j \Omega$$）。$$\bar{s}$$是模拟带通拉普拉斯变量，$$\bar{s} = \bar{\sigma}+ j \bar{\Omega}$$。将$$\bar{s} = j \bar{\Omega}$$代入 (5.7.1) 式，则$$\bar{s}$$平面的虚轴映射为$$P$$平面的虚轴。令$$P=j \Omega _{p}$$，再消去$$j$$,即得两频率变量间的关系如下
$$
\Omega_{p} = \frac{\bar{\Omega}^{2} - \bar{\Omega} _{2}^{2}}{\bar{\Omega}} \tag{5.7.2}
$$
根据 (5.7.2) 式所绘出的$$\bar{\Omega}\ge0$$部分的图形如图5.7.3所示。低通频率$$\Omega_{p}=0$$(直流)映射为$$\bar{\Omega}=\bar{\Omega}_2$$；$$\Omega_{p}=+\Omega_{pc}$$,（$$\Omega_{pc}$$为低通模拟系统函数的截止角频率）映射为$$\bar{\Omega}=\bar{\Omega}_3$$和$$\bar{\Omega}_{p}=-\bar{\Omega}_{pc}$$（幅度响应一般认为是包括正频率和负频率在内的偶函数）映射为$$\bar{\Omega}=\bar{\Omega}_1$$，其中$$\bar{\Omega}_3$$为带通函数中的高端角频率，$$\bar{\Omega}_1$$为带通函数中的低端角频率。

变换的结果是：从直流到$$+\Omega_{pc}$$的低通原型幅度响应平移到$$\bar{\Omega}_2$$至$$\bar{\Omega}_3$$的范围之间。同样，从直流至$$-\Omega_{pc}$$的响应则平移到$$\bar{\Omega}_2$$与$$\bar{\Omega}_1$$之间。如果从$$\bar{\Omega}_1$$至$$\bar{\Omega}_3$$之间的平移是线性关系，则所得通带响应呈现算术对称,相对于$$\bar{\Omega}_2$$两侧的幅度响应彼此互成影象，但因为变换曲线不是线性的，实际上，从$$\bar{\Omega}_2$$到$$\bar{\Omega}_3$$的频率间隔大于从$$\bar{\Omega}_1$$到$$\bar{\Omega}_2$$​的频率间隔，故变换后的效果如图5.7.4 所示。

<img src=".\fig\5.7.3.png" style="zoom:50%;" />

<div align = "center">图5.7.3 模拟低通滤波器到模拟带通的稳态频率变换</div>

<img src="\fig\5.7.4.png" style="zoom:50%;" />

<div align = "center">图5.7.4 从低通到带通变换的效果</div>

依据$$+\Omega_{pc}$$和$$\bar{\Omega}_3$$、$$\bar{\Omega}_1$$的对应关系，从 (5.7.2) 式可得
$$
\Omega_{pc} = \frac{\Omega_3^{2} - \Omega_{2}^{2}}{\Omega_3} \tag{5.7.3}
$$

$$
-\Omega_{pc} = \frac{\Omega_3^{2} - \Omega_{2}^{2}}{\Omega_3} \tag{5.7.4}
$$

将 (5.7.3) 式和 (5.7.4) 式相加和相减.并简化即得下面两个重要关系
$$
\Omega _{2} = \sqrt{\Omega _{1}  \Omega _{3}}\tag{5.7.5}
$$

$$
B =   \Omega _{3} - \Omega _{1} = \Omega _{p c}\tag{5.7.6}
$$

(5.7.5) 式指出带通响应相对于中心频率呈几何对称, $$\bar{\Omega}_2$$为带通模拟滤波器的几何中心角频率。$$B$$定义为带通滤波器的带宽，(5.7.6) 式指出带通滤波器的带宽是$$\bar{\Omega}_1$$和$$\bar{\Omega}_3$$之间的频带，与相应的低通滤波器的带宽相等，而在频率$$\bar{\Omega}_1$$和$$\bar{\Omega}_3$$处的幅度响应相当于$$\Omega_{pc}$$​处的低通响应。

由模拟低通滤波器确定模拟带通滤波器系统函数$$H_{b p} \left(s\right)$$的步骤是：

1)定出低通系统函数$$H_{l p} \left(p\right)$$，截止频率$$\Omega_{pc}$$等于带通滤波器的带宽$$B =   \bar{\Omega }_{3} - \bar{\Omega} _{1}$$ 。

2)在所得的低通系统函数$$H_{l p} \left(p\right)$$中代入变换关系 (5.7.1) 式，即得带通滤波器的系统函数$$H_{b p} \left(s\right)$$。
$$
H_{b p} \left(s\right) =H_{lp}\left(p\right)|_{p = \frac{s^{2} + \Omega ​_{2}^{2}}{s}}
$$
2.数字带通滤波器设计

利用双线性变换将模拟带通滤波器转换为数字带通滤波器，则 (5.6.2) 式的双线性变换为
$$
\bar{s} = \frac{2}{T} \frac{1 - z^{- 1}}{1 + z^{- 1}}
$$
为直接由模拟低通滤波器变为数字带通滤波器，将上式代入 (5.7.1) 式以得到$$p$$$$与$$$$z$$之间的直接联系： 
$$
p = \frac{\bar{s}^{2} + \bar{\Omega}^{2}}{\bar{s}} = \frac{\left[\frac{2}{T} \left(\frac{1 - z^{- 1}}{1 + z^{- 1}}\right)\right]^{2} + \bar{\Omega} ​_{2}^{2}}{\frac{2}{T} \left(\frac{1 - z^{- 1}}{1 + z^{- 1}}\right)}
$$
经过运算后得到：
$$
p = \frac{\left(\frac{2}{T}\right)^{2} + \bar{\Omega}^{2}}{\frac{2}{T}} \times \frac{1-2\{ \frac{\left[\left(\frac{2}{T}\right)^{2} - \bar{\Omega} ​_{2}^{2}\right]}{\left[\left(\frac{2}{T}\right)^{2} + \bar{\Omega} ​_{2}^{2}\right]}\}z^{-1}+z^{-2}}{1-z^{-2}}\tag{5.7.7}
$$
为简化 (5.7.7) 式，先导出几个关系。根据双线性变换特性，频率$$\bar{\Omega}$$与$$\Omega$$（数字带通最后的拉普拉斯变量$$s = \sigma+ j \Omega$$的稳态角频率，而数字频率为$$\omega = \Omega T$$）间的关系为
$$
\bar{\Omega} = \frac{2}{T} t g \frac{\Omega T}{2}\tag{5.7.8}
$$
将 (5.7.8) 式代入 (5.7.5) ，(5.7.6) 式即得：
$$
t g^{2} \left(\frac{\Omega ​_{2} T}{2}\right) ​ ​ = t g \left(\frac{\Omega ​_{1} T}{2}\right) ​ ​ t g \left(\frac{\Omega ​_{3} T}{2}\right)\tag{5.7.9}
$$

$$
t g \left(\frac{\Omega ​_{3} T}{2}\right) ​ ​ - t g \left(\frac{\Omega ​_{1} T}{2}\right) ​ = ​ \frac{\Omega ​_{p c} T}{2}\tag{5.7.10}
$$

这里$$\Omega_1$$，$$\Omega_3$$是顺次对应于模拟低通滤波器中$$-\Omega_{pc}$$，$$+\Omega_{pc}$$和模拟带通滤波器中$$\Omega_1$$，$$\Omega_3$$的数字带通滤波器的低端及高端角频率。$$\Omega_2$$是对应于模拟带通滤波器的几何中心角频率$$\Omega_2$$的数字带通角频率。$$\Omega_2$$虽然经常不在频带的正中间，通常仍称为“中心频率”。

在 (5.7.7) 式中令$$D = \frac{\left(\frac{2}{T}\right)^{2} + \bar{\Omega} _{2}^{2}}{\frac{2}{T}}$$运用以上几个关系式和一些标准的三角恒等式可以得到
$$
D = \Omega ​_{p c} c t g \left(\frac{\Omega ​_{3} - \Omega ​_{1}}{2}\right) T\tag{5.7.11}
$$
令
$$
E = \frac{2 \left[\left(\frac{2}{T}\right)^{2} - \bar{\Omega} ​_{2}^{2}\right]}{\left(\frac{2}{T}\right)^{2} + \bar{\Omega} ​_{2}^{2}}
$$
同样，运用以上推导的关系式和有关的三角恒等式可以得到
$$
E = \frac{2 \mathit{cos} ⁡ \left[\frac{\left(\Omega ​_{3} + \Omega ​_{1}\right)}{2} T\right]}{\mathit{cos} ⁡ \left[\frac{\left(\Omega ​_{3} - \Omega ​_{1}\right)}{2} T\right]} = 2 \mathit{cos} ⁡ \Omega ​_{2} T\tag{5.7.12}
$$
这样 (5.7.7) 式可表示为下面的简洁形式
$$
P = D \left[\frac{1 - E z^{- 1} + z^{- 2}}{1 - z^{- 2}}\right]\tag{5.7.13}
$$
综上所述，设计数字带通滤波器时,需要给出中心频率和带宽或者是带边频率，利用(5.7.11) 式和 (5.7.12) 式来确定$$D$$和$$E$$两个常数，然后用 (5.7.13) 式的变换关系从模拟低通系统函数$$H_{L p} \left(p\right)$$—步求得数字带通系统函数$$H \left(z\right)$$。
$$
H\left(z\right) = H_{L p} \left(p\right)|_{P = D \left[\frac{1 - E z^{- 1} + z^{- 2}}{1 - z^{- 2}}\right]}\tag{5.7.14}
$$
(5.7.14) 式表明，数字带通滤波器的极点数是低通模拟滤波器的极点数的两倍。

可以用模拟低通滤波器的频率来表示数字带通滤波器的频率。令$$p = j \Omega_{p}$$和$$z = e^{j \Omega T}$$​代入 (5.7.13) 式中，经演算后即得
$$
\Omega ​_{p} = D \frac{\frac{E}{2} - \mathit{cos} ⁡ \Omega T}{\mathit{sin} ⁡ \Omega T}\tag{5.7.15}
$$
此式在设计中可用来确定低通原型滤波器的截止频率。

**例** 设计一采样频率为$$2kHz$$的数字带通滤波器.满足如下要求：通带范围为$$300Hz$$到$$400Hz$$，在$$300Hz$$和$$400Hz$$频率处衰减不大于$$3dB$$；在$$200Hz$$和$$500Hz$$频率处衰减不得小于$$18dB$$；采用巴特渥斯响应
$$
D = \Omega ​_{p c} c t g \left(\frac{\Omega ​_{3} - \Omega ​_{1}}{2}\right) T
$$

$$
= \Omega ​_{p c} c t g \left(\frac{2 \pi \left(400 - 300\right)}{2}\right) \frac{1}{2000}
$$

$$
= \Omega ​_{p c} \cdot 6.31375152
$$

设$$\Omega_{pc} = 1rad/s$$则$$D=6.31375152$$​
$$
E = \frac{2 \mathit{cos} ⁡ \left[\frac{\left(\Omega ​_{3} + \Omega ​_{1}\right)}{2} T\right]}{\mathit{cos} ⁡ \left[\frac{\left(\Omega ​_{3} - \Omega ​_{1}\right)}{2} T\right]} = \frac{2 \mathit{cos} ⁡ \left(0.35 \pi\right)}{\mathit{cos} ⁡ \left(0.05 \pi\right)} = 0.91929910
$$
现在定出满足所需指标的低通模拟滤波器的最低阶次。

设$$\Omega_{pc}$$为满足所设计的数字带通滤波器要求的低通模拟原型的阻带起始频率，则据 (5.7.15) 式可得
$$
- \Omega ​_{p c} = D \frac{\frac{E}{2} - \mathit{cos} ⁡ \left(2 \pi \times 200 \times \frac{1}{2000}\right)}{\mathit{sin} ⁡ \left(2 \pi \times 200 \times \frac{1}{2000}\right)} = - 3.752763825
$$
同理
$$
\Omega ​_{p c} = D \frac{\frac{E}{2} - \mathit{cos} ⁡ \left(2 \pi \times 500 \times \frac{1}{2000}\right)}{\mathit{sin} ⁡ \left(2 \pi \times 500 \times \frac{1}{2000}\right)} = 2.902113045
$$
取$$\Omega_{pc} = 2.902113045$$（这样截至特性更为陡峭），并且设计要求在$$\Omega_{pc}$$处的衰减不小于$$18dB$$。求得衰减不大于$$3dB$$处的$$\Omega_{p}$$为
$$
\Omega ​_{p} = D \frac{\frac{E}{2} - \mathit{cos} ⁡ \left(2 \pi \times 400 \times \frac{1}{2000}\right)}{\mathit{sin} ⁡ \left(2 \pi \times 400 \times \frac{1}{2000}\right)} = 1.000000014
$$
取巴特沃斯相应，故有
$$
- 10 \mathit{log}_{10} ⁡ \left[1 + \left(\frac{\Omega ​_{p s}}{\Omega ​_{p c}}\right)^{2 N}\right] \leq - 18
$$

$$
- 10 \mathit{log}_{10} ⁡ \left[1 + \left(\frac{\Omega ​_{p}}{\Omega ​_{p c}}\right)^{2 N}\right] \geq - 3
$$

考虑用等号来满足指标
$$
2 N \mathit{log}_{10} ⁡ \Omega ​_{p s} - 2 N \mathit{log}_{10} ⁡ \Omega ​_{p c} = \mathit{log}_{10} ⁡ \left(1 0^{1.8} - 1\right)
$$

$$
2 N \mathit{log}_{10} ⁡ \Omega ​_{p} - 2 N \mathit{log}_{10} ⁡ \Omega ​_{p c} = \mathit{log}_{10} ⁡ \left(1 0^{0.3} - 1\right)
$$

相减两式后得
$$
N = \frac{\mathit{log}_{10} ⁡ \left(\frac{1 0^{1.8} - 1}{1 0^{0.3} - 1}\right)}{2 \mathit{log} ⁡ \left(\frac{2.902113045}{1.000000014}\right)} = 1.939776483
$$
选$$N=2$$，即二阶巴特沃斯滤波器便可满足要求，其归一化的系统函数为
$$
H_{l p} \left(p\right) = \frac{1}{p^{2} + \sqrt{2} p + 1}
$$
将所求得的$$D$$，$$E$$值代入 (5.7.13) 式，并将 (5.7.13) 式的变换关系代入上面的$$H_{l p}\left(p\right) $$, 即得所需的四极点的数字带通滤波器的系统函数
$$
H \left(z\right) = \frac{0.020083 \left(\left(1 - z^{- 2}\right)\right)^{- 2}}{1 - 1.63682 z^{- 1} + 2.237607 z^{- 2} - 1.307115 z^{- 3} + 0.64135 z^{- 4}}
$$
注意：因为系统函数$$H_{l p}\left(p\right) $$解除归一化时$$p$$要用$$\frac{p}{\Omega _{p c}}$$代入，此中的$$\Omega_{pc}$$正好和$$D$$中$$\Omega_{pc}$$相消，所以这时如用$$\Omega_{pc}=1$$时的$$D$$代入，则只用归一化系统函数$$H_{l p}\left(p\right) $$进行设计即可。

##### **5.7.2** 由模拟低通设计数字带阻滤波器

1.模拟低通到模拟带阻的变换

低通到带阻的变换关系为
$$
p = \frac{\bar{\Omega} ​_{2}^{2} \bar{s} ​}{\bar{s}^{2} + \bar{\Omega} ​^{2}}\tag{5.7.16}
$$
式中$$p$$仍为低通原型拉普拉斯变量，$$\bar{s}$$代表带阻函数的拉普拉斯变量。令$$\bar{s} = j \bar{\Omega}$$和$$p = j \Omega_p$$​代入到 (5.7.16) 式中，即得两频率变量之间的关系如下
$$
\Omega ​_{p} = \frac{\bar{\Omega} ​_{2}^{2} \bar{\Omega} ​}{\Omega ​_{2} - \bar{\Omega} ​^{2}}\tag{5.7.17}
$$
图5.7.5表示了 (5.7.17) 式的正频率部分的关系曲线，图中$$\bar{\Omega} _{1}$$，$$\bar{\Omega} _{2}$$和$$\bar{\Omega} _{3}$$表示与阻带有关的角频率由图可见：$$\Omega _{p} = 0$$映射到$$\bar{\Omega}=0$$和$$\bar{\Omega}=\infty$$；$$\bar{\Omega} _{p} = \pm \infty$$映射为$$\bar{\Omega} = \bar{\Omega} _{2}$$，$$\Omega _{p} = +   \Omega _{p c}$$映射为$$\bar{\Omega} = \bar{\Omega} _{1}$$，$$\Omega _{p} = -   \Omega _{p c}$$映射为 $$\bar{\Omega} = \bar{\Omega} _{3}$$。

低通响应到带阻响应的变换如图5.7.6所示。由图可见，从直流到$$\Omega _{p c}$$的低通原型幅度响应变换为从$$\bar{\Omega} _{1}$$到$$\bar{\Omega} _{3}$$频带之外的新的幅度响应。大于$$\Omega _{p c}$$的频率（也即低通阻带）变成从$$\bar{\Omega} _{1}$$到$$\bar{\Omega} _{3}$$的频带内的新响应。

从 (5.7.17) 式可得
$$
\Omega ​_{p c} = \frac{\bar{\Omega} ​_{2}^{2} \bar{\Omega} ​_{1} ​}{\bar{\Omega} ​_{2}^{2} - \bar{\Omega} ​_{1}^{2}}\tag{5.7.18}
$$

$$
- \Omega ​_{p c} = \frac{\bar{\Omega} ​_{2}^{2} \bar{\Omega} ​_{3} ​}{\bar{\Omega} ​_{2}^{2} - \bar{\Omega} ​_{3}^{2}}\tag{5.7.19}
$$

将 (5.7.18) 式与 (5.7.19) 式相加及相减并化简后可得
$$
\bar{\Omega} ​_{2} = \sqrt{\bar{\Omega} ​_{1} ​ \bar{\Omega} ​_{3}}\tag{5.7.20}
$$
<img src=".\fig\5.7.5.png" style="zoom:50%;" />

<div align = "center">图5.7.5 从低通到带阻的频率变换关系</div>

<img src=".\fig\5.7.6.png" style="zoom:50%;" />

<div align = "center">图5.7.6 从低通到带阻的变换关系</div>

$$
B = \bar{\Omega} ​_{3} - \bar{\Omega} ​_{1} = \frac{\bar{\Omega} ​_{2}^{2}}{\Omega ​_{p c}} = \frac{\bar{\Omega} ​_{1} ​ \bar{\Omega} ​_{3}}{\Omega ​_{p c}}\tag{5.7.21}
$$

(5.7.20) 式指出阻带响应相对于中心频率呈几何对称；(5.7.21) 式指出阻带带宽$$B$$与低通原型中的参考带宽$$\Omega _{p c}$$​成反比。

由模拟低通滤波器确定模拟带阻滤波器的系统函数$$H_{b r} \left(\bar{s}\right)$$​的步骤为：

1)确定低通系统函数$$H_{l p}\left(p\right) $$。根据 (5.7.21) 式可知，低通参考带宽$$\Omega _{p c}$$与阻带带宽$$B$$成反比。

2)在所确定的低通系统函数$$H_{l p}\left(p\right) $$中，代入 (5.7.16) 式的转换关系，可得带阻系统函数$$H_{b r} \left(\bar{s}\right)$$为
$$
H_{b r} \left(\bar{s}\right) = H_{l p} \left(p\right)|_{p = \frac{\bar{\Omega} ​_{2}^{2} \bar{s} ​}{\bar{s}^{2} + \bar{\Omega} ​^{2}}}\tag{5.7.22}
$$
2.数字带阻滤波器设计

利用模拟低通到带阻的变换式 (5.7.16) 以及双线性变换，可得
$$
p = \frac{\bar{\Omega} ​_{2}^{2} \bar{s}}{\bar{s}^{2} + \bar{\Omega} ​_{2}^{2}} = \frac{\bar{\Omega} ​_{2}^{2} \left[\frac{2}{T} \left(\frac{1 - z^{- 1}}{1 + z^{- 1}}\right)\right]}{\frac{\left(\frac{2}{T}\right)^{2} \left(1 - z^{- 1}\right)^{2}}{\left(1 + z^{- 1}\right)} + \bar{\Omega} ​_{2}^{2}}
$$
经整理后得
$$
p = \frac{\frac{2}{T} \bar{\Omega} ​_{2}^{2} \left(1 - z^{- 2}\right)}{\left[\left(\frac{2}{T}\right)^{2} + \bar{\Omega} ​_{2}^{2}\right] \left[1 - \frac{2 \left[\left(\frac{2}{T}\right)^{2} - \Omega ​_{2}^{2}\right]}{\left(\frac{2}{T}\right)^{2} + \Omega ​_{2}^{2}} z^{- 1} + z^{- 2}\right]}\tag{5.7.23}
$$
$$s$$代表与数字带阻函数相应的拉普拉斯变量，而$$\Omega_1$$，$$\Omega_2$$，$$\Omega_3$$代表与阻带有关的角频率。根据双线性变换特性，频率$$\bar\Omega$$与$$\Omega$$间的关系为
$$
\bar{\Omega} = \frac{2}{T} \mathit{tg} ⁡ \frac{\Omega T}{2}
$$
将上式代入 (5.7.20)，(5.7.21) 式可得
$$
⁡ \mathit t g ^{2} \frac{\Omega ​_{2} T}{2} = \mathit{tg} ⁡ \frac{\Omega ​_{1} T}{2} \mathit{tg} ⁡ \frac{\Omega ​_{3} T}{2}\tag{5.7.24}
$$
及
$$
t g  \frac{\Omega ​_{3} T}{2} - \mathit{tg} ⁡ \frac{\Omega ​_{1} T}{2} = \frac{2}{T}\frac{\mathit t g ^{2} \frac{\Omega ​_{2} T}{2}} {\Omega _{p c}} =\frac{2}{T}\frac{\mathit{tg} ⁡ \frac{\Omega ​_{1} T}{2} \mathit{tg} ⁡ \frac{\Omega ​_{3} T}{2}\tag{5.7.25}} {\Omega _{p c}}
$$
在 (5.7.23) 式中令
$$
D_{1} = \left(\frac{2}{T}\right) \bar{\Omega} ​_{2}^{2} ​ / ​ \left[\left(\frac{2}{T}\right)^{2} + \bar{\Omega} ​_{2}^{2}\right]
$$
运用以上关系式和有关的三角恒等式，可以得到
$$
D_{1} = \Omega ​_{p c} \mathit{tg} ⁡ \left(\frac{\Omega ​_{3} - \Omega ​_{1}}{2}\right) T\tag{5.7.26}
$$
令$$E_{1} = 2 \frac{\left(\frac{2}{T}\right)^{2} - \bar{\Omega} _{2}^{2}}{\left(\frac{2}{T}\right)^{2} + \bar{\Omega} _{2}^{2}}$$，和在带通滤波器中一样可得
$$
E_{1} = \frac{2 \mathit{cos} ⁡ \left[\frac{\left(\Omega ​_{3} + \Omega ​_{1}\right) T}{2}\right]}{\mathit{cos} ⁡ \left[\frac{\left(\Omega ​_{3} - \Omega ​_{1}\right) T}{2}\right]} = 2 \mathit{cos} ⁡ \Omega ​_{2} T\tag{5.7.27}
$$
这样，(5.7.23) 式可表示为
$$
p = \frac{D_{1} \left(1 - z^{- 2}\right)}{1 - E_{1} z^{- 1} + z^{- 2}}\tag{5.7.28}
$$
因此，从模拟低通系统函数$$H_{l p} \left(p\right)$$求得数字带阻系统函数$$H \left(z\right)$$​的关系为
$$
H \left(z\right) =H_{l p} \left(p\right)|_{p = \frac{D_{1} \left(1 - z^{- 2}\right)}{1 - E_{1} z^{- 1} + z^{- 2}}}\tag{5.7.29}
$$
可见，数字带阻模拟滤波器的极点数（或阶数）将等于模拟低通滤波器极点数的两倍。

在 (5.7.28) 式中，令$$p = j \Omega_{p}$$和$$z = e^{j \Omega T}$$，经演算后，可以建立数字带阻模拟滤波器的频率变量与模拟低通原型的频率变量之间的关系如下：
$$
\Omega_{p} = D_{1} \frac{\mathit{sin} ⁡ \Omega T}{\mathit{cos} ⁡ \Omega T - \frac{E_{1}}{2}} = D_{1} \frac{\mathit{sin} ⁡ \Omega T}{\mathit{cos} ⁡ \Omega T - \mathit{cos} ⁡ \Omega ​_{2} T}\tag{5.7.30}
$$
**例** 采样频率$$f_{s}$$为$$100kHz$$，要求设计一个二阶巴特渥斯带阻数字滤波器，其$$3dB$$带边频率分别为$$12.5kHz$$，$$22.5kHz$$。

由于要求设计的是二阶数字带阻滤波器，所以模拟原型系统函数为
$$
H_{l_{P}} \left(\right. p \left.\right) = \frac{1}{1 + p}
$$
模拟低通原型$$3dB$$频率为$$\Omega_{p c} = 1 \text{rad} / s$$，这样和带通滤波器的设计一样，所定模拟低通滤波器只用归一化系统函数$$H_{l p} \left(p\right)$$进行设计即可。因此带阻变换中所需各常数为 
$$
D_{1} = \mathit{tg} ⁡ \left(\frac{\Omega ​_{3} - \Omega ​_{1}}{2}\right) T = \mathit{tg} ⁡ \left[\frac{2 \pi \left(\right. 22.5 - 12.5 \left.\right)}{2} \times \frac{1}{100}\right] = 0.3249
$$

$$
E_{1} = \frac{2 \mathit{cos} ⁡ \left[\frac{\left(\Omega ​_{3} + \Omega ​_{1}\right) T}{2}\right]}{\mathit{cos} ⁡ \left[\frac{\left(\Omega ​_{3} - \Omega ​_{1}\right) T}{2}\right]} = \frac{2 \mathit{cos} ⁡ \left[\frac{2 \pi \left(\right. 22.5 + 12.5 \left.\right)}{2} \times \frac{1}{100}\right]}{\mathit{cos} ⁡ \left[\frac{2 \pi \left(\right. 22.5 - 12.5 \left.\right)}{2} \times \frac{1}{100}\right]} =\text{0}.\text{9547}
$$

将$$D_{1}$$，$$E_{1} $$值代入(5.3.79)式，并对$$H_{l p} \left(p\right)$$​式进行变换，即得所求系统函数
$$
H \left(z\right) = \frac{0.75477 \left(1 - 0.9547 z^{- 1} + z^{- 2}\right)}{1 - 0.7205 z^{- 1} + 0.5095 z^{- 2}}
$$

##### **5.7.3** 由模拟低通滤波器设计数字高通滤波器

1.模拟低通到模拟高通的变换 

变换关系为
$$
p = \frac{\Omega ​_{p c} ​ {\bar\Omega} ​_{c}}{s}\tag{5.7.31}
$$
其中：$$p$$为低通原型拉普拉斯变量，$$\Omega_p$$为与$$p$$相应的角频率（$$p = j \Omega _{p}$$），$$\bar{s}$$为变换后高通拉普拉斯变量，$$\bar{\Omega}$$为与$$\bar{s}$$相对应的角频率, $$\bar{\Omega}_c$$为与原型中 $$\Omega_{pc}$$相对应的高通函数中的一个角频率。

在 (5.7.31) 式中，令$$\bar{s} = j \bar{\Omega}$$，$$p = j \Omega _{p}$$​，即得两模拟滤波器频率间的关系为
$$
\frac{\Omega ​_{p}}{\Omega ​_{p c}} = - \frac{\bar{\Omega} ​_{c}}{\Omega}\tag{5.7.32}
$$
其曲线如图5.7.7所示。按照这种变换关系，将使从直流到参考频率 $$\Omega_{pc}$$的低通原型幅度响应, 以相反的关系平移到从$$\bar{\Omega}_c$$到$$\infty$$的高通频带。若选$$\bar{\Omega} _{c} = \Omega _{p c}$$，则低通的通带宽度就等于高通的阻带带宽。从低通到高通的变换结果如图5.7.8所示。

由模拟低通滤波器系统函数确定模拟高通滤波器系统函数的变换步骤为：

1)确定低通系统函数$$H_{l p} \left(p\right)$$。低通的参考角频率$$\Omega_{pc}$$由高通参考角频率$$\bar{\Omega}_c$$​选定；

2)在所得的低通系统函数$$H_{l p} \left(p\right)$$中代入变换关系 (5.7.31) 式，得到高通系统函数$$H_{h p} \left(\bar{s}\right)$$​
$$
H ​_{h p} \left(\bar{s}\right) = H ​_{l p} \left(p\right)|_{p = \frac{\Omega ​_{p c} ​ \bar{\Omega} ​_{c}}{\bar{s}}}\tag{5.7.33}
$$
2.高通数字滤波器设计

利用从模拟低通到高通变换的 (5.7.31) 式及双线性变换可得
$$
p = \frac{\Omega_{p c} \bar{\Omega}_{c}}{\bar{s}} = \frac{\Omega_{p c}  \bar{\Omega}_{c}}{\frac{2}{T} \left(\frac{1 - z^{- 1}}{1 + z^{- 1}}\right)} = \Omega _{p c} \bar{\Omega}_{c} \frac{T}{2} \frac{1 + z^{- 1}}{1 - z^{- 1}} = c_{1} \frac{1 + z^{- 1}}{1 - z^{- 1}}\tag{5.7.34}
$$
<img src=".\fig\5.7.7.png" style="zoom:50%;" />

<div align = "center">图 5.7.7 从模拟低通到模拟高通的频率关系</div>

<img src=".\fig\5.7.8.png" style="zoom:50%;" />

<div align = "center">图5.7.8 从低通到高通的变换结果</div>

因此可求得数字高通系统函数为
$$
H \left(z\right) = H_{l p} \left(p\right)|_{p = c_{1} \frac{1 + z^{- 1}}{1 - z^{- 1}}}\tag{5.7.35}
$$
可见，数字高通滤波器和模拟低通滤波器具有相同的极点数。

根据双线性变换特性，模拟频率与数字频率变量间关系为
$$
\bar{\Omega} = \frac{2}{T} \mathit{tg} ⁡ \frac{\Omega T}{2}
$$
则
$$
c_{1} = \Omega ​_{p c} ​ \mathit{tg} ⁡ \frac{\Omega ​_{c} T}{2}\tag{5.7.36}
$$
在$$\Omega_{pc}$$点的低通幅度响应和在$$\Omega_{c}$$点的高通幅度响应相同。在低通时$$\Omega_{pc}$$在通带上端，但在髙通时$$\Omega_{c}$$位于通带下端。令$$p = j \Omega _{p}$$和$$z = e^{j \Omega T}$$​代入 (5.7.34) 式，可以建立数字高通与模拟低通原型的频率变量间的关系
$$
\Omega_{p} = - c_{1} \mathit{ctg} ⁡ \frac{\Omega T}{2} 或\left|\Omega ​_{p}\right| = c_{1} \mathit{ctg} ⁡ \frac{\Omega T}{2}\tag{5.7.37}
$$
**例** 要求设计一二阶巴特渥斯数字高通滤波器，采样频率$$f_{s}=10kHz$$，$$3dB$$截止频率为$$2kHz$$​。

二阶巴特沃斯低通模拟原型函数为
$$
H_{l p} \left(p\right) = \frac{1}{1 + 1.414213 p + p^{2}}\tag{5.7.38}
$$
模拟频率$$\Omega_{p c} = 1   \text{rad} / s$$必须映射$$\Omega _{c} = 2 \pi \times 2000$$因此常数$$c_{1}$$​为
$$
c_{1} = \Omega ​_{p c} \mathit{tg} ⁡ \frac{\Omega ​_{c} T}{2} = \mathit{tg} ⁡ \frac{2 \pi \times 2000 \times \frac{1}{10000}}{2} = 0.72654
$$
变换关系为
$$
p = 0.72654 \frac{1 + z^{- 1}}{1 - z^{- 1}}
$$
根据 (5.7.35) 式经计算可得数字高通滤波器的系统函数
$$
H \left(z\right) = \frac{0.39134 \left(1 - 2 z^{- 1} + z^{- 2}\right)}{1 - 0.36954 z^{- 1} + 0.19582 z^{- 2}}\tag{5.7.39}
$$
表5.7.1 给出了各种变换式及必要的设计公式。这些变换式都是代数式，故适用于变换任何形式的连续滤波器系统函数。

<div align = "center">根据模拟低通原型设计各类数字滤波器的频率变换式 表5.7.1</div>

| 滤波器类型 |                          频率变换式                          |                        有关的设计公式                        |
| :--------: | :----------------------------------------------------------: | :----------------------------------------------------------: |
|    高通    | $$\left|\Omega _{p}\right|= c_{1}  \text{ctg} \frac{\Omega T}{2}$$ | $$c_{1} = \Omega _{p c} \mathit{tg} ⁡ \frac{\Omega _{c} T}{2}$$ |
|    带通    | $$p = D \left[\frac{1 - E z^{- 1} + z^{- 2}}{1 - z^{- 2}}\right]   $$  $$\Omega_{p} = D \frac{\frac{E}{2} - \mathit{cos} ⁡ \Omega T}{\mathit{sin} ⁡ \Omega T}$$ | $$D = \Omega _{p c} \mathit{ctg} ⁡ \left[\frac{\left(\Omega _{3} - \Omega _{1}\right)}{2}\right] T$$   $$E = \frac{2 \mathit{cos} ⁡ \left[\frac{\left(\Omega _{3} + \Omega _{1}\right)}{2}\right] T}{\mathit{cos} ⁡ \left[\frac{\left(\Omega _{3} - \Omega _{1}\right)}{2}\right] T} = 2 \mathit{cos} ⁡ \Omega _{2} T$$ |
|    带阻    | $p = \frac{D_{1} \left(1 - z^{- 1}\right)}{1 - E_{1} z^{- 1} + z^{- 2}}$   $\Omega _{p} = D_{1} \frac{\mathit{sin} ⁡ \Omega T}{\mathit{cos} ⁡ \Omega T - \frac{E_{1}}{2}}$ | $D_{1} = \Omega _{p c} \mathit{tg} ⁡ \left[\frac{\left(\Omega _{3} - \Omega _{1}\right)}{2}\right] T$   $E_{1} = \frac{2 \mathit{cos} ⁡ \left[\left(\Omega _{3} + \Omega _{1}\right) \frac{T}{2}\right]}{\mathit{cos} ⁡ \left[\left(\Omega _{3} - \Omega _{1}\right) \frac{T}{2}\right]} = 2 \mathit{cos} ⁡ \Omega _{2} T$ |

##### **5.7.4** 直接由给定的数字低通滤波器转换成其它类型的数字滤波器

设给定的数字低通滤波器的复变量$z$，为其系统函数$H_{l} \left(z\right)$，所要求的数字滤波器的复变量为$\mathcal{Z}$，系统函数为$H_{d} \left(\mathcal{Z}\right)$。我们定义从$z$平面到$\mathcal{Z}$平面的映射公式为
$$
z^{- 1} = G \left(\mathcal{Z}^{- 1}\right)\tag{5.7.40}
$$
使得
$$
H_{d} \left(\mathcal{Z}\right) = H_{l}\left(z\right)|_{z^{- 1} = G \textrm{ } \left(\mathcal{Z}^{- 1}\right)}\tag{5.7.41}
$$
为使一个稳定的、因果的、有理的数字低通滤波器的系统函数 ，变换到所需类型的数字滤波器的系统函数$H_{d} \left(\mathcal{Z}\right)$时，同样也是稳定的，因果的，有理的，则必须满足：

1)$ G \left(\mathcal{Z}^{- 1}\right)$必须是$\mathcal{Z}^{- 1}$(或$\mathcal{Z}$)的有理函数。

2)$z$平面的单位圆内部，必须映射为$\mathcal{Z}$​平面的单位圆内部。

假设$\theta$和$\omega$分别是$z$平面和$\mathcal{Z}$平面的数字频率变量，可以把$z$和$\mathcal{Z}$表示成$z = e^{j \theta}$，$\mathcal{Z} = e^{j \omega}$。

则据 (5.7.40) 式可得
$$
e^{- j \theta} = \left|G \left(e^{- j \omega}\right)\right| e^{j \mathit{arg} ⁡ \left[G \left(e^{- j \omega}\right)\right]}
$$
这就要求
$$
\left|G \left(e^{- j \omega}\right)\right| = 1
$$

$$
\theta = - \mathit{arg} ⁡ \left[G \left(e^{- j \omega}\right)\right]
$$

可以证明，满足上述要求的函数$G \left(\mathcal{Z}^{- 1}\right)$​的一般形式为
$$
z^{- 1} = G \left(\mathcal{Z}^{- 1}\right) = \pm \prod_{k = 1}^{N} \frac{\mathcal{Z}^{- 1} - a_{k}}{1 - a_{k} \mathcal{Z}^{- 1}}\tag{5.7.42}
$$
为使系统稳定，必须使$\left|a_{k}\right| < 1$。选择合适的$N$和$a_{k}$​，可以得到一系列的变换。最简单的是由低通滤波器到另一个低通滤波器的变换。此时有
$$
z^{- 1} = G\left(\mathcal{Z}^{- 1}\right) = \frac{\mathcal{Z}^{- 1} - a}{1 - a \mathcal{Z}^{- 1}}\tag{5.7.43}
$$
如果我们代入$z = e^{j \theta}$，$\mathcal{Z} = e^{j \omega}$则得
$$
e^{- j \theta} = \frac{e^{- j \omega} - a}{1 - a e^{- j \omega}}\tag{5.7.44}
$$
由此得
$$
e^{j \omega} = \frac{1 + a e^{- j \theta}}{a + e^{- j \theta}}
$$
展开后可求得
$$
\omega = \mathit{arctg} ⁡ \left[\frac{\left(1 - a^{2}\right) \mathit{sin} ⁡ \theta}{2 a + \left(1 + a^{2}\right) \mathit{cos} ⁡ \theta}\right]\tag{5.7.45}
$$
$\theta$与$\omega$的关系如图5.7.9所示。尽管除$a=0$的情况外，频率变换关系的非线性很严重，但是如果原来系统的频率响应是分段常数型的，具有截频$\theta_c$的低通响应，变换后同样会得到类似的低通响应。其截止频率$\omega_c$由选定的$a$决定。

<img src=".\fig\5.7.9.png" style="zoom:50%;" />

<div align = "center">图5.7.9 低通数字-低通数字变换的频率刻度畸度</div>

由 (5.7.44) 式可以解得$a$
$$
a= \frac{\mathit{sin} ⁡ \left(\frac{\theta_{c} - \omega_{c}}{2}\right)}{\mathit{sin} ⁡ \left(\frac{\theta_{c} + \omega_{c}}{2}\right)}\tag{5.7.46}
$$
应用 (5.7.43) 式和 (5.7.46) 式，就可以根据已有的数字低通滤波器$H_{l} \left(\right. z \left.\right)$（截止频率为$\theta_c$）变换得到新的数字低通滤波器$H_{d} \left(\mathcal{Z}\right)$（截止频率为$\omega_c$），即
$$
H_{d} \left(\mathcal{Z}\right) = H_{l} \left(z\right) |z^{- 1} = \frac{\mathcal{Z}^{- 1} - a}{1 - a \mathcal{Z}^{- 1}}\tag{5.7.47}
$$
可用类似的方法导出数字低通滤波器与数字高通, 数字带通以及数字带阻滤波器之间的变换关系，如表5.7.2所示。

<div align = "center">由截止频率为0的低通数字滤波器原型变换成各型数字滤波器的公式 表5.7.2</div>

| 数字滤波器类型 |                             变换                             |                         有关设计公式                         |
| :------------: | :----------------------------------------------------------: | :----------------------------------------------------------: |
|     低 通      | $z^{- 1} = \frac{\mathcal{Z}^{- 1} - a}{1 - a \mathcal{Z}^{- 1}}$ | $a = \frac{\mathit{sin} ⁡ \left(\frac{\theta_{c} - \omega_{c}}{2}\right)}{\mathit{sin} ⁡ \left(\frac{\theta_{c} + \omega_{c}}{2}\right)}$   $\omega_c$为要求的截止频率 |
|     高 通      | $z^{- 1} = - \frac{\mathcal{Z}^{- 1} + a}{1 + a \mathcal{Z}^{- 1}}$ | $a = - \frac{\mathit{cos} ⁡ \left(\frac{\theta_{c} + \omega_{c}}{2}\right)}{\mathit{cos} ⁡ \left(\frac{\theta_{e} - \omega_{c}}{2}\right)}$    $\omega_c$为要求的截止频率 |
|     带 通      | $z^{- 1} = - \frac{\mathcal{Z}^{- 2} - \frac{2 a k}{k + 1} \mathcal{Z}^{- 1} + \frac{k - 1}{k + 1}}{\frac{k - 1}{k + 1} \mathcal{Z}^{- 2} - \frac{2 a k}{k + 1} \mathcal{Z}^{- 1} + 1}$ | $a = \frac{\mathit{cos} ⁡ \left(\frac{\omega_{2} + \omega{1}}{2}\right)}{\mathit{cos} ⁡ \left(\frac{\omega_{2} - \omega_{1}}{2}\right)}$   $k = \mathit{ctg} ⁡ \left(\frac{\omega_{2} - \omega_{1}}{2}\right) \mathit{tg} ⁡ \frac{\theta_{c}}{2}$   $\omega_2$，$\omega_1$为要求的上下截止频率 |
|     带 阻      | $z^{- 1} = \frac{\mathcal{Z}^{- 2} - \frac{2 a}{1 + k} \mathcal{Z}^{- 1} + \frac{1 - k}{1 + k}}{\frac{1 - k}{1 + k} \mathcal{Z}^{- 2} - \frac{2 a}{1 + k} \mathcal{Z}^{- 1} + 1}$ | $a = \frac{\mathit{cos} ⁡ \left(\frac{\omega_{2} + \omega{1}}{2}\right)}{\mathit{cos} ⁡ \left(\frac{\omega_{2} - \omega_{1}}{2}\right)}$     $k = \mathit{tg} ⁡ \left(\frac{\omega_{2} - \omega_{1}}{2}\right) \mathit{tg} ⁡ \frac{\theta_{c}}{2}$   $\omega_2$，$\omega_1$为要求的上下截止频率 |

## 5.8 有限长单位脉冲响应数字滤波器设计

### 5.8.1 概述

IIR数字滤波器虽有许多优异特性，但也有一些缺点，例如，对IIR滤波器必须注意稳定性问题。再者，若想利用快速傅里叶变换技术进行快速卷积实现滤波器，则必须要求单位脉冲响应是有限列长的。此外，前面的设计举例也清楚地说明了，IIR滤波器的优异幅度响应，一般是以相位的非线性为代价的，非线性相位会引起频率色散。

FIR数字滤波器具有严格的线性相位特性，这对于语音信号处理和数据传输是很重要的。在FFT出现之前，一般曾认为FIR滤波器在计算上是不可行的，现在FIR滤波器已经得到了越来越多的应用。

前节所讨论的各种变换法对FIR滤波器不适用，因为它们给出的是IIR函数。因此必须探讨有限长单位脉冲响应滤波器的设计方法。FIR滤波器的单位脉冲响应$h(n)$仅含有有限个（$N$个）非零值，是因果的有限长序列。该序列$h(n)$的变换为$Z$

|      | $H(z) = \sum\limits_{n = 0}^{n - 1} {h(n){z^{ - n}}} $ |      |
| ---- | ------------------------------------------------------ | ---- |
|      |                                                        |      |

$H(z)$是${z^{ - 1}}$的$N-1$阶多项式。因此，$H(z)$有$N-1$个零点可位于有限Z平面的任何位置，它还有$N-1$个位于$z=0$处的极点。频率响应$H({e^{j\omega }})$是一个三角多项式

$H({e^{j\omega }}) = \sum\limits_{n = 0}^{N - 1} {h(n){e^{ - j\omega n}}} $

因此FIR滤波器的设计问题，实际上就是求频率响应$H({e^{j\omega }})$的$N$个点处的采样值$H(k)$（因为任一有限长序列完全由它的傅氏变换的$N$个采样值确定）或$N$个$h(n)$。

目前关于FIR滤波器的设计方法主要有两类：第一类是基于逼近理想滤波器特性的方法，包括窗函数法，频率采样法和等波纹最佳逼近法。 第二类是最优设计法，我们主要讨论第一类设计法。 下面介绍线性相位滤波器的特性，以便根据实际需要选择合适的FIR滤波器类型，并在 设计时遵循相应的约束条件。

### **5.8.2** 线性相位FIR数字滤波器的特点

#### 频率响应特点

F1R滤波器的频率响应为

|      | $H({e^{j\omega }}) = \sum\limits_{n = 0}^{N - 1} {h(n){e^{ - j\omega n}}} $ | (5.8.1) |
| ---- | ------------------------------------------------------------ | ------- |
|      |                                                              |         |

将$H({e^{j\omega }})$表示成极坐标的形式

$H({e^{j\omega }}) =  \pm \left| {H({e^{j\omega }})} \right|{e^{j\theta (\omega )}}$       (5.8.2)

若$h(n)$是实函数时，则其傅里叶变换的幅度是如的偶函数，而相位是$\omega $的奇函数，即

$\left| {H({e^{j\omega }})} \right| = \left| {H({e^{ - j\omega }})} \right|,0 \le \omega  \le \pi $   (5.8.3)

$\theta (\omega ) =  - \theta ( - \omega )$                           (5.8.4)

很多实际应用中的FIR数字滤波器要求有准确的线性相位，(5.3.3) 式已指出了线性相位条件要求滤波器的单位采样响应$h(n)$满足。

偶对称	  $h(n) = h(N - 1 - n)$

奇对称          $h(n) =  - h(N - 1 - n)$

对于$h(n)$为偶对称和奇对称又分别分为列长N为偶数和奇数两种情况。其单位脉冲采样序列$h(n)$如图5.8.1及图5.8.2所示。因此共有以下四种类型的线性相位FIR数字滤波器。下面分别讨论它们的频率响应。在讨论中将频响$H({e^{j\omega }})$用相位函数$\theta (\omega )$及幅度函数$H(\omega )$表示为

|      | $H({e^{j\omega }}) = H(\omega ){e^{j\theta (w)}}$ | (5.8.5) |
| ---- | ------------------------------------------------- | ------- |
|      |                                                   |         |

其中$H({e^{j\omega }})$是一个纯实数，即等于$ \pm \left| {H({e^{j\omega }})} \right|$。

#### **1.** 情况1

$h(n)$为偶对称，$N$为奇数

|      | $H({e^{j\omega }}) = (\sum\limits_{n = 0}^{\frac{{(N - 3)}}{2}} {h(n){e^{ - j\omega n}}) + h(\frac{{N - 1}}{2})} {e^{ - j\omega (\frac{{N - 1}}{2})}} + (\sum\limits_{n = \frac{{N + 1}}{2}}^{N - 1} {h(n){e^{ - j\omega n}})} $ | (5.8.6) |
| ---- | ------------------------------------------------------------ | ------- |
|      |                                                              |         |

在上式右端第三项中，进行变量代换，代入$m = N - 1 - n$，则

|      | $H({e^{j\omega }}) = (\sum\limits_{n = 0}^{\frac{{(N - 3)}}{2}} {h(n){e^{ - j\omega n}}) + h(\frac{{N - 1}}{2})} {e^{ - j\omega (\frac{{N - 1}}{2})}} + (\sum\limits_{m = 0}^{\frac{{(N - 3)}}{2}} {h(N - 1 - m){e^{ - j\omega (N - 1 - m)}})} $ | (5.8.7) |
| ---- | ------------------------------------------------------------ | ------- |
|      |                                                              |         |

 

​     <img src=".\fig\5.8.1.png" style="zoom:90%;"/>

图5.8.1 偶对称单位脉冲采样响应  

<img src=".\fig\5.8.2.png" style="zoom:90%;"/>

图5.8.2 偶对称单位脉冲采样响应

由于$h(n) = h(N - 1 - n)$，故可合并上式第一和第三总和，并提出${e^{ - j\omega \frac{{N - 1}}{2}}}$，这样 (5.8.7) 式可写成

|      | $\begin{array}{l}<br/>H({e^{j\omega }}) = {e^{ - j\omega \frac{{N - 1}}{2}}}\left[ {\sum\limits_{n = 0}^{\frac{{(N - 3)}}{2}} {h(n)\left\{ {{e^{j\omega (\frac{{N - 1}}{2} - n)}} + {e^{ - j\omega (\frac{{N - 1}}{2} - n)}}} \right\} + h(\frac{{N - 1}}{2})} } \right]\\<br/> = {e^{ - j\omega \frac{{N - 1}}{2}}}\left\{ {\sum\limits_{n = 0}^{\frac{{(N - 3)}}{2}} {2h(n)\cos \left[ {\omega \left( {\frac{{N - 1}}{2} - n} \right)} \right] + h(\frac{{N - 1}}{2})} } \right\}<br/>\end{array}$ | (5.8.8) |
| ---- | ------------------------------------------------------------ | ------- |
|      |                                                              |         |

令$m = \frac{{N - 1}}{2} - n￥，则上式变成

|      | $H({e^{j\omega }}) = {e^{ - j\omega \frac{{N - 1}}{2}}}\left\{ {\sum\limits_{m = 1}^{\frac{{N - 1}}{2}} {2h(\frac{{N - 1}}{2} - m)\cos \left[ {\omega m} \right] + h(\frac{{N - 1}}{2})} } \right\}$ | (5.8.9) |
| ---- | ------------------------------------------------------------ | ------- |
|      |                                                              |         |

最后，令$a(0) = h(\frac{{N - 1}}{2})$

|      | $a(n) = 2h(\frac{{N - 1}}{2} - n),n = 1,2, \cdots \frac{{N - 1}}{2}$ | (5.8.10) |
| ---- | ------------------------------------------------------------ | -------- |
|      |                                                              |          |

则 (5.8.9) 式可写成

|      | $H({e^{j\omega }}) = {e^{ - j\omega \frac{{N - 1}}{2}}}\left[ {\sum\limits_{m = 1}^{\frac{{N - 1}}{2}} {a(n)\cos (\omega n)} } \right]$ | (5.8.11) |
| ---- | ------------------------------------------------------------ | -------- |
|      |                                                              |          |

因此，对情况1可得

|      | $H(\omega ) = \sum\limits_{n = 0}^{N - 1} {a(n)\cos (\omega n)} $ | (5.8.12) |
| ---- | ------------------------------------------------------------ | -------- |
|      |                                                              |          |

由于$\cos n\omega $对皆为$\omega  = 0,\pi ,2\pi $偶对称，所以$H(\omega )$对这些频率呈偶对称特性。结论：$N$为奇数时，若时域$h(n)$为偶对称，则频域也是偶对称，频率响应特性如表5.8.1 中第一栏所示。

 

***\*例程5.8.1\****

实现上述情况1

```matlab
h = [-3 1 -1 -2 5 6 5 -2 -1 1 -3];

M = length(h);

n = 0:M-1;

[Hr,w,a,L] = hr_type1(h);

subplot(2,2,1); stem(n,h); 

xlabel('n'); ylabel('h(n)'); title('脉冲响应')

subplot(2,2,2); plot(w/pi,Hr); 

xlabel('频率单位pi'); ylabel('Hr'); title('I型幅度函数')

subplot(2,2,3); stem(0:L,a); 

xlabel('n'); ylabel('a(n)'); title('a(n)系数')

subplot(2,2,4); zplane(h,1); title('零极点图')

 

function [Hr,w,a,L] = hr_type1(h);

 M = length(h);

 L = (M-1)/2;

 a = [h(L+1) 2*h(L:-1:1)]; % 1x(L+1) row vector

 n = [0:1:L];        % (L+1)x1 column vector

 w = [0:1:1000]'*pi/500;

Hr = cos(w*n)*a';

end
```

<img src=".\fig\5.8.3.png" style="zoom:50%;"/> 

​								图5.8.3 情况1

 

#### 2.情况2

$h(n)$为偶对称，$N$为偶数

|      | $H({e^{j\omega }}) = \sum\limits_{n = 0}^{\frac{N}{2} - 1} {h(n){e^{ - j\omega n}}}  + \sum\limits_{n = \frac{N}{2}}^{N - 1} {h(n){e^{ - j\omega n}}} $ | (5.8.13) |
| ---- | ------------------------------------------------------------ | -------- |
|      |                                                              |          |

对此等式右端第二项和式进行变量代换，代入$m = N - 1 - n$，经过和情况1相同的变换，最后可得：

|      | $H({e^{j\omega }}) = {e^{ - j\omega \frac{{N - 1}}{2}}}\left\{ {\sum\limits_{n = 0}^{\frac{N}{2} - 1} {2h(n)\cos \left[ {\omega (\frac{N}{2} - n - \frac{1}{2})} \right]} } \right\}$ |      |
| ---- | ------------------------------------------------------------ | ---- |
|      |                                                              |      |

令$m = \frac{N}{2} - n$，$b(n) = 2h(\frac{N}{2} - n),n = 1,2, \cdots N/2$则

|      | $H({e^{j\omega }}) = {e^{ - j\omega \frac{{N - 1}}{2}}}\left\{ {\sum\limits_{n = 0}^{\frac{N}{2}} {b(n)\cos \left[ {\omega (n - \frac{1}{2})} \right]} } \right\}$ | (5.8.14) |
| ---- | ------------------------------------------------------------ | -------- |
|      |                                                              |          |

因此，对情况2可得

|      | $H(\omega ) = \sum\limits_{n = 0}^{\frac{N}{2}} {b(n)\cos \left[ {\omega (n - \frac{1}{2})} \right]} $ | (5.8.15) |
| ---- | ------------------------------------------------------------ | -------- |
|      |                                                              |          |

这种情况下的特点是：（1）由于$\cos \left[ {\omega (n - 1/2)} \right]$对$\omega  = \pi $呈奇对称，故$H(\omega )$对$\omega  = \pi $呈奇对称；(2)当$\omega  = \pi $时，$\cos \left[ {\omega (n - 1/2)} \right]=0$，故不论b(n)[即$h(n)$]是多少，一定有$H(\pi ) = 0$，即$H(z)$在Z=-1处有零点。因此如果一个滤波器，在$\omega  = \pi $时，其频率响应不等于零(例如高通滤波器)，则不能用此法来逼近。情况2的频率响应特性如表5.8.1中第二栏所示。

由情况1，2看出，对于偶对称的单位采样响应，其频率特性的相位响应为

$\theta (\omega ) =  - \omega \frac{{N - 1}}{2}$

具有严格的线性相位。滤波器有$\frac{{N - 1}}{2}$个采样周期的延时，即其延时等于单位采样响应$h(n)$列长的一半。$\theta (\omega )$的图形见表5.8.1。

 

***\*例程5.8.2\****

实现上述情况2

```matlab
h = [1 2 -1 3 4 4 3 -1 2 1];

M = length(h);

n = 0:M-1;

[Hr,w,b,L] = hr_type2(h);

subplot(2,2,1); stem(n,h); 

xlabel('n'); ylabel('h(n)'); title('脉冲响应')

subplot(2,2,2); plot(w/pi,Hr); 

xlabel('频率单位pi'); ylabel('Hr'); title('II型幅度函数')

subplot(2,2,3); stem(1:L,b); 

xlabel('n'); ylabel('b(n)'); title('b(n)系数')

subplot(2,2,4); zplane(h,1); title('零极点图')

 

function [Hr,w,b,L] = hr_type2(h);

 M = length(h);

 L = M/2;

 b = 2*[h(L:-1:1)];

 n = [1:1:L]; n = n-0.5;

 w = [0:1:1000]'*pi/500;

Hr = cos(w*n)*b';

end
```

<img src=".\fig\5.8.4.png" style="zoom:50%;"/> 

图5.8.4 情况2

 

#### **3.** 情况3

$h(n)$为奇对称，$N$为奇数。

因为$h(n)$为奇对称，则要求$h(\frac{{N - 1}}{2}) =  - h(N - 1 - \frac{{N - 1}}{2}) =  - h(\frac{{N - 1}}{2})$，所以$h(\frac{{N - 1}}{2}) = 0$ 

|      | $\begin{array}{l}<br/>H({e^{j\omega }}) = \sum\limits_{n = 0}^{\frac{{N - 1}}{2} - 1} {h(n){e^{ - jan}}}  + \sum\limits_{n = \frac{{N + 1}}{2}}^{N - 1} {h(n){e^{ - jan}}} \\<br/> = \sum\limits_{n = 0}^{\frac{{N - 1}}{2} - 1} {h(n){e^{ - jan}}}  + \sum\limits_{n = \frac{{N + 1}}{2}}^{N - 1} {h(N - 1 - n){e^{ - ja(N - 1 - n)}}} \\<br/> = \sum\limits_{n = 0}^{\frac{{N - 1}}{2} - 1} {h(n){e^{ - j\omega \frac{{N - 1}}{2}}}} \left[ {{e^{j\omega (\frac{{N - 1}}{2} - n)}} - {e^{ - j\omega (\frac{{N - 1}}{2} - n)}}} \right]\\<br/> = {e^{ - j\omega \frac{{N - 1}}{2}}}j\left\{ {\sum\limits_{n = 0}^{\frac{{N - 1}}{2} - 1} {2h(n)\sin \left[ {\omega (\frac{{N - 1}}{2} - n)} \right]} } \right\}\\<br/>{ = ^{ - j(\frac{\pi }{2} - \omega \frac{{N - 1}}{2})}}j\left\{ {\sum\limits_{n = 0}^{\frac{{N - 1}}{2} - 1} {2h(n)\sin \left[ {\omega (\frac{{N - 1}}{2} - n)} \right]} } \right\}<br/>\end{array}$ | (5.8.16) |
| ---- | ------------------------------------------------------------ | -------- |
|      |                                                              |          |

令$m = (N - 1)/2 - n$代入上式，则

|      | $H({e^{j\omega }}){ = ^{ - j(\frac{\pi }{2} - \omega \frac{{N - 1}}{2})}}j\left\{ {\sum\limits_{n = 0}^{\frac{{N - 1}}{2} - 1} {2h(n)\sin \left[ {\omega m} \right]} } \right\}$ | (5.8.17) |
| ---- | ------------------------------------------------------------ | -------- |
|      | $C(n) = 2h\left[ {\frac{{N - 1}}{2} - n} \right],n = 1,2, \cdots \frac{{N - 1}}{2}$ |          |

则 (5.8.17) 式可改为

|      | $H({e^{j\omega }}){ = ^{ - j\omega \frac{{N - 1}}{2}}}{e^{j\frac{\pi }{2}}}\left\{ {\sum\limits_{n = 0}^{\frac{{N - 1}}{2}} {C(n)\sin \left[ {\omega m} \right]} } \right\}$ |      |
| ---- | ------------------------------------------------------------ | ---- |
|      |                                                              |      |

因此，对情况3可得

|      | $H(\omega ) = \sum\limits_{n = 0}^{\frac{{N - 1}}{2}} {C(n)\sin (\omega m)} $ | (5.8.18) |
| ---- | ------------------------------------------------------------ | -------- |
|      |                                                              |          |

由此式看出：（1）当$\omega  = 0,\pi ,2\pi $时，不管C(n)[即$h(n)$]是多少，一定有$H(z)$在$z =  \pm 1$上都有零点；（2）由于$\sin n\omega $对$\omega  = 0,\pi ,2\pi $呈奇对称。故$H(\omega )$对这些频率也奇对称。情况3的频率响应如表5.8.1第三栏所示。

 

***\*例程5.8.3\****

实现上述情况3

```matlab
h = [-1 1 -2 2 -3 0 3 -2 2 -1 1];

M = length(h);

n = 0:M-1;

[Hr,w,c,L] = hr_type3(h);

subplot(2,2,1); stem(n,h); 

xlabel('n'); ylabel('h(n)'); title('脉冲响应')

subplot(2,2,2); plot(w/pi,Hr); 

xlabel('频率单位pi'); ylabel('Hr'); title('III型幅度函数')

subplot(2,2,3); stem(0:L,c); 

xlabel('n'); ylabel('c(n)'); title('c(n)系数')

subplot(2,2,4); zplane(h,1); title('零极点图')

 

function [Hr,w,c,L] = hr_type3(h);

 M = length(h);

 L = (M-1)/2;

 c = [2*h(L+1:-1:1)];

 n = [0:1:L];

 w = [0:1:1000]'*pi/500;

Hr = sin(w*n)*c';

end
```

<img src=".\fig\5.8.5.png" style="zoom:50%;"/> 

​						图5.8.5 情况3

 

#### **4.** 情况4

$h(n)$为奇对称，N为偶数

|      | $H({e^{j\omega }}) = \sum\limits_{n = 1}^{\frac{{N - 1}}{2}} {h(n){e^{ - jan}}}  + \sum\limits_{n = \frac{N}{2}}^{N - 1} {h(n){e^{ - jan}}} $ |      |
| ---- | ------------------------------------------------------------ | ---- |
|      |                                                              |      |

类似情况3的化简可得

|      | $H({e^{j\omega }}) = {e^{j(\frac{\pi }{2} - \frac{{N - 1}}{2}a)}}\left\{ {\sum\limits_{n = 0}^{\frac{N}{2} - 1} {2h(n)\sin \left[ {\omega (\frac{{N - 1}}{2} - n)} \right]} } \right\}$ | (5.8.19) |
| ---- | ------------------------------------------------------------ | -------- |
|      |                                                              |          |

令$m = N/2 - n$，代入上式，并令$d(n) = 2h\left[ {\frac{N}{2} - n} \right],n = 1,2, \cdots \frac{N}{2}$，则 (5.8.19) 式可写成

|      | $H({e^{j\omega }}){ = ^{ - j\omega \frac{{N - 1}}{2}}}{e^{j\frac{\pi }{2}}}\left\{ {\sum\limits_{n = 0}^{\frac{N}{2}} {d(n)\sin \left[ {\omega (n - \frac{1}{2})} \right]} } \right\}$ |      |
| ---- | ------------------------------------------------------------ | ---- |
|      |                                                              |      |

因此对情况4可得

|      | $H(\omega ) = \sum\limits_{n = 1}^{\frac{N}{2}} {d(n)\sin \left[ {\omega (n - \frac{1}{2})} \right]} $ | (5.8.20) |
| ---- | ------------------------------------------------------------ | -------- |
|      |                                                              |          |

对此情况：（1）由于${\sin \left[ {\omega (n - \frac{1}{2})} \right]}$在$\omega  = 0.2\pi $处为零，所以$H(\omega )$在$\omega  = 0.2\pi $处为零，即$H(z)$在z=1处有零点；（2）由于${\sin \left[ {\omega (n - \frac{1}{2})} \right]}$在$\omega  = 0.2\pi $处呈奇对称，故$H(\omega )$在$\omega  = 0.2\pi $处呈奇对称。情况4的频率响应特性见表5.8.1第四栏所示。

情况3，情况4线性相位FIR滤波器适合于逼近诸如微分器，希尔伯特变换器等。由情况3，4看出，对于奇对称的单位采样相应，其频谱特性的相位响应为

|      | $\theta (\omega ) =  - \omega (\frac{{N - 1}}{2}) + \frac{\pi }{2}$ |      |
| ---- | ------------------------------------------------------------ | ---- |
|      |                                                              |      |

也是线性的。滤波器仍有$(N - 1)/2$个采样周期的延时为$h(n)$列长的一半。对于相移而言，除具有$ - (N - 1)\omega /2$的线性相移外，尚有\[\frac{\pi }{2}\]的固定相移。其$\theta (\omega )$的图形见表5.8.1所示。

综上所述可知，FIR滤波器的单位脉冲响应只要满足对称条件，就一定具有线性相位频率特性。线性相位FIR滤波器四种情况的频率响应可以统一表示为

|      | $H({e^{j\omega }}) = H(\omega ){e^{j(\frac{L}{2}x - (N - 1)\omega /2)}}$ | (5.8.21) |
| ---- | ------------------------------------------------------------ | -------- |
|      |                                                              |          |

式中$H(\omega )$是频率响应的幅度特性，为实函数。L=0或1。L=0表示单位脉冲采样响应为偶对称；L=1表示单位脉冲采样响应为奇对称。

四种情况下的相位特性可表示为

|      | $\theta (\omega ) = \frac{L}{2}x - (N - 1)\omega /2$ |      |
| ---- | ---------------------------------------------------- | ---- |
|      |                                                      |      |

而群延时则为

|      | $\tau  =  - \frac{{d\theta (\omega )}}{{d\omega }} = \frac{{N - 1}}{2}$ |      |
| ---- | ------------------------------------------------------------ | ---- |
|      |                                                              |      |

线性相位FIR滤波器的缺点是群延时较大，当**N**等于奇数时，滤波器群延时是采样间隔的整数倍，当**N**等于偶数时，滤波器群延时是整数倍采样间隔再加上1/2采样间隔。

 

***\*例程5.8.4\****

实现上述情况4

```matlab
h = [-1 1 -2 2 -3 3 -2 2 -1 1];

M = length(h);

n = 0:M-1;

[Hr,w,d,L] = hr_type4(h);

subplot(2,2,1); stem(n,h); 

xlabel('n'); ylabel('h(n)'); title('脉冲响应')

subplot(2,2,2); plot(w/pi,Hr); 

xlabel('频率单位pi'); ylabel('Hr'); title('IV型幅度函数')

subplot(2,2,3); stem(1:L,d); 

xlabel('n'); ylabel('d(n)'); title('d(n)系数')

subplot(2,2,4); zplane(h,1); title('零极点图')

 

function [Hr,w,d,L] = hr_type4(h);

 M = length(h);

 L = M/2;

 d = 2*[h(L:-1:1)];

 n = [1:1:L]; n = n-0.5;

 w = [0:1:1000]'*pi/500;

Hr = sin(w*n)*d';

end
```

<img src=".\fig\5.8.6.png" style="zoom:50%;"/> 

图5.8.6 情况4

### **5.8.3** 零点位置

当$h(n)$为偶对称时，$h(n) = h(N - 1 - n)$则

|      | $H(z) = \sum\limits_{n = 0}^{N - 1} {h(n){z^{ - n}}}  + \sum\limits_{n = 0}^{N - 1} {h(N - 1 - n){z^{ - n}}} $ |      |
| ---- | ------------------------------------------------------------ | ---- |
|      |                                                              |      |

进行变量置换，将$m = N - 1 - n$代入

|      | $H(z) = \sum\limits_{m = 0}^{N - 1} {h(m){z^{ - (N - 1 - m)}}}  = {z^{ - (N - 1)}}\sum\limits_{m = 0}^{N - 1} {h(m){z^m}}  = {z^{ - (N - 1)}}\sum\limits_{m = 0}^{N - 1} {h(m){{({z^{ - 1}})}^{ - m}}} $ |          |
| ---- | ------------------------------------------------------------ | -------- |
|      | $H(z) = {z^{ - (N - 1)}}H({z^{ - 1}})$                       | (5.8.22) |

因此                   

​        四种线性相位FIR滤波器特性     表5.8.1

| 偶对称单位脉冲响应    $h(n) =  - h(N - 1 - n)$ |                                                              |                                                              |                                                              |
| ---------------------------------------------- | ------------------------------------------------------------ | ------------------------------------------------------------ | ------------------------------------------------------------ |
| 情 况 1                                        | 相位响应$\theta (\omega ) =  - (N - 1)\omega /2$<img src=".\fig\表5.8.1(a).png" style="zoom:50%;"/> | *N*为奇数 <img src=".\fig\表5.8.1(b).png" style="zoom:50%;"/> | $H(\omega ) = \sum\limits_{n = 0}^{\frac{{N - 1}}{2}} {a(n)\cos (\omega n)} $<img src=".\fig\表5.8.1(c).png" style="zoom:50%;"/> |
| 情 况 2                                        | *N*为偶数 <img src=".\fig\表5.8.1(d).png" style="zoom:50%;"/> | $H(\omega ) = \sum\limits_{n = 0}^{\frac{N}{2}} {b(n)\cos \left[ {\omega (n - \frac{1}{2})} \right]} $<img src=".\fig\表5.8.1(e).png" style="zoom:50%;"/> |                                                              |
| 奇对称单位脉冲响应     $h(n) =   h(N - 1 - n)$ |                                                              |                                                              |                                                              |
| 情 况 3                                        | 相位响应$\theta (\omega ) =  - \omega (\frac{{N - 1}}{2}) + \frac{\pi }{2}$<img src=".\fig\表5.8.1(f).png" style="zoom:50%;"/> | *N*为奇数<img src=".\fig\表5.8.1(g).png" style="zoom:50%;"/> | $H(\omega ) = \sum\limits_{n = 0}^{\frac{{N - 1}}{2}} {a(n)\cos (\omega n)} $<img src=".\fig\表5.8.1(h).png" style="zoom:50%;"/> |
| 情 况 4                                        | *N*为偶数<img src=".\fig\表5.8.1(i).png" style="zoom:50%;"/> | $H(\omega ) = \sum\limits_{n = 0}^{\frac{N}{2}} {b(n)\cos \left[ {\omega (n - \frac{1}{2})} \right]} $<img src=".\fig\表5.8.1(j).png" style="zoom:50%;"/> |                                                              |

 

同理，当$h(n)$为奇对称时，$h(n) =  - h(N - 1 - n)$ 

|      | $H(z) =  - {z^{ - (N - 1)}}H({z^{ - 1}})$ | (5.8.23) |
| ---- | ----------------------------------------- | -------- |
|      |                                           |          |

由 (5.8.22) 式与 (5.8.23) 式可知，线性相位滤波器的系统函数为

|      | $H(z) =  \pm {z^{ - (N - 1)}}H({z^{ - 1}})$ | (5.8.24) |
| ---- | ------------------------------------------- | -------- |
|      |                                             |          |

由上式可见，若$z = {z_i}$是$H(z)$的零点，则${z_i}$的倒数$z = {z_i}^{ - 1}$也是一定是$H(z)$的零点当$h(n)$是实数时，$H(z)$的零点，必成共轭对出现，所以$z = {z_i}^*$及$z = z{({z_i}^*)^{ - 1}}$也必定是零点。因此线性相位FIR滤波器的零点位置共有四种可能情况：

1) ${z_i}$是既不在实轴上又不在单位圆上的负零点，则必然是互为倒数的两组共轭对，如图5.8.7中零点${z_1}$所示的情况。
2) ${z_i}$是既在单位圆上又在实轴的零点。因为该零点没有复共轭零点，其倒数又是它自身，所以四个互为倒数的共轭数都合为一点，这只有两种可能，或位于$z =  \pm 1$，或位于z=-1，如图5.8.7中零点${z_2}$，${z_3}$所示的情况。
3) ${z_i}$是在单位圆上，但不在实轴上的复零点。其复共轭零点也在单位圆上，共轭对的倒数就是其本身，如图5.8.7中零点${z_4}$所示的情况。
4) ${z_i}$是不在单位圆上,但在实轴上的零点。显然这是实数零点，它没有共轭复零点，但有一个倒数零点$z = {z_i}^{ - 1}$，如图5.8.7中零点${z_5}$所示的情况。

由前面关于频率响应特点的讨论可知，$h(n)$为偶对称，*N*为偶数的情况，则有单根z=-1处的零点。而对$h(n)$为奇对称，*N*为偶数的情况有单根z=1的零点。在$h(n)$为奇对称，*N*为奇数时则z=1，及z=-1都为零点

 

<img src=".\fig\5.8.7.png" style="zoom:50%;"/> 

图5.8.7线性相位FIR滤波器零点位置图

## 5.9 窗函数设计法

窗函数设计法也称傅里叶级数法。

### 5.9.1 设计原理

FIR滤波器的设计问题，就是要使所设计的FIR滤波器的频率响应$H({{\rm{e}}^{j\omega }})$去逼近所要求的理想滤波器的响应${H_d}({{\rm{e}}^{j\omega }})$。从单位采样响应序列来看，就是所设计滤波器的$h(n)$逼近理想滤波器的单位采样响应。序列${h_d}(n)$。由第2章分析可知

|      | ${H_d}({e^{j\omega }}) = \sum\limits_{n =  - \infty }^\infty  {{h_d}(n){e^{ - j\omega n}}} $ | (5.9.1) |
| ---- | ------------------------------------------------------------ | ------- |
|      | ${h_d}(n) = \frac{1}{{2\pi }}\int\limits_{ - \pi }^\pi  {{H_d}({e^{j\omega }})} {e^{j\omega n}}d\omega $ | (5.9.2) |

一般来说，理想的选频滤波器的${H_d}({e^{j\omega }})$是逐段恒定的，且在频带边界处有不连续点，因此序列${h_d}(n)$是无限长的，这时不能用 (5.9.1) 式中傅氏级数系数来设计滤波器，因为第一，滤波器的单位采样响应${h_d}(n)$是无限长的，n从$ - \infty  \sim  + \infty $无法求和；第二由于${h_d}(n)$是从$ - \infty $开始，所以是非因果的，且不能用有限时延来实现它。

为解决上述问题，可采取如下办法：

1. 用有限项和来逼近无限项和。由傅里叶级数理论可知，(5.9.1) 式级数的有限部分和$\sum\limits_{N =  - (N - 1)/2}^{(N - 1)/2} {{h_d}(n){e^{ - j\omega }}} $是${H_d}({e^{j\omega }})$在均方意义下的最优逼近。这时用到的单位脉冲响应显然是${h_d}(n)$的一段，是有限长。
2. 将有限长的${h_d}(n)$进行$(N - 1)/2$的有限延时，从而由非因果系统得到了因果的系统。幅频特性完全不被时延所影响。因为时域的时延，在频域相应于线性相移，往往可以不考虑。

这种直接截取无限长序列以得到有限长序列的办法，可以形象地想象为$h(n)$好比通过一个“窗口”所看到的一段${h_d}(n)$。因此$h(n)$也可以表达为${h_d}(n)$和一个窗函数$w(n)$的乘积，$h(n) = w(n){h_d}(n)$。这里窗函数就是矩形序列${R_N}(n)$。

**例** 截止频率为${\omega _c}$的线性相位理想低通滤波器

${H'_d}({e^{j\omega }}) = \left\{ {\begin{array}{*{20}{c}}
{1,\left| \omega  \right| \le {\omega _c}}\\
{0,{\omega _c} \le \left| \omega  \right| \le \pi }
\end{array}} \right.$

|      |                                                              | (5.9.3) |
| ---- | ------------------------------------------------------------ | ------- |
| 而   | ${h'_d}(n) = \frac{1}{{2\pi }}\int\limits_{ - {\omega _c}}^{{\omega _c}} {{e^{j\omega n}}} d\omega  = \frac{{\sin {\omega _c}n}}{{\pi n}}$ |         |

其图形已示于图2.5.2 中，这里重画于图5.9.1(a) 中。为了用一个因果的有限长的序列去逼近${h'_d}(n)$，将${h'_d}(n)$进行$(N-1)/2$的有限时延，此时${H'_d}({e^{j\omega }})$变为

${H_d}({e^{j\omega }}) = \left\{ {\begin{array}{*{20}{c}}
{{e^{ - j\omega \frac{{N - 1}}{2}}},\left| \omega  \right| \le {\omega _c}}\\
{0,{\omega _c} < \left| \omega  \right| \le \pi }
\end{array}} \right.$

|      |                                                              |         |
| ---- | ------------------------------------------------------------ | ------- |
| 而   | ${h_d}(n) = \frac{1}{{2\pi }}\int\limits_{ - {\omega _c}}^{{\omega _c}} {{e^{ - j\omega \frac{{N - 1}}{2}}}} {e^{j\omega n}}d\omega  = \frac{{\sin [{\omega _c}(n - \frac{{N - 1}}{2})]}}{{\pi (n - \frac{{N - 1}}{2})}}$ | (5.9.4) |

截取$n=0$到$n=N-1$的一段${h_d}(n)$作为$h(n)$，即

$h(n) = {h_d}(n){R_N}(n) = \left\{ {\begin{array}{*{20}{c}}
{{h_d}(n),0 \le n \le N - 1}\\
{0,else}
\end{array}} \right.$                                                (5.9.5)

这个过程如图5.9.1(b)(c) 所示，这样就得到了所设计的滤波器的单位采样响应$h(n)$，它仍具有偶对称性，故所得到的是线性相位滤波器，这时FIR滤波器的频响为$H({e^{j\omega }}) = \sum\limits_{n = 0}^{N - 1} {h(n){e^{ - j\omega n}} = \sum\limits_{n = 0}^{N - 1} {{h_d}(n){e^{ - j\omega n}}} } $实际上这就是${H_d}({e^{j\omega }})$的傅里叶级数有限部分的和。N越大，$H({e^{j\omega }})$和${H_d}({e^{j\omega }})$的差别越小，但所需的计算量越大。N的选择既要满足精度要求，又要尽可能地小。

 

<img src=".\fig\5.9.1.png" style="zoom:50%;"/> 

图5.9.1 理想单位采样响应的直接截取

### **5.9.2** ***\*矩形窗截断的影响\****

现在考察理想低通滤波器单位采样响应的加窗处理对频响将产生什么影响，这种逼近质量如何？

设${W_R}({e^{j\omega }})$为矩形窗${R_N}(n)$的频谱，由复卷积定理可知，两序列乘积的频谱

|      | $H({e^{j\omega }}) = \frac{1}{{2\pi }}\int\limits_{ - \pi }^\pi  {{H_d}} ({e^{j\theta }}){W_R}[{e^{j(\omega  - \theta )}}]d\theta $ | (5.9.6) |
| ---- | ------------------------------------------------------------ | ------- |
|      |                                                              |         |

因此，逼近质量的好坏完全取决于窗口函数的频率特性。由第三章可知，对于单边的矩形窗函数频谱

|      | ${W_R}({e^{j\omega }}) = \frac{{\sin (\frac{{\omega N}}{2})}}{{\sin \frac{\omega }{2}}}{e^{ - j\omega (\frac{{N - 1}}{2})}} = {W_R}(\omega ){e^{ - j\omega a}}$ | (5.9.7) |
| ---- | ------------------------------------------------------------ | ------- |
|      |                                                              |         |

${e^{ - j\omega }}$是其线性相位部分，$a = (N - 1)/2$。${W_R}(\omega ) = \sin (\frac{{\omega N}}{2})/\sin \frac{\omega }{2}$是其幅度函数，它在$\omega  =  \pm 2\pi /N$之内有一个主瓣，然后由两侧呈衰减震荡展开，形成许多副瓣，如图5.9.2(b)所示理想频率响应也可写成

|      | ${H_d}({e^{j\omega }}) = {H_d}(\omega ){e^{ - j\omega a}}$ | (5.9.8) |
| ---- | ---------------------------------------------------------- | ------- |
|      |                                                            |         |

其幅度函数：${H_d}(\omega ) = \left\{ {\begin{array}{*{20}{c}}
{1,\left| \omega  \right| \le {\omega _c}}\\
{0,{\omega _c} \le \left| \omega  \right| \le \pi }
\end{array}} \right.$ 

如图5.9.2(a)所示。将 (5.9.7) 式及 (5.9.8) 式的结果带入 (5.9.6) 式，则

$\begin{array}{l}
H({e^{j\omega }}) = \frac{1}{{2\pi }}\int\limits_{ - \pi }^\pi  {{H_d}(\theta ){e^{ - j\theta a}}{W_R}(\omega  - \theta )} {e^{ - j(\omega  - \theta )a}}d\theta \\
 = {e^{ - j\omega a}}[\frac{1}{{2\pi }}\int\limits_{ - \pi }^\pi  {{H_d}(\theta )} {W_R}(\omega  - \theta )]d\theta 
\end{array}$

因此实际的FIR滤波器幅度函数$H(\omega )$为

|      | $H(\omega ) = \frac{1}{{2\pi }}\int\limits_{ - \pi }^\pi  {{H_d}(\theta )} {W_R}(\omega  - \theta )d\theta $ | (5.9.9) |
| ---- | ------------------------------------------------------------ | ------- |
|      |                                                              |         |

可见对实际滤波器频响$H(\omega )$起影响的部分是窗函数的幅度函数。

(5.9.9) 式的卷积过程可用图5.9.2说明。只要找出几个特殊频率点的$H(\omega )$,即可看出$H(\omega )$的一般状况。请注意这个卷积过程给$H(\omega )$响应造成的起伏现象。

<img src=".\fig\5.9.2.png" style="zoom:50%;"/> 

图5.9.2 矩形窗函数的卷积过程

1.零频率$\omega  = 0$时的响应值$H(0)$。由 (5.9.9) 式可见：$H(0)$就是图5.9.2 中(a)与(b)两函数乘积的积分，也就是${W_R}(\theta )$在$\theta  =  - {\omega _c}$到$\theta  =  + {\omega _c}$一段的积分面积。由于一般情况下都满足${\omega _c} \gg \frac{{2\pi }}{N}$的条件，所以$H(0)$可近似视为$\theta $从$ - \pi $到$  \pi $的${W_R}(\omega  - \theta )$的全部积分面积。我们将$H(0)$处的值归一化为1。

2. $\omega  = {\omega _c}$时的响应值$H({\omega _c})$。此时${H_d}(\theta )$与${W_R}(\omega  - \theta )$的一半重叠，因此$H({\omega _c})/H(0) = 0.5$。

**3.** $\omega  = {\omega _c} - 2\pi /N$时的响应值$H({\omega _c} - 2\pi /N)$。这时${W_R}(\omega  - \theta )$的全部主瓣都在${H_d}(\theta )$的通带内，因此频响$H({\omega _c} - 2\pi /N) = \max $出现正肩峰。

**4.**  $\omega  = {\omega _c} + 2\pi /N$时的响应值$H({\omega _c} + 2\pi /N)$。这时${W_R}(\omega  - \theta )$的主瓣刚好全部在${H_d}(\theta )$通带外，而通带内的副瓣负的面积大于正的面积，因此$H({\omega _c} + 2\pi /N)$出现负肩峰。

5. 当$\omega $继续在${H_d}(\theta )$的阻带内变化时，${W_R}(\omega  - \theta )$的左边副瓣将扫过通带，因此这时$H(\omega )$将围绕着零波动；当$\omega $由${\omega _c}$向${H_d}(\theta )$通带内变化时，${W_R}(\omega  - \theta )$的左副瓣和右副瓣将扫过通带，因此这时$H(\omega )$将围绕1波动。图5.9.2(c)表示$H(\omega )$与${W_R}(\omega  - \theta )$的卷积过程图。

综上所述，可以得到图5.9.2(d)所示的$H(\omega )/H(0)$,并得出加窗处理对理想特性产生以下三点影响：

(1) 使理想频率特性不连续边沿加宽，形成一个过渡带，过渡带${W_R}(\omega )$的宽度等于的主瓣宽度$\Delta \omega  = 4\pi /N$。

(2) 在截止频率${\omega _c}$的两旁$\omega  = {\omega _c} + 2\pi /N$的地方（即过渡带两旁），$H(\omega )$出现最大的肩峰值。最大肩峰值的两侧，形成长长的余振，它们取决于窗口频谱的副瓣，副瓣越多，余振也越多。副瓣相对值越大，则肩峰愈强。

(3)增加截取长度$N$，则窗函数主瓣附近的频谱结构为

|      | ${W_R}(\omega ) = \frac{{\sin (\frac{{\omega N}}{2})}}{{\sin \frac{\omega }{2}}} \approx \frac{{\sin (\frac{{\omega N}}{2})}}{{\frac{\omega }{2}}} = N\frac{{\sin x}}{x}$ |      |
| ---- | ------------------------------------------------------------ | ---- |
|      |                                                              |      |

其中 $x = \frac{{\omega N}}{2}$ 

可见，改变长度$N$，只能改变窗频谱的主瓣宽度和改变$\omega $坐标的比例与${W_R}(\omega )$的绝对大小，而不能改变主瓣与副瓣的相对比例（但$N$太小时则会影响副瓣相对值），这个相对比例是由$\sin x/x$决定的，或若说只决定于窗函数的形状。因此增加截取长度$N$只能相应地减小过渡带宽度，而不能改变肩峰值。例如在矩形窗的情况下，最大肩峰值为8.95%,当$N$增加时，只能使起伏振荡变密，而最大肩峰却总是8.95%，这种现象称为吉布斯效应（Gibbs Effect)。肩峰值大小直接决定着通带内的平稳和阻带的衰减，对滤波器的性能影响很大。

顺便指出：在矩形窗情况下，FIR滤波器可以方便地设计成具有线性相位特性。如果

|      | ${h_d}(n) = {h_d}(N - 1 - n)$ |      |
| ---- | ----------------------------- | ---- |
|      |                               |      |

因矩阵窗序列满足	${R_N}({\rm{n}}) = {R_N}(N - 1 - n)$

则必有				$h({\rm{n}}) = h(N - 1 - n)$

这表示所设计的FIR滤波器的频率响应$H({e^{j\omega }})$必定是具有线性相位频率特性的。

**例**	在上例中已求得

|      | $h(n) = {h_d}(n){R_N}(n) = \frac{{\sin [{\omega _c}(n - \frac{{N - 1}}{2})]}}{{n - \frac{{N - 1}}{2}}},n = 0.1 \cdots N - 1$ |      |
| ---- | ------------------------------------------------------------ | ---- |
|      |                                                              |      |

设$N$为奇数，则据 (5.8.8) 式可直接写出这个FIR低通数字滤波器的频率响应

|      | $H({e^{j\omega }}) = {e^{ - j\omega \frac{{N - 1}}{2}}}\left\{ {\sum\limits_{n = 0}^{\frac{{N - 1}}{2} - 1} {\frac{{2\sin [{\omega _c}(n - \frac{{N - 1}}{2})]\cos [\omega (n - \frac{{N - 1}}{2})] + \frac{{{\omega _c}}}{\pi }}}{{\pi (n - \frac{{N - 1}}{2})}}} } \right\}$ |      |
| ---- | ------------------------------------------------------------ | ---- |
|      |                                                              |      |

若$N = 51$，${\omega _c} = 0.5\pi $，则

|      | $\begin{array}{l}<br/>{h_d}(n) = \frac{{\sin [0.5\pi (n - 25)]}}{{\pi (n - 25)}}\\<br/>H({e^{j\omega }}) = \left\{ {\sum\limits_{n = 0}^{24} {\frac{{2\sin [0.5\pi (n - 25)\cos [\pi (n - 25)]}}{{\pi (n - 25)}} + \frac{{{\omega _c}}}{\pi }} } \right\}{e^{ - j25\omega }}<br/>\end{array}$ |      |
| ---- | ------------------------------------------------------------ | ---- |
|      |                                                              |      |

其波形如图5.9.3 

 

***\*例程5.9.1\****

实现上例窗函数设计法

```matlab
N = 51;

ord = 50;

b = fir1(ord, 0.5, 'low', rectwin(N));

[h,w] = freqz(b,1);

[I,t] = impz(b,N);

stem(t, I)

title('冲激响应');

ylabel('幅值')

figure()

plot(w/pi,20*log10(abs(h)));

title('20*log10|He(jw)|');

xlabel('归一化频率(xpi rad/sample)')

ylabel('幅值(dB)')
```

 

<img src=".\fig\5.9.3(a).png" style="zoom:50%;"/> 

<img src=".\fig\5.9.3(b).png" style="zoom:50%;"/> 

图5.9.3 矩形窗设计FIR数字滤波器

(a)矩形窗截断的${H_d}(n)$(延时为25个采样间隔，$N = 51$) (b)$20{\log _{10}}\left| {H({e^{j\omega }})} \right|,{\omega _c} = 0.5\pi $

 

### **5.9.3** ***\*窗口修正\****

矩形截断对所需幅度响应的影响是肩峰达8.95%，致使阻带最小衰减只有-21dB，这在工程上往往是不够的。为了改善阻带的衰减特性，只能从改善窗函数的形状上找出路。要使窗函数频谱产生的影响最小，由频域卷积公式 (5.9.9) 可见,就需要使函数的频谱逼近一冲激函数，亦即大部分能量尽可能地集中在频谱的中点。显然理想的冲击函数频谱是不可能产生的，因为这需要无限长的窗宽，等于不加窗，没有意义。

一般希望窗函数满足两项要求：$a$ 主瓣尽可能地窄，以获得较陡的过渡带。$b$ 最大的副瓣相对于主瓣尽可能地小，也即能量集中在主瓣中。这样，就可以减少肩峰和余振.提高阻带的衰减。这两项要求不可能同时得到最佳，常用的窗函数是在这两个因素之间取得迠当的折衷。往往需要增加主瓣宽度以换取副瓣的抑制。如果选用一个窗函数的主要目的是为了得到较锐的截止，就应选用主瓣较窄的窗函数，这样在通带中将产生一些振荡，在阻带中会出现显著的波纹。如果主要H的是为了得到平坦的幅度响应和较小的阻带波纹，这时选用的窗函数的副瓣电平就要较小，但所设计的FIR滤波器的截止锐度就不会很大。

常用的窗函数已在3.8节中介绍过，如三角窗，汉宁窗，海明窗，布拉克曼窗等，都是由于在边缘（$n=0$和$n=N-1$点附近)比矩形窗序列圆滑而减小了陡峭的边缘所引起的副瓣分量，但主瓣宽度却比矩形窗大，因而用这些窗函数所设计的FIR滤波器的阻带衰减和过渡带带宽都比矩形窗设计的FIR滤波器为大。

图5.9.4表示了用五种窗函数对同一指标$N = 51$，${\omega _c} = 0.5\pi $所设计的FIR数字滤波器的频率响应曲线。其中矩形窗设计的数字滤波器频率响应曲线，已在图5.9.3中示出了。这里为了比较也一并画出。

<img src=".\fig\5.9.4(a).png" style="zoom:50%;"/> 

(a)矩形窗

<img src=".\fig\5.9.4(b).png" style="zoom:50%;"/> 

(b)三角形窗

<img src=".\fig\5.9.4(c).png" style="zoom:50%;"/> 

(c)汉宁窗

<img src=".\fig\5.9.4(d).png" style="zoom:50%;"/> 

(d)海明窗

<img src=".\fig\5.9.4(e).png" style="zoom:50%;"/> 

(e)布拉克曼窗

 

<img src=".\fig\5.9.4(f).png" style="zoom:50%;"/> 

(f) 五种窗比较

图5.9.4 $N = 51$，${\omega _c} = 0.5\pi $五种窗情况下所设计的FIR滤波器的$20{\log _{10}}\left| {H({e^{j\omega }})} \right|$

​		  

图5.9.5表示增加窗的长度$N$对低通滤波器设计的影响。由图可见，$N$增大，阻带衰减不变，过渡区变小。因为，由图5.9.2 的矩形窗与理想频响的卷积过程知道，过渡区决定于窗的主瓣宽度，窗的主瓣宽度与$N$成反比。

 

<img src=".\fig\5.9.5(a).png" style="zoom:50%;"/> 

(a) $N = 51$

<img src=".\fig\5.9.5(b).png" style="zoom:50%;"/>  

(b) $N = 101$

<img src=".\fig\5.9.5(c).png" style="zoom:50%;"/>  

(c) $N = 201$

图5.9.5 窗口长度对滤波器设计的影响 (低通滤波器，${\omega _c} = 0.5\pi $，海明窗口函数) 

  

综上所述，在设计FIR数字滤波器时，可以通过选择窗函数的形状和窗函数列长$N$对设计过程加以控制。

在3.8节中给出了偶对称的凯塞窗函数。这里为适应FIR滤波器的设计，写出单边表示的凯塞窗函数

|      | $w(n) = \frac{{{I_0}[\pi a\sqrt {1 - {{[\frac{{2n}}{{(n - 1)}} - 1]}^2}} ]}}{{{I_0}(\pi a)}},0 \le n \le N - 1$ | (5.9.10) |
| ---- | ------------------------------------------------------------ | -------- |
|      |                                                              |          |

${(\pi a)}$值可自由选择，以便在主瓣宽度与副瓣电平之间得到调节。${(\pi a)}$值选得越高，其频谱的副瓣越小，但主瓣宽度也相应增加。由 (5.9.10) 式可知${(\pi a)}=0$时就是矩形窗。表5.9.1表示凯塞窗函数在不同${(\pi a)}$值下的特点。参数${(\pi a)}$多选择在$4 < (\pi a) < 9$范围内。     

|             | 凯塞窗${(\pi a)}$参数的影响 | 表5.9.1            |                        |
| ----------- | --------------------------- | ------------------ | ---------------------- |
| ${(\pi a)}$ | **过渡带**$\Delta \omega $  | **通带波动**$(dB)$ | **阻带最小衰减**$(dB)$ |
| 2.120       | $3.00\pi /N$                | $ \pm 0.27$        | -30                    |
| 3.384       | $4.46\pi /N$                | $ \pm 0.0864$      | -40                    |
| 4.583       | $5.86\pi /N$                | $ \pm 0.0274$      | -50                    |
| 5.658       | $7.42\pi /N$                | $ \pm 0.00868$     | -60                    |
| 6.764       | $8.64\pi /N$                | $ \pm 0.00275$     | -70                    |
| 7.865       | $10.0\pi /N$                | $ \pm 0.000868$    | -80                    |
| 8.960       | $11.4\pi /N$                | $ \pm 0.000275$    | -90                    |
| 10.056      | $12.8\pi /N$                | $ \pm 0.000087$    | -100                   |

 

单边表示的凯塞窗函数的曲线如图5.9.6所示。在中点，$n = (N - 1)/2$，$w((N - 1)/2) = {I_0}(\pi a)/{I_0}(\pi a) = 1$。当$n$从中点向两边变化时，$w(n)$逐渐减小。参数$(\pi a)$值越大，$w(n)$变化越快，最后$n=0$及$n=N-1$时，$w(0) = w(N - 1) = 1/{I_0}(\pi a)$。

<img src=".\fig\5.9.6.png" style="zoom:50%;"/>  

图5.9.6 凯塞窗函数

表5.9.2归纳了前面提到的几种窗函数的主要性能， 可供在设计FIR滤波器时参考。

​         六种窗函数的基本参数     表5.9.2

| **窗函数**     | **过渡带**$\Delta \omega $ | **阻带最小衰减**$(dB)$ |
| -------------- | -------------------------- | ---------------------- |
| **矩形窗**     | $4\pi /N$                  | -21                    |
| **三角窗**     | $8\pi /N$                  | -25                    |
| **汉宁窗**     | $8\pi /N$                  | -44                    |
| **海明窗**     | $8\pi /N$                  | -53                    |
| **布拉克曼窗** | $12\pi /N$                 | -74                    |
| **凯塞窗**     | $10\pi /N$                 | -80                    |

 

必须指出，由于上述函数全是对称的，故可用以设计线性相位FIR滤波器。

### **5.9.4** ***\*设计步骤与存在问题\****

综上所述，可得窗函数法设计FIR滤波器的步骤如下：

1) 给定要求的频率响应函数${H_d}({e^{j\omega }})$。
2) 用 (5.9.2) 式计算${h_d}(n)$。
3) 根据过渡带宽及阻带最小衰减的要求，由表5.9.1，表5.9.2选定窗的形状及$N$的大小，可通过几次尝试而最后确定下。
4) 根据所选择的合适的窗函数$w(n)$按 (5.9.5) 式来修正${h_d}(n)$，得到所设计的FIR数字滤波器的单位采样响应

|      | $h(n) = w(n){h_d}(n),n = 0,1 \cdots N - 1$ |      |
| ---- | ------------------------------------------ | ---- |
|      |                                            |      |

因此，窗函数法设计的主要工作是计算${h_d}(n)$及$w(n)$，再将它们相乘。

计算中的主要问题是：

（1）当${H_d}({e^{j\omega }})$很复杂或不能用它按 (5.9.2) 式直接算出积分时，就很难得到或根本得不到的表达式，这时可用求和代转积分，以便于在计算机上进行计算。将积分限分成**M**段，对${H_d}({e^{j\omega }})$采样，$M$个采样频率点是$(2\pi /M)k,k = 0,1,2 \cdots M - 1$，于是

|      | ${h_M}(n) = \frac{1}{M}\sum\limits_{k = 0}^{M - 1} {{H_d}({e^{j\frac{{2\pi k}}{M}}}){e^{j\frac{{2\pi k}}{M}}}} $ | (5.9.11) |
| ---- | ------------------------------------------------------------ | -------- |
|      |                                                              |          |

频域的采样，造成时域序列的周期延拓，延拓周期是M，即

|      | ${h_M}(n) = \sum\limits_{ - \infty }^\infty  {{h_d}(n + rM)} $ | (5.9.12) |
| ---- | ------------------------------------------------------------ | -------- |
|      |                                                              |          |

因${h_d}(n)$可能是无限长序列，因而严格说必须${M \to \infty }$时,${h_M}(n)$才能等于${h_d}(n)$而不产生混叠现象，即

|      | ${h_d}(n) = \mathop {\lim }\limits_{M \to \infty } {h_M}(n)$ | (5.9.13) |
| ---- | ------------------------------------------------------------ | -------- |
|      |                                                              |          |

实际上，由于${h_d}(n)$随**n**的增加，衰减很快，一般只要**M**足够大，即$M \gg N$，近似就足够了。这是因为窗只在${h_M}(n)$中的**N**点内有值。(5.9.11) 式正是\[{H_d}(k) = {H_d}({e^{j\frac{{2\pi }}{M}k}})\]的**M**点离散傅里叶反变换，因此可用FFT来计算，很快得出结果。

（2）在计算凯塞窗时，对零阶贝塞尔函数${I_0}(x)$可用3.8节中提到的无穷级数。

|      | ${I_0}(x) = 1 + \sum\limits_{k = 1}^\infty  {[\frac{1}{{k!}}{{(\frac{x}{2})}^k}]} $ |      |
| ---- | ------------------------------------------------------------ | ---- |
|      |                                                              |      |

这个无穷级数可以用有限项级数去近似，取项的多少取决定于所需要的精度。

（3）窗函数设计法的另一困难是需要预先确定窗函数的形式和窗的列长**N**以满足预定的频率响应指标，但是这一困难可以利用数字计算机程序，釆用试探法来确定而方便地解决。

窗函数大多都有封闭公式可循，所以窗函数设计法简单、方便、实用。

## 5.10 频率采样设计法

### 5.10.1设计原理

​		窗函数法设计的出发点是从时域开始，用窗函数截取理想的$h_d(n)$得$h(n)$，以有限长$h(n)$近似理想的$h_d(n)$，这样得到的频率响应$H(e^{jw})$，逼近于理想的频响$H_d(e^{j\omega})$，频率采样设计法是从频域出发。因为有限长序列$h(n)$又可用其离散傅里叶变换$H(k)$来唯一确定，$H(k)$与所要求的FIR滤波器系统函数$H_d(z)$之间存在着频率采样关系。即$H_d(z)$在$z$平面单位圆上按角度等分的采样值等于$H_d(k)$的各相应值，就以此$H_d(k)$值作为实际FIR数字滤波器频率特性的采样值$H(k)$，或者说$H(k)$正是所要求的频率响应$H_d(e^{j\omega})$的$N$个等间隔的采样值。这就是$H\left( k \right) = {H_d}\left( k \right) = {\left. {{H_d}\left( z \right)} \right|_{z = ej\left( {\frac{{2\pi }}{N}} \right)k}}$          (5.10.1)

或

$H(k) = {H_d}(k) = {\left. {{H_d}\left( {{{\rm{e}}^{{\rm{j}}\omega }}} \right)} \right|_{\omega  = \frac{{2\pi k}}{N}(k = 0,1,2 \cdots N - 1)}}$    (5.10.2)

而由 (5.3.6) 式得
$H(z) = \frac{{\left( {1 - {z^{ - N}}} \right)}}{N} = \sum\limits_{k = 0}^{N - 1} {\frac{{H(k)}}{{1 - W_N^{ - k}{z^{ - 1}}}}} $        (5.10.3)  

或由 (3.6.9) 式 (3.6.10) 式得到
$H\left( {{{\rm{e}}^{j\omega }}} \right) = \sum\limits_{k = 0}^{N - 1} {H\left( k \right)\phi \left( {\omega  - k\frac{{2\pi }}{N}} \right)}  = \frac{1}{N}{{\rm{e}}^{ - j\frac{{N - 1}}{2}\omega }}\sum\limits_{k = 0}^{N - 1} {H\left( k \right){{\rm{e}}^{ - j\frac{{k\pi }}{N}}}\frac{{\sin \frac{{N\omega }}{2}}}{{\sin \left( {\frac{\omega }{2} - \frac{{\pi k}}{N}} \right)}}}$    (5.10.4)

上述分析提供了直接由频域出发设计FIR数字滤波器的途径。即按照给定的滤波器频率响应特性指${H_d}\left( {{{\rm{e}}^{{\rm{j}}\omega }}} \right)$［或说$H_d(z)$］，在$z$平面单位圆上等角度采样得$H(k)$。据所得的$H(k)$，由(5.10.3) 与 (5.10.4) 式可以求出所设计的滤波器的系统函数$H(z)$或频率响应$H(e^{j\omega})$。这个$H(z)$或$H(e^{j\omega})$将逼近于$H_d(z)$或${H_d}\left( {{{\rm{e}}^{{\rm{j}}\omega }}} \right)$。

下面看$H(e^{j\omega})$逼近于${H_d}\left( {{{\rm{e}}^{{\rm{j}}\omega }}} \right)$的情况。(5.10.4) 式说明除了线性相位因子${e^{ - j\frac{{N - 1}}{2}\omega }}$外，滤波器频率响应是频率采样值与以下内插函数的线性组合。
$S\left( {\omega ,k} \right) = \frac{1}{N}{{\rm{e}}^{ - j\frac{{\pi k}}{N}}}\frac{{\sin \left( {\frac{{\omega N}}{2}} \right)}}{{\sin \left( {\frac{\omega }{2} - \frac{{\pi k}}{N}} \right)}} = \frac{1}{N}{{\rm{e}}^{ - j\frac{{\pi k}}{N}}}\frac{{\sin \left[ {N\left( {\frac{\omega }{2} - \frac{{\pi k}}{N}} \right)} \right]}}{{\sin \left( {\frac{\omega }{2} - \frac{{\pi k}}{N}} \right)}}{\left( { - 1} \right)^k}$  (5.10.5)

这样，在各频率采样点上，实际滤波器的频率响应是严格地和所要求的滤波器的频率响应一致的，即$H\left( {{{\rm{e}}^{j\frac{{2\pi }}{N}k}}} \right) = {H_d}\left( {{{\rm{e}}^{j\frac{{2\pi }}{N}k}}} \right)$，逼近误差等于零。但在采样点之间的频响是由各采样点的内插函数的延伸叠加形成，其逼近误差是有限的。误差的大小取决于频率响应曲线的圆滑程度和采样点的密度。频率响应曲线愈圆滑，误差愈小；采样点数愈多，即采样频率越高，误差越小。图5.10.1表示所要求的频率响应${H_d}\left( {{{\rm{e}}^{{\rm{j}}\omega }}} \right)$及由频率采样的连续内

![5.10.1](.\fig\5.10.1.png)

图5.10.1 频率采样说明

频率采样设计法特别适用于设计窄带选频滤波器。因为这时非零值$H(k)$的个数很少，因而计算量小。这种方法也有很大缺点，当$\omega {_c}$不是${{2\pi }/ N}$的整倍数时，由于各$H(k)$的$k$值只能取的${{2\pi }/ N}$整数倍的值，所以不能确保$\omega {_c}$准确取值。要想实现精确的截止频率值$\omega {_c}$，$N$必须足够大，计算量也就很大。

​		应该指出，这里所讨论的频率采样法设计与本章前面所讨论的频率采样型结构并不完全是一回事，然而两者的理论根据都是第3章所介绍的频率采样理论。应用频率采样理论建立的FIR滤波器的结构，对于任何FIR系统函数都能采用。而频率采样设计法，只是应用频率采样理论来设计FIR滤波器的系统函数，并不涉及滤波器的结构。它所设计的系统函数，既可采用频率采样甩结构，也可采用直接型结构，或其它结构实现。

### 5.10.2线性相位约束条件

​		当我们要设计的是线性相位FIR滤波器时，其采样值$H(k)$的幅度和相位一定要满足在表5.8.1中所归纳的约束条件。

​		如对第一类线性相位滤波器，即$h(n)$为偶对称$N$为奇数时，由表5.8.1第一栏得
$H\left( {{{\rm{e}}^{j\omega }}} \right) = H\left( \omega  \right){{\rm{e}}^{ - j\left( {\frac{{N - 1}}{2}} \right)\omega }}$        (5.10.6)

其中幅度函数$H(\omega)$应为偶对称，即

$H\left( \omega  \right) = H\left( {2\pi  - \omega } \right)$      (5.10.7)

对$H(e^{j\omega})$在$0$~$2\pi$之间等间隔采样$N$点，得到$H(k)$

$H\left( k \right) = H{\left. {\left( {{{\rm{e}}^{j\omega }}} \right)} \right|_{\omega  = \frac{{2\pi }}{N}k}}$    $k = 0,1,2, \cdots (N - 1)$     (5.10.8)

将$H(k)$写成幅度$H_k$（纯标量）和相位${\theta _k}$的形式

$H\left( k \right) = {H_k}{{\rm{e}}^{j{\theta _k}}}$

则由 (5.10.6) 式可得

${\theta _k} =  - \left( {\frac{{N - 1}}{2}} \right)\frac{{2\pi }}{N}k =  - k\pi \left( {1 - \frac{1}{N}} \right)$      (5.10.9)

由 (5.10.7) 式$H_k$必须满足偶对称

​    $H_k=H_{N-k}$     (5.10.10) 

对于$h(n)$为偶对称，$N$为偶数的情况，由表5.8.1第二栏知，其相位约束仍为 (5.10.9) 式的条件，但幅度函数是奇对称的，$H\left( \omega  \right) = -H\left( {2\pi  - \omega } \right)$  ，所以这时认也应满足奇对称要求

​       $H_k=-H_{N-k}$​          (5.10.11)  

其它两类线性相位FIR滤波器的设计，同样要遵循幅度和相位的相应约束。

### 5.10.3 过渡带采样的优化设计

为了提高频率采样设计法的逼近质量，使得逼近误差更小，可以使某些频率采样点不受限制，然后用计算机运算找出这些不受限制变量的最佳值。通常可选择不受限制的频率采样点位于过渡带，这和窗函数设计法的想法是一样的。“自由”选择过渡带的频率采样值，这就增加了过渡带，但减小了频带边沿两采样点间的突变，也就减小了起伏振荡， 加了止带最小衰减。这些采样点上取值不同，效果也将不同。因为由 (5.10.5) 式知，每一个频率采样值$H(k)$，都要产生一个与常数$sin(N\omega/2)/sin(\omega/2)$成正比，并且在频率轴上位移${{k\pi }/ N}$的频率响应，而FIR滤波器的频率响应就是$H(k)$与内插函数$S(\omega,k)$的线性组合。如果精心设计过渡带的采样值，从这些频率采样值算出的内插值$ \pm H\left( k \right){{\rm{e}}^{ - j\left( {k\pi /N} \right)}} \times \left[ {\sin N\left( {\omega /2 - k\pi /N} \right)} \right]/\sin \left( {\omega /2 - k\pi /N} \right)$就有可能对它的相邻频带（即通、阻带）提供良好的波纹消除，设计出较好的滤波器来。一般在过渡带取一、二或三点采样值即可得到满意结果。阻带衰减在不加过渡带采样时为$-20dB$左右，在过渡带加一点采样时为$-44dB$ ~ $-54dB$左右，加二点采样时为$-65dB$~$-75dB$左右，而加三点采样则可达$-85dB$~$-95dB$左右。

为求出不受限制的频率采样值$H(k)$的最佳值，需要写出一组满足最优化要求的数学方程。下面从简单的例子入手，引出一般结果。

图5.10.2表示频率采样法设计滤波器的典型技术条件。图中域1和域2两个频带的频率响应是给定的，黑点表示选定的频率采样值。过渡带的频率采样值以$T_1$和$T_2$表示，在图中没有确定，其值由最佳求解决定。图5.10.2只画出了频率采样值的一半，因为要使脉冲响应$h(n)$是实数，频率采样值$H(k)$必须是以中心对称的复共轭序列。同时$H(k)$的位置，如前所述还要进一步受限，才能得到线性相位的FIR滤波器。

接(5.10.4)，(5.10.5) 式$H(e^{j\omega})$可表示成以下形式

$H\left( {{{\rm{e}}^{j\omega }}} \right) = {{\rm{e}}^{ - j\frac{{N - 1}}{2}\omega }}\sum\limits_{k = 0}^{kM} H \left( k \right)S\left( {\omega ,k} \right) = {{\rm{e}}^{ - j\frac{{N - 1}}{2}\omega }}H\left( \omega  \right)$          (5.10.12)  

式中

$H\left( \omega  \right) = \sum\limits_{k = 0}^{kM} H \left( k \right)S\left( {\omega ,k} \right)$           (5.10.13)  

<img src=".\fig\5.10.2.png" style="zoom:50%;"/>

图5.10.2 频率采样法设计滤波器的技术要求

$H(\omega)$是滤波器的幅度响应，是实数。$KM+1$是规定的需要的频率采样数。(5.10.12) 式中的线性相位项$e^{-j(n-1)\omega/2}$在滤波器的设计中可以不加考虑，图5.10.2 例子的$H(\omega)$可简化为

$H\left( \omega  \right) = B\left( \omega  \right) + {T_1}{A_1}\left( \omega  \right) + {T_2}{A_2}\left( \omega  \right)$        (5.10.14)  

$B(\omega)$为所有固定频率采样值对提$H(\omega)$供的部分和表示幅度为$T_1$和$T_2$的不受限制的频率采样值对$H(\omega)$提供的部分。

为了求解未知的频率采样值，应写出频域1和2的约束方程。

（1）$\left| {H\left( \omega  \right) - {H_d}\left( \omega  \right)} \right| \le \varepsilon$，$\omega$在区域1中

（2）确定$\left\{ {{T_1},{T_2}} \right\}$，使$\left| {H\left( \omega  \right) - {H_d}\left( \omega  \right)} \right|$的最大值为最小，$\omega$在域2中。可写为

极小化，极大$\left| {H\left( \omega  \right) - {H_d}\left( \omega  \right)} \right|$

 $\left\{ {{T_1},{T_2}} \right\}$   {$\omega$在区域2中}

这里$\varepsilon$是规定的容限，另一组可能的约束是

极小化，极大$\left| {W\left( {{{\rm{e}}^{j\omega }}} \right)\left[ {H\left( \omega  \right) - {H_d}\left( \omega  \right)} \right]} \right|$

 $\left\{ {{T_1},{T_2}} \right\}${$\omega$在区域1和2中} 

这里$W(e^{j\omega})$是频率响应逼近误差的加权函数，是已知的。

利用 (5.10.14) 式在一组较密的频率$\omega$上计算每个约束方程的值，就能把上述第一组约束表示成以下不等式

$\left. \begin{array}{l}
{T_1}{A_1}\left( {{\omega _m}} \right) + {T_2}{A_2}\left( {{\omega _m}} \right) \le \varepsilon  - B\left( {{\omega _m}} \right) + {H_d}\left( {{\omega _m}} \right)\\{T_1}{A_1}\left( {{\omega _m}} \right) - {T_2}{A_2}\left( {{\omega _m}} \right) \le \varepsilon  + B\left( {{\omega _m}} \right) - {H_d}\left( {{\omega _m}} \right)
\end{array} \right\}{\omega _m}$            在区域1中  

$\left. \begin{array}{l}
{T_1}{A_1}\left( {{\omega _m}} \right) + {T_2}{A_2}\left( {{\omega _m}} \right) - {T_3} \le  - B\left( {{\omega _m}} \right) + {H_d}\left( {{\omega _m}} \right)\\{T_1}{A_1}\left( {{\omega _m}} \right) - {T_2}{A_2}\left( {{\omega _m}} \right) - {T_3} \le B\left( {{\omega _m}} \right) - {H_d}\left( {{\omega _m}} \right)
\end{array} \right\}{\omega _m}$      在区域2中

式中$T_3$表示域2内最大的逼近误差。同样，第二组约束也可写成变量$T_1$,$T_2$和$T_3$的线性不等式组，上述不等式方程组可以用线性规划法求解。

### 5.10.4 频率采样的两种方法

频率采样法设计滤波器的基本依据是在环绕单位圆的$N$个等间隔点上规定一组所要求的频率响应采样值。频率点的采样方式可有I型频率采样和II型频率采样两种型式。

1. 线性相位的I型频率采样

I型的频率采样值

$H\left( k \right) = {\left. {{H_d}\left( z \right)} \right|_{z = {{\rm{e}}^{j\frac{{2\pi }}{N}k}}}} = {H_d}{\left. {\left( {{{\rm{e}}^{{\rm{j}}\omega }}} \right)} \right|_{\omega  = \frac{{2\pi k}}{N}}}$    $k = 0,1 \cdots N - 1$         (5.10.15)  

采样频率是${f_k} = k/N$，   $k = 0,1 \cdots N - 1$  。它相应于计算$N$点DFT所用的$N$个频率。I型设计的起始点在$f=0$，即$z = {{\rm{e}}^{j{0^o}}}$处，它可分$N$为偶数和奇数两种情况，如图5.4.11所示。

根据前述，I型频率采样时的频率响应为

$H\left( {{{\rm{e}}^{{\rm{i}}w}}} \right) = \frac{{{e^{ - j\frac{{\omega (N - 1)}}{2}}}}}{N}\sum\limits_{k = 0}^{N - 1} H (k){{\rm{e}}^{ - j\frac{{\pi k}}{N}}}\frac{{\sin \left( {\frac{{N\omega }}{2}} \right)}}{{\sin \left( {\frac{\omega }{2} - \frac{{\pi k}}{N}} \right)}}$              (5.10.16)  

在线性相位滤波器的情况下有$(N-1)/2$个采样点的延迟，按线性相位频率响应关系式将频率采样$H(k)$也表示成幅度响应$|H(k)|$及相位响应${\theta (k)}$的形式，即
$H\left( k \right) = \left| {H\left( k \right)} \right|{{\rm{e}}^{j\theta \left( k \right)}}$      $k = 0,1 \cdots N - 1$      (5.10.17)

$H\left( k \right) = \sum\limits_{n = 0}^{N - 1} h \left( n \right){{\rm{e}}^{ - j\frac{{2\pi }}{N}nk}}$

当$h(n)$为实数时，则$H\left( k \right) = {H^*}\left( {N - k} \right)$

由此得出

$\left| {H\left( k \right)} \right| = \left| {H\left( {N - k} \right)} \right|$      $k = \frac{{N + 1}}{2} \cdots N - 1$           (5.10.18)

$\theta \left( k \right) =  - \theta \left( {N - k} \right)$          (5.10.19)

也即$H(k)$的模$|H(k)|$以$k=(N/2)$为对称中心呈偶对称，$H(k)$的相角${\theta (k)}$以$k=(N/2)$为对称中心呈奇对称。再利用线性相位条件$\theta \left( \omega  \right) =  - \left[ {\left( {N - 1} \right)/2} \right]\omega $，即可得到

当$N$为奇数时得

$\theta \left( k \right) = \left\{ \begin{array}{l}\frac{{2\pi }}{N}k\left( {\frac{{N - 1}}{2}} \right)k = 0, \cdots \frac{{N - 1}}{2}\\
\frac{{2\pi }}{N}\left( {N - k} \right)\left( {\frac{{N - 1}}{2}} \right)k = \frac{{N + 1}}{2}, \ldots ,N - 1
\end{array} \right.$       (5.10.20)

当$N$为偶数时得



$\theta \left( k \right) = \left\{ \begin{array}{l}\frac{{2\pi }}{N}k\left( {\frac{{N - 1}}{2}} \right)k = 0,1 \cdots \left( {\frac{N}{2} - 1} \right)\\
\frac{{2\pi }}{N}\left( {N - k} \right)\left( {\frac{{N - 1}}{2}} \right)k = \left( {\frac{N}{2} + 1} \right) \cdots N - 1\\
0k = \frac{N}{2}
\end{array} \right.$      (5.10.21)

$H\left( {\frac{N}{2}} \right) = 0$          (5.10.22)

(5.10.22) 式说明单位脉冲响应的列长$N$为偶数时的线性相位滤波器，在$\omega  = \pi $处，$H\left( {{{\rm{e}}^{j\omega }}} \right) = 0$，这和前面讨论是一致的。

当$N$为奇数时，利用 (5.10.20) 式可将(5.10.17) 式写成

$H\left( k \right) = \left\{ \begin{array}{l}
\left| {H\left( k \right)} \right|{{\rm{e}}^{ - j\frac{{2\pi }}{N}k\frac{{N - 1}}{2}}}k = 0,1 \cdots \frac{{N - 1}}{2}\\
\left| {H\left( k \right)} \right|{{\rm{e}}^{2\pi }}{N^{\left( {N - k} \right)\frac{{N - 1}}{2}}}k = \frac{{N + 1}}{2} \cdots N - 1
\end{array} \right.$      (5.10.23)

将 (5.10.23) 式带入 (5.10.16) 式得

$H\left( {{{\rm{e}}^{j\omega }}} \right) = {{\rm{e}}^{ - j\omega \frac{{N - 1}}{2}}}\frac{{\sin \left( {\frac{{\omega N}}{2}} \right)}}{N}\left[ {\mathop \sum \limits_{k = 0}^{\frac{{N - 1}}{2}} \frac{{|H(k)|{{\rm{e}}^{ - {\rm{j}}\frac{{2\pi }}{N}k\frac{{N - 1}}{2}}}{{\rm{e}}^{ - j\frac{\pi }{N}k}}}}{{\sin \left( {\frac{\omega }{2} - \frac{\pi }{N}k} \right)}} + \mathop \sum \limits_{k = \frac{{N + 1}}{2}}^{N - 1} \frac{{|H(k)|{{\rm{e}}^{^{\rm{j}}}}^{\frac{{2\pi }}{N}(N - k)\left( {\frac{{N - 1}}{2}} \right)}{{\rm{e}}^{ - {\rm{j}}\frac{\pi }{N}k}}}}{{\sin \left( {\frac{\omega }{2} - \frac{\pi }{N}k} \right)}}} \right]$

$ = {{\rm{e}}^{ - j\omega \frac{{N - 1}}{2}}}\frac{{\sin \left( {\frac{{\omega N}}{2}} \right)}}{N}\left[ {\mathop \sum \limits_{k = 0}^{\frac{{N - 1}}{2}} \frac{{\left| {H\left( k \right)} \right|{{\rm{e}}^{ - jk\pi }}}}{{\sin \left( {\frac{\omega }{2} - \frac{\pi }{N}k} \right)}} + \mathop \sum \limits_{k = \frac{{N + 1}}{2}}^{N - 1} \frac{{\left| {H\left( k \right)} \right|{{\rm{e}}^{j\left( {N - 1 - k} \right)\pi }}}}{{\sin \left( {\frac{\omega }{2} - \frac{\pi }{N}k} \right)}}} \right]$

对上式方括弧内第二项，进行变量代换：$l = N - k$，并利用 (5.10.18) 式可得

$\sum\limits_{k = \frac{{N + 1}}{2}}^{N - 1} {\frac{{\left| {H\left( k \right){e^{j(N - 1 - k)\pi }}} \right|}}{{\sin \left( {\frac{\omega }{2} - \frac{\pi }{N}k} \right)}}}  = \sum\limits_{l = 1}^{\frac{{N - 1}}{2}} {\frac{{\left| {H\left( {N - l} \right)} \right|{e^{j\left( {l - 1} \right)\pi }}}}{{\sin \left[ {\frac{\omega }{2} - \frac{\pi }{N}\left( {N - l} \right)} \right]}}}  = \sum\limits_{l = 1}^{\frac{{N - 1}}{2}} {\frac{{\left| {H\left( l \right)} \right|{e^{jl\omega }}}}{{\sin \left[ {\frac{\omega }{2} + \frac{\pi }{N}l} \right]}}} $ 

故有

$H\left( {{{\rm{e}}^{j\omega }}} \right) = \frac{{{{\rm{e}}^{ - j\omega \frac{{N - 1}}{2}}}\sin \left( {\frac{{\omega N}}{2}} \right)}}{N}\left[ {\frac{{H\left( 0 \right)}}{{\sin \frac{\omega }{2}}} + \sum\limits_{k = 1}^{\frac{{N - 1}}{2}} {\frac{{\left| {H\left( k \right)} \right|{{\rm{e}}^{ - jk\pi }}}}{{\sin \left( {\frac{\omega }{2} - \frac{\pi }{N}k} \right)}} + \sum\limits_{k = 1}^{\frac{{N - 1}}{2}} {\frac{{\left| {H\left( k \right)} \right|{{\rm{e}}^{jk\pi }}}}{{\sin \left( {\frac{\omega }{2} + \frac{\pi }{N}k} \right)}}} } } \right]$

利用尤拉公式及三角恒等式，由上式可得

$H\left( {{{\rm{e}}^{j\omega }}} \right) = {{\rm{e}}^{ - j\omega \frac{{N - 1}}{2}}}\left\{ {\frac{{\left| {H\left( 0 \right)} \right|\sin \left( {\frac{{\omega N}}{2}} \right)}}{{N\sin \frac{\omega }{2}}} + \sum\limits_{k = 1}^{\frac{{N - 1}}{2}} {\frac{{\left| {H\left( k \right)} \right|}}{N}\left[ {\frac{{\sin \left[ {N\left( {\frac{\omega }{2} - \frac{\pi }{N}k} \right)} \right]}}{{\sin \left( {\frac{\omega }{2} - \frac{\pi }{N}k} \right)}} + \frac{{\sin \left[ {N\left( {\frac{\omega }{2} + \frac{\pi }{N}k} \right)} \right]}}{{\sin \left( {\frac{\omega }{2} + \frac{\pi }{N}k} \right)}}} \right]} } \right\}$      (5.10.24)

当$N$为偶数时，利用 (5.10.21) 式，(5.10.22) 式。则 (5.10.17) 式可写成

$H\left( k \right) = \left\{ {\begin{array}{*{20}{c}}
{\left| {H\left( k \right)} \right|{{\rm{e}}^{ - j\left( {\frac{{2\pi }}{N}} \right)k\left( {\frac{{N - 1}}{2}} \right)}}}&{}&{k = 0,1 \cdots \left( {\frac{N}{2} - 1} \right)}\\
0&{}&{k = \frac{N}{2}}\\
{\left| {H\left( k \right)} \right|{{\rm{e}}^{j\left( {\frac{{2\pi }}{N}} \right)\left( {N - k} \right)\left( {\frac{{N - 1}}{2}} \right)}}}&{}&{k = \left( {\frac{N}{2} + 1} \right) \cdots N - 1}
\end{array}} \right.$      (5.10.25)



经过类似于$N$为奇数时的推导，可得为$N$偶数的I型线性相位滤波器设计公式为

$H\left( {{{\rm{e}}^{j\omega }}} \right) = {e^{ - j\omega \frac{{N - 1}}{2}}}\left\{ {\frac{{\left| {H\left( 0 \right)} \right|\sin \left( {\frac{{\omega N}}{2}} \right)}}{{N\sin \frac{\omega }{2}}} + \sum\limits_{k = 1}^{\frac{{N - 1}}{2}} {\frac{{\left| {H\left( k \right)} \right|}}{N}\left[ {\frac{{\sin \left[ {N\left( {\frac{\omega }{2} - \frac{{\pi k}}{N}} \right)} \right]}}{{\sin \left( {\frac{\omega }{2} - \frac{{\pi k}}{N}} \right)}} + \frac{{\sin \left[ {N\left( {\frac{\omega }{2} + \frac{{\pi k}}{N}} \right)} \right]}}{{\sin \left( {\frac{\omega }{2} + \frac{{\pi k}}{N}} \right)}}} \right]} } \right\}$      (5.10.26)

2、线性相位的 Ⅱ 型频率采样

 Ⅱ 型的频率采样值

$\begin{array}{*{20}{c}}
{H\left( k \right) = {{\left. {{H_d}\left( z \right)} \right|}_{z = {{\rm{e}}^{j\frac{{2\pi }}{N}\left( {k + \frac{1}{2}} \right)}}}} = {{\left. {{H_d}\left( {{{\rm{e}}^{j\omega }}} \right)} \right|}_{\omega  = \frac{{2\pi \left( {k + \frac{1}{2}} \right)}}{N}}}}&{k = 0,1,2 \cdots N - 1}
\end{array}$        (5.10.27)

采样点频率是${f_k} = \left( {k + 1/2} \right)/N$。若频率采样点之间的角度是$\theta  = 1/N$，则 Ⅱ 型设计的起点在$f=\theta  /2$，即$z = {{\rm{e}}^{j\frac{\pi }{N}}}$。Ⅱ型采样亦可分$N$为偶数和奇数两种情況，如图5.10.3所示。

<img src=".\fig\5.10.3.png" style="zoom:80%;"/>



图5.10.3 $z$平面单位圆上按等分角度采样点的四种可能情况

 Ⅱ 型频率采样方式的重要性在于它使设计方法更加灵活。若给定的频带边界频率距 Ⅱ 型频率采样点比距I型的近，则把 Ⅱ 型的设计用于最优化处理。一旦得出了各型滤波器的实函数$H(\omega)$ [ (5.10.13)式]，两种设计都能用来获得滤波器系数。

由 (5.10.27) 式可以得到频率采样值$H(k)$同滤波器的单位采样响应$h(n)$的关系为

$/H\left( k \right) = \sum\limits_{n = 0}^{N - 1} {h\left( n \right){{\rm{e}}^{j\left( {\frac{{2\pi }}{N}} \right)n\left( {k + \frac{1}{2}} \right)}}}  = \sum\limits_{n = 0}^{N - 1} {\underbrace {h\left( n \right){{\rm{e}}^{j\frac{{2\pi }}{N}}}}_{g\left( n \right)}} {{\rm{e}}^{j\frac{{2\pi }}{N}kn}}$ 

上式表明$H(k)$是序列$g\left( n \right) = h\left( n \right){e^{ - j\left( {\frac{{n\pi }}{N}} \right)}}$的DFT，所以是$g(n)$$H(k)$的逆DFT，即

${\rm{g}}\left( n \right) = h\left( n \right){e^{ - j\left( {\frac{{n\pi }}{N}} \right)}} = \frac{1}{N}\sum\limits_{k = 0}^{N - 1} {H\left( k \right){{\rm{e}}^{j\frac{{2\pi }}{N}nk}}} $ 

或

$h\left( n \right) = \frac{1}{N}\sum\limits_{k = 0}^{N - 1} {H\left( k \right)} {e^{j\left( {\frac{{2\pi }}{N}} \right)n\left( {k + \frac{1}{2}} \right)}}$               (5.10.28)

对$h(n)$取Z变换，即得 Ⅱ 型设计的FIR滤波器的系统函数为

$\begin{array}{l}
H\left( z \right) = \sum\limits_{n = 0}^{N - 1} {h\left( n \right){z^{ - n}}}  = \sum\limits_{n = 0}^{N - 1} {\left[ {\frac{1}{N}\sum\limits_{k = 0}^{N - 1} {H\left( k \right){{\rm{e}}^{j\left( {\frac{{2\pi }}{N}} \right)n\left( {k + \frac{1}{2}} \right)}}} } \right]{z^{ - n}}} \\
{\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt}  = \sum\limits_{n = 0}^{N - 1} {\frac{{H\left( k \right)}}{N}\sum\limits_{k = 0}^{N - 1} {\left[ {{{\rm{e}}^{j\left( {\frac{{2\pi }}{N}} \right)n\left( {k + \frac{1}{2}} \right)}}{z^{ - n}}} \right]} } \\
{\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt}  = \sum\limits_{n = 0}^{N - 1} {\frac{{H\left( k \right)\left( {1 - {{\rm{e}}^{j2\pi \left( {k + \frac{1}{2}} \right)}}} \right){z^{ - N}}}}{{N\left( {1 - {{\rm{e}}^{j\frac{{2\pi }}{N}\left( {k + \frac{1}{2}} \right)}}{z^{ - 1}}} \right)}}} 
\end{array}$      (5.10.29)

在上式中令$z = {{\rm{e}}^{j\omega }}$，并简化之，即得 Ⅱ 型设计的FIR数字滤波器的频率响应

$H\left( {{{\rm{e}}^{j\omega }}} \right) = {{\rm{e}}^{ - j\omega \frac{{N - 1}}{2}}}\frac{{\cos \left( {\frac{{\omega N}}{2}} \right)}}{N}\left\{ {\sum\limits_{k = 0}^{N - 1} {\frac{{H\left( k \right){{\rm{e}}^{ - j\frac{\pi }{N}\left( {k + \frac{1}{2}} \right)}}}}{{j\sin \left[ {\frac{\omega }{2} - \frac{\pi }{N}\left( {k + \frac{1}{2}} \right)} \right]}}} } \right\}$            (5.10.30)

对于 Ⅱ 型设计，在线性相位滤波器的情况下，［有$(N-1)/2$个采样点的延迟］，按线性相位频率响应关系式，将频率采样表$H(k)$示成幅度响应及相$|H(k)|$位响应的${\theta (k)}$形式，即
$\begin{array}{*{20}{c}}
{H\left( k \right) = \left| {H\left( k \right)} \right|{e^{j\theta \left( k \right)}}}&{k = 0,1,2 \cdots N - 1}
\end{array}$

而

$H\left( k \right) = \sum\limits_{n = 0}^{N - 1} {h\left( n \right){e^{ - j\frac{{2\pi }}{N}\left( {k + 1/2} \right)n}}} $

当$h(n)$是实数时，满足

$H\left( k \right) = {H^ * }\left( {N - 1 - k} \right)$

也即

$\left| {H\left( k \right)} \right| = \left| {H\left( {N - 1 - k} \right)} \right|$ 

$\theta \left( k \right) =  - \theta \left( {N - 1 - k} \right)$

此时，$H(k)$的模$|H(k)|$以$k=(N-1)/2$为对称中心呈偶对称，$H(k)$的相角$\theta(k)以$$k=(N-1)/2$为对称中心呈奇对称。再利用线性相位条件$\theta (\omega)=-[(N-1)/2]\omega $即可得到：

当$N$为奇数时

$\theta \left( k \right) = \left\{ {\begin{array}{*{20}{c}}
{ - \frac{{2\pi }}{N}\left( {k + \frac{1}{2}} \right)\frac{{N - 1}}{2}}\\
0\\
{\frac{{2\pi }}{N}\left( {N - k - \frac{1}{2}} \right)\frac{{N - 1}}{2}}
\end{array}} \right.\begin{array}{*{20}{c}}
{}\\
{}\\
{}
\end{array}\begin{array}{*{20}{c}}
{k = 0,1 \cdots \frac{{N - 3}}{2}}\\
{k = \frac{{N - 1}}{2}}\\
{k = \frac{{N + 1}}{2} \cdots N - 1}
\end{array}$            (5.10.31)

$H\left( k \right) = \left\{ {\begin{array}{*{20}{c}}
{\left| {H\left( k \right)} \right|{{\rm{e}}^{ - j\frac{{2\pi }}{N}\left( {k + \frac{1}{2}} \right)\left( {\frac{{N - 1}}{2}} \right)}}}\\
{\left| {H\left( {\frac{{N - 1}}{2}} \right)} \right|}\\
{\left| {H\left( k \right)} \right|{{\rm{e}}^{j\frac{{2\pi }}{N}\left( {N - k - \frac{1}{2}} \right)\left( {\frac{{N - 1}}{2}} \right)}}}
\end{array}} \right.\begin{array}{*{20}{c}}
{}\\
{}\\
{}
\end{array}\begin{array}{*{20}{c}}
{k = 0,1 \cdots \frac{{N - 3}}{2}}\\
{k = \frac{{N - 1}}{2}}\\
{k = \frac{{N + 1}}{2} \cdots N - 1}
\end{array}$          (5.10.32)

因此

$\begin{array}{l}
H\left( {{{\rm{e}}^{j\omega }}} \right) = {e^{ - j\omega \frac{{N - 1}}{2}}}\left\{ {\frac{{\left| {H\left( {\frac{{N - 1}}{2}} \right)} \right|\cos \left( {\frac{{\omega N}}{2}} \right)}}{{N\cos \left( {\frac{\omega }{2}} \right)}}} \right.\\
{\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\rm{ + }}\left. {\sum\limits_{k = 0}^{\frac{{N - 3}}{2}} {\frac{{\left| {H\left( k \right)} \right|}}{N}\left[ {\frac{{\sin \left\{ {N\left[ {\frac{\omega }{2} - \frac{\pi }{N}\left( {k + \frac{1}{2}} \right)} \right]} \right\}}}{{\sin \left[ {\frac{\omega }{2} - \frac{\pi }{N}\left( {k + \frac{1}{2}} \right)} \right]}} + \frac{{\sin \left\{ {N\left[ {\frac{\omega }{2} + \frac{\pi }{N}\left( {k + \frac{1}{2}} \right)} \right]} \right\}}}{{\sin \left[ {\frac{\omega }{2} + \frac{\pi }{N}\left( {k + \frac{1}{2}} \right)} \right]}}} \right]} } \right\}
\end{array}$          (5.10.33)

当$N$为偶数时有

$\theta \left( k \right) = \left\{ {\begin{array}{*{20}{c}}
{ - \frac{{2\pi }}{N}\left( {k + \frac{1}{2}} \right)\frac{{N - 1}}{2}}&{k = 0,1 \cdots \frac{N}{2} - 1}\\
{\frac{{2\pi }}{N}\left( {N - k - \frac{1}{2}} \right)\frac{{N - 1}}{2}}&{k = \frac{N}{2} \cdots N - 1}
\end{array}} \right.$​      (5.10.34)

$H\left( k \right) = \left\{ {\begin{array}{*{20}{c}}
{\left| {H\left( k \right)} \right|{{\rm{e}}^{ - j\frac{{2\pi }}{N}\left( {k + \frac{1}{2}} \right)\left( {\frac{{N - 1}}{2}} \right)}}}&{k = 0,1 \cdots \frac{N}{2} - 1}\\
{\left| {H\left( k \right)} \right|{{\rm{e}}^{j\frac{{2\pi }}{N}\left( {N - k - \frac{1}{2}} \right)\left( {\frac{{N - 1}}{2}} \right)}}}&{k = \frac{N}{2} \cdots N - 1}
\end{array}} \right.$         (5.10.35)

因此
$H\left( {{{\rm{e}}^{j\omega }}} \right) = {e^{ - j\omega \frac{{N - 1}}{2}}}\left\{ {\sum\limits_{k = 0}^{\frac{N}{2} - 1} {\frac{{\left| {H\left( k \right)} \right|}}{N}\left[ {\frac{{\sin \left\{ {N\left[ {\frac{\omega }{2} - \frac{\pi }{N}\left( {k + \frac{1}{2}} \right)} \right]} \right\}}}{{\sin \left[ {\frac{\omega }{2} - \frac{\pi }{N}\left( {k + \frac{1}{2}} \right)} \right]}} + \frac{{\sin \left\{ {N\left[ {\frac{\omega }{2} + \frac{\pi }{N}\left( {k + \frac{1}{2}} \right)} \right]} \right\}}}{{\sin \left[ {\frac{\omega }{2} + \frac{\pi }{N}\left( {k + \frac{1}{2}} \right)} \right]}}} \right]} } \right\}$     (5.10.36)

(5.10.24)、(5.10.26)、(5.10.33)、(5.10.36)四式中的每一个都可在最优化设计线性相位 F1R数字滤波器中使用。到底$N$选偶数还是奇数，用I型还是 Ⅱ 型设计，这要由使用者选择，并且主要取决于待设计的滤波器。

**例** 设计一低通数字滤波器，其理想频率特性是矩形的

$\left| {{H_d}\left( {{{\rm{e}}^{j\omega }}} \right)} \right| = \left\{ {\begin{array}{*{20}{c}}
1&{0 \le \omega  \le {\omega _c}}\\
0&{}
\end{array}} \right.$         (5.10.37)  

并已知${\omega _{\rm{c}}} = 0.5\pi $，采样点数为奇数，$N=33$,要求滤波器具有线性相位特性。

图5.10.4(a)表示指标要求的矩形频率特性，并画出以$N=33$进行采样所得的$H(k)$序列 (用粗黑点表示)。理想低通滤波器特性曲线是对称于${\omega } = \pi $的，我们感兴趣的是$0 \le \omega  \le \pi $区间。$\pi \le \omega  \le 2\pi $即$17 \le k  \le 32 $的图形略去不画。截止频率${\omega _{\rm{c}}} = 0.5\pi $处在${\omega } = 16\pi /33$和$17\pi /33$之间。

<img src=".\fig\5.10.4(a).png" style="zoom:100%;"/>

(a) $H_d(e^{j\omega})$和$h(K)$,$N=33$ 

#### **例程**5.10.1

实现上例频率采样设计法

```matlab
N = 33; 

Wc = 0.5;

alpha = (N-1)/2; 

l = 0:N-1;

wl = (2*pi/N)*l;

kt = floor(N*Wc/2);

Hrs = [ones(1,kt+1),zeros(1,N-2*kt-1),ones(1,kt)];

Hdr = [1,1,0,0]; 

wdl = [0,Wc,Wc,1];

k1 = 0:floor((N-1)/2); 

k2 = floor((N-1)/2)+1:N-1;

angH = [-alpha*(2*pi)/N*k1, alpha*(2*pi)/N*(N-k2)];

H = Hrs.*exp(1i*angH);

h = real(ifft(H,N));

[db,mag,pha,grd,w] = freqz_m(h,1);

[Hr,ww,a,L] = hr_type1(h);

subplot(2,2,1); plot(wl(1:alpha+1)/pi,Hrs(1:alpha+1),'o',wdl,Hdr); 

subplot(2,2,2); stem(l,h); 

subplot(2,2,3); plot(ww/pi,Hr,wl(1:alpha+1)/pi,Hrs(1:alpha+1),'o');

subplot(2,2,4); plot(w/pi,db); 

 

function [db,mag,pha,grd,w] = freqz_m(b,a);

% Modified version of freqz subroutine

% ------------------------------------

% [db,mag,pha,grd,w] = freqz_m(b,a);

% db = Relative magnitude in dB computed over 0 to pi radians

% mag = absolute magnitude computed over 0 to pi radians 

% pha = Phase response in radians over 0 to pi radians

% grd = Group delay over 0 to pi radians

% w = 501 frequency samples between 0 to pi radians

% b = numerator polynomial of H(z) (for FIR: b=h)

% a = denominator polynomial of H(z) (for FIR: a=[1])

 

[H,w] = freqz(b,a,1000,'whole');

H = (H(1:1:501))'; w = (w(1:1:501))';

mag = abs(H);

db = 20*log10((mag+eps)/max(mag));

pha = angle(H);

grd = grpdelay(b,a,w);

 

function [Hr,w,a,L] = Hr_Type1(h);

% Computes Amplitude response Hr(w) of a Type-1 LP FIR filter

% [Hr,w,a,L] = Hr_Type1(h)

% Hr = Amplitude Response

% w = 500 frequencies between [0 pi] over which Hr is computed

% a = Type-1 LP filter coefficients

% L = Order of Hr

% h = Type-1 LP filter impulse response

 

M = length(h);

L = (M-1)/2;

a = [h(L+1) 2*h(L:-1:1)]; % 1x(L+1) row vector

n = [0:1:L]; % (L+1)x1 column vector

w = [0:1:500]'*2*pi/500;

Hr = cos(w*n)*a';
```

<img src=".\fig\5.10.4(b).png" style="zoom:100%;"/>

(b)设计结果

图5.10.4 频率采样法设计低通滤波器例图

 

<img src=".\fig\m5.10.1.png" style="zoom:100%;"/>

 

<img src=".\fig\m5.10.2.png" style="zoom:100%;"/>

 

```matlab
% 设定滤波器指标

ord = 32; % 滤波器的阶数

N = ord + 1; % 滤波器系数的数量，N = 33

Wc = 0.48; % 截止频率 (归一化频率)

% 设定频率采样点和对应的幅度响应

F = [0, Wc, Wc, 1]; % 频率向量

A = [1, 1, 0, 0]; % 幅度向量

% 设定插值点数和围绕重复频率点的点数

npt = fix((ord + 1)/2)+1; % 根据指标设置 fix((ord + 1)/2)+1

lap = 0; % 

% 设定窗函数为矩形窗

wind = boxcar(ord+1);

% 使用fir2函数设计滤波器

b = fir2(ord, F, A, npt, lap, wind);

% 可视化滤波器的频率响应

[H, w] = freqz(b, 1, 1024);

figure;

plot(w/pi, (abs(H)));

xlabel('Normalized Frequency (\times\pi rad/sample)');

ylabel('Magnitude');

title('Frequency Response of the Designed FIR Lowpass Filter');

legend('fir2 Designed');

grid on;

ylim([0 1.2]);

figure;

plot(w/pi, 20*log10(abs(H)));

xlabel('Normalized Frequency (\times\pi rad/sample)');

ylabel('Magnitude (dB)');

title('Frequency Response of the Designed FIR Lowpass Filter');

legend('fir2 Designed');

grid on;

ylim([-80 10]);
```

 

 

 

按I型频率采样方式设计，这时$N=33$

$\left| {H\left( k \right)} \right| = \left\{ {\begin{array}{*{20}{c}}
1&{0 \le {\rm{Int}}\left[ {\frac{{N{\omega _c}}}{{2\pi }}} \right] = \frac{{N - 1}}{4}}\\
0&{Int\left[ {\frac{{N{\omega _c}}}{{2\pi }}} \right] + 1 \le k \le \frac{{N - 1}}{2}}
\end{array}} \right.$

将这些具体数值代入 (5.10.24) 式，即有

$H\left( {{{\rm{e}}^{j\omega }}} \right) = {e^{ - j16\omega }}\left\{ {\frac{{\sin \left( {\frac{{33}}{2}\omega } \right)}}{{33\sin \frac{\omega }{2}}} + \sum\limits_{k = 1}^8 {\left[ {\frac{{\sin \left[ {33\left( {\frac{\omega }{2} - \frac{{k\pi }}{{33}}} \right)} \right]}}{{33\sin \left( {\frac{\omega }{2} - \frac{{k\pi }}{{33}}} \right)}} + \frac{{\sin \left[ {33\left( {\frac{\omega }{2} + \frac{{k\pi }}{{33}}} \right)} \right]}}{{33\sin \left( {\frac{\omega }{2} + \frac{{k\pi }}{{33}}} \right)}}} \right]} } \right\}$  

按此式计算的$20{\log _{10}}\left| {H\left( {{{\rm{e}}^{j\omega }}} \right)} \right|$的结果如图5.10.4(b) 所示，在阻带内的零采样点处衰减是无限的。由图可见在$ 16\pi /33$到$18\pi /33$之间有一个平滑的过渡区。但是最小的阻带衰减略小于
$20{\rm{dB}}$，对大多数应用场合来说，这种滤波器不能令人满意。

为改善滤波器频率特性，满足指标要求，如在设计原理中所述，可在通带和阻带间的交界处安排一个或几个不等于零也不等于1的采样值。本例在采样点$k=9$、处取$\left| {H\left( 9 \right)} \right| = 0.5$,而不为零，则得到如图5.10.5 所示的结果。这相当于把指标要求的频率响应曲线边缘处圆滑了一些，降低了矩形特性的要求。由图可见，这时过渡带加宽了一倍左石，最小阻带衰减也显著加地大了。这种做法是牺牲了过渡带指标要求，换取了阻带特性的改善。

#### **例程**5.10.11

实现上例频率采样设计法

滤波器设计中引入1个点的过渡带，Hrs(10) = 0.5，Hrs(25) = 0.5；

 

```matlab
N = 33; 

Wc = 0.5;

alpha = (N-1)/2; 

l = 0:N-1;

wl = (2*pi/N)*l;

kt = floor(N*Wc/2);

Hrs = [ones(1,kt+1),zeros(1,N-2*kt-1),ones(1,kt)];

 

% 引入1个点的过渡带

Hrs(10) = 0.5;

Hrs(25) = 0.5;

 

Hdr = [1,1,0.5,0,0]; 

wdl = [0,Wc,Wc+1/16.5,Wc+2/16.5,1];

 

k1 = 0:floor((N-1)/2); 

k2 = floor((N-1)/2)+1:N-1;

angH = [-alpha*(2*pi)/N*k1, alpha*(2*pi)/N*(N-k2)];

H = Hrs.*exp(1i*angH);

h = real(ifft(H,N));

 

[db,mag,pha,grd,w] = freqz_m(h,1);

[Hr,ww,a,L] = hr_type1(h);

 

subplot(2,2,1); plot(wl(1:alpha+1)/pi,Hrs(1:alpha+1),'o',wdl,Hdr); 

subplot(2,2,2); stem(l,h); 

subplot(2,2,3); plot(ww/pi,Hr,wl(1:alpha+1)/pi,Hrs(1:alpha+1),'o');

subplot(2,2,4); plot(w/pi,db); 

```

<img src=".\fig\5.10.5.png" style="zoom:100%;"/>

图5.10.5 增加1个点过渡带采样非零值及其影响 

 <img src=".\fig\m5.10.3.png" style="zoom:100%;"/>

<img src=".\fig\M5.10.4.png" style="zoom:50%;"/>



 

 

```matlab
% 设定滤波器指标

ord = 32; % 滤波器的阶数

N = ord + 1; % 滤波器系数的数量，N = 33

Wc = 0.48; % 截止频率 (归一化频率)

% 设定频率采样点和对应的幅度响应

F = [0, Wc, Wc, 1]; % 频率向量

A = [1, 1, 0, 0]; % 幅度向量

% 设定插值点数和围绕重复频率点的点数

npt = fix((ord + 1)/2)+1 +1; % 根据指标设置 fix((ord + 1)/2)+1

lap = 2; 

% 设定窗函数为矩形窗

wind = boxcar(ord+1);

% 使用fir2函数设计滤波器

b = fir2(ord, F, A, npt, lap, wind);

% 可视化滤波器的频率响应

[H, w] = freqz(b, 1, 1024);

figure;

plot(w/pi, (abs(H)));

xlabel('Normalized Frequency (\times\pi rad/sample)');

ylabel('Magnitude');

title('Frequency Response of the Designed FIR Lowpass Filter');

legend('fir2 Designed');

grid on;

ylim([0 1.2]);

figure;

plot(w/pi, 20*log10(abs(H)));

xlabel('Normalized Frequency (\times\pi rad/sample)');

ylabel('Magnitude (dB)');

title('Frequency Response of the Designed FIR Lowpass Filter');

legend('fir2 Designed');

grid on;

ylim([-80 10]);
```

 

 

如果还要得到进一步阻带衰减，可再添上第二个不等于1也不等于零的采样。若此时$N$保持不变，则使过渡区又加宽一倍，但得到了更大的阻带衰减。如果不允许增大过渡带宽，而又希望阻带衰减童的指标得到改善，则必须釆用既插进非零值$|H(k)|$，又增多采样点数$N$的办法。例如同样是${\omega _c} = 0.5\pi $的低通滤波器，以$N=65$进行采样，并在$k=17$，$k=18$处插进两个非零采样值
$\left| {H\left( {17} \right)} \right| = 0.5886$， $\left| {H\left( {18} \right)} \right| = 0.1065$ （它们非常接近于最优化解），则其结果如图5-72所示。由图可见，其过渡带带宽比$N=33$,只有一个过渡区的非零采样值的过渡带带宽要稍窄一些，而阻带的衰减却可达$60{\rm{dB}}$以上。然而$N$值增大，计算量必然增大，这就是改善滤波器性能时所付出的代价。

 

#### **例程**5.10.12

实现上例频率采样设计法

滤波器设计中引入2个点的过渡带，Hrs(10) = 0.7，Hrs(11) = 0.3，Hrs[24] = 0.3, Hrs[25] = 0.7；

```matlab
N = 33; 

Wc = 0.5;

alpha = (N-1)/2; 

l = 0:N-1;

wl = (2*pi/N)*l;

kt = floor(N*Wc/2);

Hrs = [ones(1,kt+1),zeros(1,N-2*kt-1),ones(1,kt)];

 

%引入2个点的过渡带

Hrs(10) = 0.7;

Hrs(11) = 0.3;

Hrs(24) = 0.3;

Hrs(25) = 0.7;

 

% Hdr = [1,1,0,0]; 

% wdl = [0,Wc,Wc,1];

Hdr = [1,1,0.7,0.3,0,0]; 

wdl = [0,Wc,Wc+1/16.5,Wc+2/16.5,Wc+3/16.5,1];

 

 

k1 = 0:floor((N-1)/2); 

k2 = floor((N-1)/2)+1:N-1;

angH = [-alpha*(2*pi)/N*k1, alpha*(2*pi)/N*(N-k2)];

H = Hrs.*exp(1i*angH);

h = real(ifft(H,N));

 

[db,mag,pha,grd,w] = freqz_m(h,1);

[Hr,ww,a,L] = hr_type1(h);

 

subplot(2,2,1); plot(wl(1:alpha+1)/pi,Hrs(1:alpha+1),'o',wdl,Hdr); 

subplot(2,2,2); stem(l,h); 

subplot(2,2,3); plot(ww/pi,Hr,wl(1:alpha+1)/pi,Hrs(1:alpha+1),'o');

subplot(2,2,4); plot(w/pi,db); 


```

<img src=".\fig\5.10.6.png" style="zoom:100%;"/>

图5.10.6 增加2个点过渡带采样非零值及其影响 

 

采用fir2函数设计

<img src=".\fig\m5.10.5.png" style="zoom:100%;"/>





 <img src=".\fig\m5.10.6.png" style="zoom:100%;"/>

 



图5.10.6 增加2个点过渡带采样非零值及其影响 

 

```matlab
% 设定滤波器指标

ord = 64; % 滤波器的阶数

N = ord + 1; % 滤波器系数的数量，N = 33

Wc = 0.5; % 截止频率 (归一化频率)

% 设定频率采样点和对应的幅度响应

F = [0, Wc, Wc, 1]; % 频率向量

A = [1, 1, 0, 0]; % 幅度向量

%F = [0, 0.5, 0.5, 1];

%A = [1, 1, 0, 0];

% 设定插值点数和围绕重复频率点的点数

npt = fix((ord + 1)/2)+1; % 根据指标设置 fix((ord + 1)/2)+1

lap = 3; % 由于使用矩形窗，lap的设置不会影响结果，但按照要求设置

% 设定窗函数为矩形窗

wind = boxcar(ord+1);

% 使用fir2函数设计滤波器

b = fir2(ord, F, A, npt, lap, wind);

% 可视化滤波器的频率响应

[H, w] = freqz(b, 1, 1024);

figure;

plot(w/pi, (abs(H)));

xlabel('Normalized Frequency (\times\pi rad/sample)');

ylabel('Magnitude');

title('Frequency Response of the Designed FIR Lowpass Filter');

legend('fir2 Designed');

ylim([0 1.2]);

grid on;

figure;

plot(w/pi, 20*log10(abs(H)));

xlabel('Normalized Frequency (\times\pi rad/sample)');

ylabel('Magnitude (dB)');

title('Frequency Response of the Designed FIR Lowpass Filter');

legend('fir2 Designed');

grid on;

ylim([-80 10]);
```

## 小结

本章主要介绍了IIR和FIR数字滤波器的结构以及各种设计方法，力求给出它们的全貌，但又有重点地给以足够深入的讨论，使读者通过学习后就会进行有关的数字滤波器设计。

IIR数字滤波器的主要结构有：直接型（包括直接型Ⅰ和直接型Ⅱ及转置型结构）；级联型；并联型。FIR数字滤波器的主要结构有：直接型；级联型；线性相位型；频率采样型；快速卷积型。

需要强调指出的是，对于一给定的输入输出关系可以用多种不同的数字网络来实现。在不考虑量化影响时，这些不同的实现结构是等效的，但在考虑量化影响时，这些不同的实现结构性能上就有差异。实现结构的不同将会影响系统的精度、误差、稳定性、经济性以及运算速度等，因此必须慎重对待。

为了研究IIR数字滤波器的设计方法，回顾了巴特沃斯、切比雪夫等模拟滤波器的有关知识，所介绍的IIR数字滤波器的设计方法可归纳如下：采用常用模拟低通滤波器进行IIR数字滤波器设计；采用脉冲响应不变变换法和双线性变换法从模拟滤波器设计数字滤波器；从模拟低通滤波器设计数字低通滤波器；IIR数字高通/带通/带阻滤波器的频率变换设计。

为了方便FIR数字滤波器的设计，首先谈到了线性相位FIR滤波器的频率响应特点及零点特性。所介绍的FIR数字滤波器的设计方法可归纳于下：FIR数字滤波器的窗函数设计法和频率采样设计法。