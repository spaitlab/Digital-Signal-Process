# **第1章** 数字信号处理概述

## **1.1** 引言

数字信号处理是一种通过数字信号芯片，将声音、图片、视频等模拟信号转化为数字信息的一个过程。在这一过程中，采用数字方式对模拟信号进行采样、滤波、变换等处理，最终转化为数字信号。20世纪50年代，采样数据系统研究的进展和离散系统理论的发展奠定了数字信号处理的数学基础。离散傅里叶变换（Discrete Fourier Transform，DFT），是傅里叶变换（Fourier Transform，FT）在时域和频域上都呈现离散的形式，将时域信号的采样变换为在离散时间傅里叶变换（Discrete Time Fourier Transform，DTFT）频域的采样。离散傅里叶变换是数字信号处理最重要的基石之一，也是对信号进行分析和处理时最常用的工具之一。1965年库利（James William Cooley, 缩写为J.W.Cooley）和图基（John Wilder Tukey，缩写为J.W.Tukey）首先提出离散傅里叶变换的快速算法，简称快速傅里叶变换（Fast Fourier Transform，FFT）。自有了快速算法以后，离散傅里叶变换的运算次数大为减少，使数字信号处理的实时实现成为可能。同一时期，应用计算机逼近和仿真模拟滤波器的数字滤波理论也得到发展。快速傅里叶变换和数字滤波理论形成了数字信号处理的两大支柱。大规模数字集成电路的出现，为数字信号处理的实现提供了有利的条件。因而，从上世纪60年代以来，逐渐形成了一门新的学科——数字信号处理。

本章介绍的内容是为了让读者对数字信号处理有一轮廓的概念，以增强学习本课程的目的性。



## **1.2** 信号

信号可定义为传载信息的函数，其自变量常取为时间，例如雷达的发射信号可表达为

$ {S_t}\left( t \right) = u\left( t \right){e^{j2\pi {f_0}t}} $(1.2.1)

式中：

$ u\left( t \right) $ ——发射波形的复调制信号；

$ {f_0} $ ——载频。

雷达的发射信号和通讯设备的发射信号不同，通讯的全部信息在发射信号内，而雷达的发射信号则毫无信息，它只是信息的运载工具，发射信号碰到目标后被反射为回波信号。

$ {s_r}\left( t \right) = u\left( {t - {\tau _r}} \right){e^{j{\kern 1pt} 2\pi {\kern 1pt} \left( {{f_0} - {f_d}} \right){\kern 1pt} {\kern 1pt} \left( {t - {\tau _r}} \right)}} $ (1.2.2)

式中：

$ {\tau _r} $​ ——时间延迟；

$ {f_d} $ ——多卜勒频移。

目标的全部信息就蕴藏在这个回波信号内。例如，由$  {\tau _r}  $可决定出目标的距离$ r $信息

$ r = \frac{{{\tau _r}C}}{2} $

由$  {f_d}  $可区分出是否为活动目标，并决定出目标的径向速度$ v $信息

$ v = \frac{{{f_d}\lambda }}{2}\ $

除了时间变量外，信号还可以是以空间坐标为变量的函数。例如图像信号是一个以时间变量和二元空间变量表示的一个亮度函数。信号常分为：

**模拟信号**   在连续时间范围内所定义的信号，信号的幅值可以取连续范围内任意数值，即时间连续，幅度也连续的信号。如图1.2.1(a)所示。

**连续时间信号**   在规定的连续时间内，信号的幅值可以是连续值也可以是离散值的信号。“连续时间信号”与“模拟信号”经常用来说明同一信号，可以互相通用。模拟信号可视为连续时间信号的一个特例。因为“模拟”与“模仿”容易混淆，所以一般以采用“连续时间信号”为宜，只有在与“数字”相提并论时，才用“模拟”这个名词。本书后面对模拟信号与连续时间信号概称连续时间信号。

**离散时间信号**   在一组离散的时间下表示信号数值的函数。因为最常遇到的离散时间信号是模拟信号在时间上以均匀（有时也以非均匀）间隔的采样，所以离散时间信号又称为采样信号或序列，如图1.2.1(a)所示。

**数字信号**   在时间上和幅度上都经过量化的信号。“量化”是利用一组数值来表示变量的过程。所谓“量化变量”实际上就是一组不同的数值。因此，数字信号可以用一序列的数来表示，如图1.2.1(b)，而每一个数又是由有限个数码来表示的。

“离散时间”与“数字”也经常用来说明同一信号。离散时间信号的一些理论也适用于数字信号。

<img src=".\fig\1.2.1.png" style="zoom: 33%;" />

​												 (a)                (b)  

图1.2.1 连续时间信号的采样与量化

(a)采样

(b)量化（当离散时间信号的幅度不同于量化电平时，以最接近的一个量化电平来近似。图中未用二进制数码表示）



## **1.3** 系统

为了信号的提取，必须进行信号处理，凡是反映信号处理因果关系的设备或运算都称为系统。信号处理系统可与信号按同样思路进行分类。	

**连续时间系统**   输入与输出皆为连续时间信号的系统。

**离散时间系统**   输入与输出皆为离散时间信号的系统。

**模拟系统**   输入与输出都是模拟信号的系统。

**数字系统**   输入与输出都是数字信号的系统。

本书主要研究数字（离散）信号和系统。



## 1.4 什么是数字信号处理

### 1.4.1 数字信号处理含义

数字信号处理是将信号以数字方式表示并处理的理论和技术。数字信号处理是对声音、图片、视频等信息处理完成后，重新转变成模拟信息输出。数字信号处理技术主要包括硬件、软件、理论等数字信号处理，探究和实现数字信号处理算法。处理就是变换。数字信号处理就是用数字的方法，对信号的波形进行变换。这通常是将一个信号变换成在某种意义上比原始信号更合乎要求的另一种信号形式。例如，我们可设计一些变换以分离两个或多个已经按某种方式合在一起的信号；也可增强一个信号的某一分量或参数；或者是估算信号的一个或几个参数。从某种观点来看，数字信号处理是多种计算机算法的汇集，因此可认为它是计算数学的另一分支。数学信号处理可分为一维和多维信号处理，本书只介绍一维数字信号处理。

### 1.4.2 数字信号处理过程

模拟信号的数字处理原理框图如图1.4.1所示。模拟信号$ {x_a}\left( t \right) $首先经预处理，滤除信号中的杂散分量后，经采样和模拟/数字(A/D)变换转换后成为数字信号，再进行数字信号处理，处理结果以数字信号形式输出，必要时也可以经过数字模拟(D/A)变换再转换为模拟信号，平滑滤波后输出。下面我们讨论采样定理和采样内插恢复。

<img src=".\fig\1.4.1.png" style="zoom:33%;" />

图 1.4.1 数字信号处理原理框图

模拟输入信号$  {x_a}\left( t \right)  $，如图1.4.2(a)，首先通过一连续时间的前置采样滤波器，以保证输入信号$  {x_a}\left( t \right)  $的最高频率限制在一定数值之内。然后在A/D转换器中每隔$ T $（采样周期）秒读出一次$   {x_a}\left( t \right)   $的幅度，并将其量化为标准电平。例如3.3V的采样值量化为3V，3.6V的采样值量化为4V。所得的量化采样信号如图1.4.2(b)所示。

<img src=".\fig\1.4.2.png" style="zoom:67%;" />

图1.4.2 数字信号处理过程流程图

(a)输入模拟信号波形 (b)采样量化信号 (c)数字数码

(d)输入信号序列 (e)输出信号序列 (f)输出模拟信号

其后，A/D转换器将保持电路中的采样信号电平进一步变换成数字。数字信号处理中常采用二进制数系，仅用0、1两个数值来表示所有可能的数。一个十进制数m可以用n个二进码(码位)来表示

$ m = {2^n} $ (1.4.1)

若m是所需的可能电平数，则所需的码位n等于或大于$ {\log _2}m $的最小正整数。由于数码长度总是有限的，因而这些数码所能代表的信号的幅度就有一定限制。例如图1.4.2(c)中所示的每个数字用三位二进码来表示时，则只能表达$ {2^3} = 8 $种不同的信号幅度。这些幅度称为量化电平。

信号的采样脉冲应该很窄，以便有更多的空余时间进行多路复用。采样脉冲表示为二进制数码时，代表二进制数的码位间隔应该很短，以便留有足够的空余时间为其它信号使用。

模拟信号的采样、量化以及转化为二进制的过程总称为模数转换（A/D转换）。当然量化越细，量化电平数越多，固然误差减小，但设备复杂成本变高。一般情况下，信号的动态范围应与A/D转换器相适应，所用位数应满足精确度的要求。采样和量化的处理，已早有A/D转换器集成电路单片问世，且性能越来越好。

A/D转换后的时间上与幅度上都量化了的信号称为数字信号。它本质上是一序列的“数”，为此，我们用$ x\left( n \right) $来表示数字信号序列，自变量n是一个整型变量，它表示这个数在序列中的次序，如图1.4.2(d)所示。图中用一根线段来表示$  x\left( n \right)  $数值的大小。

数字信号序列$  x\left( n \right)  $，按一定要求在数字处理器中进行加工。例如，希望滤掉信号中的所有不必要的频率成份，这在模拟处理的情况下，利用电感、电容和电阻组成满足一定传输特性的滤波器，就达到了滤波的要求。在数字处理的情况下，利用数字滤波器可以达到同样要求。数字滤波器利用数字相加、再乘以常数和延时将输入数列按既定要求转换成输出数列，达到处理的目的。数字处理器可以是通用计算机，微型计算机，或专用和通用信号处理器。

$  x\left( n \right)  $数字处理器加工以后，转换为另一组输出序列，见图1.4.2(e)，再在数/模（D/A）转换器中将数码反转成模拟电压或电流，如图1.4.2(f)所示，在转换时，二进制数首先转换为连续时间脉冲。脉冲间的空隙由所谓“再建滤波器”填充起来。这滤波器包括一保持电路。在两个采样值之间令输出保持上一个采样值，称之谓零阶保持法，其过程如图1.4.3所示。这种恢复方法除了在采样率远高于信号中最高频率外，通常带来较大误差。一个即不十分复杂，但又相当精确的恢复方法是所谓“一阶多角形保持”，也即“线性插值”。其意思是在两个采样值之间令输出为两个采样值的线性插值。一阶多角形保持法过程如图1.4.4所示。D/A转换器也早有现成的集成电路产品，并有高速高分辨率，输入与计算机兼容等优越性能。

最后还需要利用连续时间滤波器滤除模拟量中不需要的高频成份就得到系统输出的模拟信号$ {y_a}(t)\ $如图1.4.2(f)、图1.4.3(d)和图1.4.4(d)所示。

<img src=".\fig\1.4.3-4.png" style="zoom:50%;" />

​													图1.4.3 零阶保持法          图1.4.4 一阶多角形保持法

​											     		(a)输出序列$ y\left( n \right) $         (a)输出序列$  y\left( n \right)  $ 

​											  (b)二进制转换为连续时间脉冲      (b)二进制转换为连续时间脉冲

​												   (c)保持电路的输出信号         (c)保持电路的输出信号

​											(d)经连续时间滤波平滑后的波形     (d)经连续时间滤波平滑后的波形

 

实际的数字信号处理系统不一定都需要图1.4.1中的所有部分。有些系统就不需要最后的D/A转换，终端可直接以数字形式打印或显示。另有一些系统其输入量原本就是数字量，因此开始的A/D转换显然是不需要的。这种系统有时称为纯“数字系统”。



### 1.4.3 量化误差

由上所述，读者也许会问：对模拟信号进行采样，是否会把采样点间的信息丢失呢？在量化过程中，实际的信号幅值是用它最接近的标准电平代替的，因而在幅值上引入误差，这难道不会影响信号处理的质量吗？

关于采样问题，第2章中所述的采样定理将说明：如果信号的频带是有限的，而采样率又是大于或等于两倍的信号最高频率，则可根据它的离散采样值完全恢复出原始信号。

关于量化误差，可以这样来看。若测量得到模拟电压幅度为4.75V，用二进制表示，则可以 写成100 • 110。当表示数的位数有限时，例如只能用三位数表示时，则小数点后的数就表示不出来，从而出现误差。可以看出，位数越多，这种误差就越小。

令$ {E_{\max }} $和$ {E_{\min }} $​代表相邻量化电平之间的垂直距离，则有

$ q = \frac{{{E_{\max }} - {E_{\min }}}}{{{2^n}}} = \frac{{{E_{\max }} - {E_{\min }}}}{m} $  (1.4.2)

q称为量化宽度，表示一个量化单位，符号m和n的定义如前。当一个连续信号$ {x_a}\left( t \right) $加到量化器上时，输出将是阶梯形波，如图1.4.5所示。

<img src=".\fig\1.4.5.png" style="zoom:67%;" />

图1.4.5 量化及量化误差波形图

(a) 经连续时间输入信号及量化后的输出信号 (b)量化误差波形

这种由量化引起的误差叫做量化误差，记为e。在图1.4.5所示的情况下，它在$ - \frac{q}{2}$到$\frac{q}{2}$的范围内变化着。显然，量化误差e与量化宽度q及输入信号${x_a}\left( t \right)$​有关，可用下式表出

$ e\left[ {q{\kern 1pt} {\kern 1pt} {\kern 1pt} ;{\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {x_a}\left( t \right)} \right] = {x_a}\left( t \right) - {y_a}\left( t \right) $ (1.4.3)

综上所述可知：对模拟信号$ {x_a}\left( t \right) $进行数字式处理时，如果采样率足够高，并用足够多的码数（二进制数）来表示每一采样信号，使得量化误差足够小，因而可用一序列的离散二进制数表示连续时间信号并直接用数字线路进行处理。



## 1.5 数字信号处理系统的优点

由上所述，自然会产生这样的问题，这种包括有A/D转换、数字处理和D/A转换的复杂过程，虽能完成信号处理的作用，但是否经济，有无必要呢？回答是肯定的。这主要是因为数字信号处理具有下述明显的优点。

**精度高**：模拟网络中元件精度很难达到${10^{ - 3}}$以上，而数字系统17位字长就可达${10^{ - 3}}$精度。在一些高精密的系统中有时只有采用数字技术才可达到精度要求。如雷达技术中的脉冲压缩，要求主、副瓣之比达35dB或40dB，在理论上是可行的，但在采用模拟处理时，由于元件精度的限制，只能做到30dB左右。但采用数字脉压时，在$\tau  = 500\mu s$压缩比$D = {2^{10}} = 1024$，模数转换器用8位时，其主、副瓣之比可达40dB，且动态范围可达到60dB。

**灵活性大**：数字系统的性能主要决定于乘法器的各系数，而这些系数是存放在系数存储器中的。改变所存放的系数，就可得到不同的系统，比改变模拟系统的特性容易得多，这是模拟系统所不可比拟的。

可靠性强：因为数字系统只有两个信号电平1和0，受噪声及环境条件等影响小，不像模拟系统各参数都有一定的温度系数，易受环境条件，如温度、振动、电磁感应等影响。再者，数字系统多采用大规模集成电路，其故障率远比采用众多分立元件构成的模拟系统的故障率低。

易于大规模集成：因数字部件具有高度规范性，便于大规模集成，大规模生产，且数字电路主要工作在截止饱和状态，对电路参数要求不严格，因此产品的成品率高，价格日趋降低。特别在一些用模拟网络进行的低频信号的处理中，网络的电感和电容的数值大到惊人的程度，甚至不能很好地实现，这时采用数字滤波器，在体积、重量和性能方面，将特别显示出其优越性。

时分复用：数字系统的另一个最大优点就是时分复用，即可利用一套计算设备同时处理几个通道信号。从图1.4.2的采样信号可见，在信号的相邻采样点之间存在着相当长的空隙时间，在此时间内其它信号的采样值同样可送入到同一处理设备进行信号处理其原理如图1.5.1所示，同步系统控制各路信号按先后次序分别输入一序列值进入处理器，处理器算完一路结果再算第二路，在将各路信号第一个序列算完后，在同步系统控制下分別送给了各路的输出，再按先后次序计算各路输入信号的第二个序列，如此反复。因此，对于每一路信道来说，都好像单独占用着处理器一样。处理器运算的速度越高，它能同时处理的信道数也越多。

随着信号处理技术的高速发展，人们对信号处理实时性、准确性和灵活性的要求越来越高。数字信号处理在信号处理中的地位越来越重要。廉价、高集成度、快速超大规模集成电路 (VLSI)器件的产生使得各种复杂算法可用硬件实时实现。提高超大规模集成电路速度的方法——是从生产工艺上考虑，减小芯片线宽，进一步提高集成度；再则是从算法上研究适合于超大规模集成电路实现的高并行性算法和结构。

![](.\fig\1.5.1.png)

图1.5.1 时分复用系统

由于数字信号处理较之模拟信号处理有众多的优点和大规模集成技木的迅速发展，因而数字信号处理已在科学技术各个领域获得越来越广泛的应用。

 

## 1.6 数字信号处理的软件工具

MATLAB 是美国MathWorks公司出品的商业数学软件，用于算法开发、数据可视化、数据分析以及数值计算的高级技术计算语言和交互式环境，主要包括MATLAB和Simulink两大部分。MATLAB可以进行矩阵运算、绘制函数和数据、实现算法、创建用户界面、连接其他编程语言的程序等，主要应用于工程计算、控制设计、信号处理与通讯、图像处理、信号检测、金融建模设计与分析等领域。它将数值分析、矩阵计算、科学数据可视化以及非线性动态系统的建模和仿真等诸多强大功能集成在一个易于使用的视窗环境中，为科学研究、工程设计以及必须进行有效数值计算的众多科学领域提供了一种全面的解决方案。SIMULINK是MATLAB中的一种可视化仿真工具， 是一种基于MATLAB的框图设计环境，是实现动态系统建模、仿真和分析的一个软件包，被广泛应用于线性系统、非线性系统、数字控制及数字信号处理的建模和仿真中。Simulink提供一个动态系统建模、仿真和综合分析的集成环境。在该环境中，无需大量书写程序，而只需要通过简单直观的鼠标操作，就可构造出复杂的系统。

MATLAB系统主要包括五个部分：桌面工具和开发环境，数字函数库、语言、图形处理、外部接口。其中桌面工具包括MATLAB桌面和命令窗口、编辑器和调试器、代码分析器和浏览帮助、工作空间、文件的浏览器。MATLAB包括拥有数百个内部函数和三十几种工具箱，包含功能性工具箱和学科工具箱。功能工具箱用来扩充MATLAB的符号计算，可视化建模仿真，文字处理及实时控制等功能。学科工具箱是专业性比较强的工具箱，如控制工具箱，信号处理工具箱，通信工具箱等。开放性使MATLAB广受用户欢迎。除内部函数外，所有MATLAB各种工具箱都是可读可修改的文件，用户通过对源程序的修改或加入自己编写程序构造新的专用工具箱。

Signal Processing Toolbox提供了一些函数和App，用来分析、预处理及提取均匀和非均匀采样信号的特征。该工具箱包含可用于滤波器设计和分析、重采样、平滑处理、去趋势和功率谱估计的工具。该工具箱还提供了提取特征（如变化点和包络）、寻找波峰和信号模式、量化信号相似性以及执行 SNR 和失真等测量的功能。还可以对振动信号执行模态和阶次分析。使用信号分析器可以：在时域、频域和时频域同时预处理和分析多个信号，而无需编写代码；探查长信号；以及提取关注的区域。通过滤波器设计工具，可以从多种算法和响应中进行选择来设计和分析数字滤波器。这两个App都生成MATLAB代码。

DSP System Toolbox提供算法、应用程序和示波器，用于在MATLAB和Simulink中设计、仿真和分析信号处理系统。您可以为通信、雷达、音频、医疗设备、物联网和其他应用程序建模实时 DSP 系统。借助 DSP System Toolbox，可以设计和分析 FIR、IIR、多速率、多级和自适应滤波器。可以流式传输来自变量、数据文件和网络设备的信号，以进行系统开发和验证。时间范围、频谱分析仪和逻辑分析仪让您可以动态地可视化和测量流信号。对于桌面原型设计和嵌入式处理器（包括ARM Cortex架构）的部署，该工具箱支持 C/C++代码生成。它还支持从滤波器、FFT、IFFT 和其他算法中进行位精确的定点建模和 HDL 代码生成。算法可用作 MATLAB 函数、系统对象和 Simulink 模块。