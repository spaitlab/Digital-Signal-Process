# 第3章 离散傅里叶变换

## 3.1     引言

​        在第2章对序列的长度未加任何限制，既可是无限长序列又可是有限长序列。对于只能在$0 \le n \le N - 1$的有限范围内考虑的序列$x\left( n \right)$，我们特引入离散傅里叶变换（Discrete Fourier Transform，DFT），它本身也是有限长度序列，而不是连续函数。离散傅里叶变换不仅在理论上有重要意义，而且有快速计算的方法——快速傅里叶变换（Fast Fourier Transform，FFT）。因而离散傅里叶变换在各种实现数字信号处理的方法中起着重要作用。

​        本章主要讨论：傅里叶变换的四种形式；离散傅里叶级数（DFS）推导及主要性质； 离散傅里叶变换（DFT）变换的定义及性质；频率采样；用DFT对连续时间信号逼近的问题；加权技术与窗函数。

​        从理论上说，离散傅里叶变换是傅里叶变换的一种可能形式。为了更好的理解这点，并不致发生混淆，我们先研究傅里叶变换的各种可能形式。

## 3.2     傅里叶变换四种形式

​        所谓傅里叶变换就是在以时间为自变量的“信号”与频率为自变量的“频谱”函数之间的某种变换关系。这种变换同样可以应用于其它有关物理或数学的各种问题中，并可以采用其它形式的变量。当自变量“时间”或“频率”取连续形式和离散形式的不同组合，就可以形成各种不同的傅里叶变换对，有些变换对是我们以前已学习过的，为前后一致，因而采用和前面相同的符号。讨论中所绘出的虚拟函数图只是为了清楚地说明各种特性，并不代表任何实际的变换对。

### 3.2.1. 非周期连续时间信号的傅里叶变换

​        非周期连续时间信号${x_a}(t)$的傅里叶变换${X_a}(j\Omega )$可以表示为

${X_a}(j\Omega ) = \int_{ - \infty }^\infty  {{x_a}(t){e^{ - j\Omega t}}dt} $	     (3.2.1)

逆变换

${x_a}(t) = \frac{1}{{2\pi }}\int_{ - \infty }^\infty  {{X_a}(j\Omega ){e^{j\Omega t}}d\Omega } $	(3.2.2)

​         这是我们所熟悉的非周期性连续时间信号及其频谱间的变换对，其时间函数及其变换函数的形式如图3.2.1所示。可以看到：时域的连续函数造成频域的非周期谱，时域的非周期性造成频域的连续谱。结论是：一非周期连续时间函数对应于一非周期连续频率变换函数。

![3.2.1](.\fig\3.2.1.png)

图3.2.1 非周期连续时间函数及其傅里叶变换

(a)非周期连续时间函数${x_a}(t)$

(b)${x_a}(t)$的傅里叶变换-非周期连续频率函数${X_a}(j\Omega )$

### 3.2.2. 周期连续时间信号的傅里叶变换

​         周期为${t_p}$的周期性连续时间信号${x_a}(t)$的傅里叶变换是离散频率函数

$X(m\Omega ) = \frac{1}{{{t_p}}}\int_{ - \frac{{{t_p}}}{2}}^{\frac{{{t_p}}}{2}} {{x_a}(t){e^{ - jm\Omega t}}dt} $	(3.2.3)

逆变换

${x_a}(t) = \sum\limits_{m =  - \infty }^\infty  {X(m\Omega ){e^{jm\Omega t}}} $	         (3.2.4)

​         这是我们所熟悉的，经常称之为傅里叶级数的变换形式，(3.2.3)式所表示的积分是在${x_a}(t)$的一个周期内进行的。两相邻谱线分量之间的角频率增量与周期${t_p}$之间的关系可表示为

$Omega  = 2\pi \frac{1}{{{t_p}}} = 2\pi F$            $F = \frac{1}{{{t_p}}}$	(3.2.5)

(3.2.3) 式及(3.2.4) 式两函数的特性如图3.2.2所示。可以看到：时域的连续函数造成频域的非周期谱；频域函数的离散（采样）造成了时域函数的周期。结论是：一周期性的连续时间函数对应于一非周期性离散频率变换函数。

![img](.\fig\3.2.2.png)

图3.2.2 周期连续时间函数及其傅里叶变换

(a)周期连续时间函数${x_a}(t)$

(b)${x_a}(t)$的傅里叶变换-非周期离散频率函数$X(m\Omega )$

### 3.2.3. 非周期离散时间信号的傅里叶变换

​         这就是第2章讨论的序列及其频域表示的情况。已知其变换对为

$X({e^{jw}}) = \sum\limits_{n =  - \infty }^\infty  {x(n){e^{ - jwn}}} $		(3.2.6)

$x(n) = \frac{1}{{2\pi }}\int_{ - \pi }^\pi  {X({e^{jw}})} {e^{jwn}}dw$	   (3.2.7)

​         这里我们用数字域频率$w$来表示变换对，并且(3.2.7)式是在$X({e^{jw}})$的一个周期内求积分的。

采样频率${f_s}$与采样周期$T$的关系是

${f_s} = \frac{1}{T}$

​         采样的角频率为${\Omega _s} = \frac{{2\pi }}{T}$,而采样数字频率${w_s} = 2\pi$。

(3.2.6)式，(3.2.7)式两函数的特性示于图3.2.3。这变换对说明，时域的采样，对应于频域函数的周期延拓（其周期在数字域频率恰为$2\pi $）。而时域函数的非周期对应于频域函数的连续。

![img](.\fig\3.2.3.png)

图3.2.3 非周期离散时间信号及其傅里叶变换

(a)非周期离散时间信号$x(n)$

(b)$x(n)$的傅里叶变换-周期连续频率函数$X({e^{jw}})$

### 3.2.4. 周期离散时间信号的傅里叶变换

​         按照时间变量和频率变量是连续还是离散的不同组合，可以推断，必存在时间变量和频率变量都是离散的情况。我们知道，时域采样，结果得到频域的周期性函数。由于在非周期连续傅里叶变换中时间$t$及频率$f$是对称的，所以在一对傅里叶变换式中将$t$与$f$对调之后，计算关系同样成立。因此在频域采样，将使时域信号得到周期延拓（关于频率采样理论后面还要介绍）。这样，第四种傅里叶变换对实际上是周期的离散时间信号与周期的离散频率信号间的变换对，如图3.2.4所示。这就是我们将要分析的离散傅里叶级数变换。

![img](.\fig\3.2.4.png)

3.2.4 周期离散时间函数及其傅里叶变换

(a)周期离散时间信号$x\ (n)$

(b)$x\ (n)$的傅里叶变换-周期离散频率函数$X\ (k)$

​         总结以上四种傅里叶变换对的形式，可得如下结论：假若一个函数在一个域内（时间域或频率域）是周期性的，则相应的在另一域中的变换式必是采样的形式，即离散变量的函数。反之，如果在一个域中的函数是采样的，则在另一个域中必是周期性函数。在一个域中函数的周期必是另一域中两采样点间增量的倒数。

## 3.3     离散傅里叶级数

​       为了更好地理解离散傅里叶变换的概念，作为一种过渡，我们先简要地研究一下离散傅里叶级数（简称DFS）。

### 3.3.1. 非周期连续时间信号的傅里叶变换

​        当用数字计算机对信号进行频谱分析时，要求信号必须以离散值作为输入，而计算机输出所得的频谱值，自然也是离散的。因此在上节介绍的傅里叶变换的可能形式中，只有第四种形式对于数字信号处理有实用价值。前三种形式中或者信号是时间的连续函数，或者频谱是频率的连续函数，或者信号及频谱二者都是变量的连续函数，因此都不适合数字计算机进行计算。要使前三种形式能用数字计算机进行计算，必须针对每一形式的具体情况，或者在时域与频域上同时采样，或者在时域上采样，或者在频域上采样。信号在时域上采样导致频率的周期函数，而在频域上采样导致时域的周期函数，最后都将使原时间函数和频率函数二者都成为周期离散的函数，即由于采样的结果，前三种形式最后都能变为第四种形式——离散傅里叶级数形式。现在以第三种傅里叶级数形式（见图3.2.3）为例来推导离散傅里叶级数变换。

​        为更清楚地表示(3.2.6)式所示的第三种形式傅里叶变换的周期性，我们在$X({e^{jw}})$上加以表示周期性的上标“~”，井重写如下

$X\ ({e^{jw}}) = \sum\limits_{n =  - \infty }^\infty  {x(n){e^{ - jwn}}} $		(3.3.1)

设$x\ (n)$的列长为$N$,则上式可写为

$X\ ({e^{jw}}) = \sum\limits_{n = 0}^{N - 1} {x(n){e^{ - jwn}}} $

​        在对$X({e^{jw}})$采样，使其成为周期性离散频率函数，并导致时域序列$x(n)$周期化为$x\ (n)$，如图3.2.4所示。图中时域采样间隔为$T$，在一个周期内采样点数为$N$。

​        由3.2节分析可知，在自变量为$t$及$f$的情况下,在一个域中对函数进行采样，两采样点间增量的倒数，必是另一个域中函数的周期。现序列的周期为，所$NT$以对频谱采样的谱间距是$\frac{1}{{NT}}$。以数字频率表示时，则谱间距是

${w_I} = \frac{{2\pi }}{N}$		(3.3.2)

因此，上述以数字频率$w$为变量的$ X({e^{jw}})$被离散化时，其变量则成$w$为

$w = k{w_I} = \frac{{2\pi }}{N}k$	$k = 0,1,{\rm{L}} $  ${\rm{L}}$  ${\rm{N - 1}}$		(3.3.3)

所以离散周期序列$x\ (n)$的傅里叶级数可写成

$X\ (k) = X\ ({e^{jw}}){|_{w = \frac{{2\pi }}{N}k}} = \sum\limits_{n = 0}^{N - 1} {x\ (n){e^{ - j\frac{{2\pi }}{N}kn}}} $          $k = 0,1,{\rm{L}} $  ${\rm{L}}$  ${\rm{N - 1}}$         (3.3.4)

并将数字域频率简化为以$k$表示。上面两公式中，$k$为整数，而且由于$X\ ({e^{jw}})$的周期是$2\pi $，所以$k$只有0至$N - 1$个值。这就是说，$X\ (k)$只有$N$个不同的值，$X\ (k)$与$x\ (n)$都是以$N$个采样值为一个周期的周期性函数。这一点由公式中粗看起来并不明显，事实上(3.3.4)式只能计算出$N$个独立的复数值。我们设$k = r$，其中$r$是任意整数，则由(3.3.4)式有

$X\ (r) = \sum\limits_{n = 0}^{N - 1} {x\ (n){e^{ - j\frac{{2\pi }}{N}rn}}} $ 

又设,$k = r + N$，注意到

${e^{ - j2\pi n(r + N)/N}} = {e^{ - j2\pi nr/N}}{e^{ - j2\pi n}} = {e^{ - j\frac{{2\pi nr}}{N}}}$

故有

$X\ (r + N) = \sum\limits_{n = 0}^{N - 1} {x\ (n){e^{ - j\frac{{2\pi }}{N}nr}} = X\ (r)} $

因此(3.3.4)式的$X\ (k)$是以$N$个采样值为一个周期的周期性函数。

​        现在求离散傅里叶级数的逆变换，即从$X\ (k)$求$x\ (n)$。将正变换(3.3.4)式两边同乘以${e^{j\frac{{2\pi }}{N}kr}}$，并对一个周期求和，即

$\begin{array}{l}
\sum\limits_{k = 0}^{N - 1} {X\ (k){e^{j\frac{{2\pi }}{N}kr}} = \sum\limits_{k = 0}^{N - 1} {(\sum\limits_{k = 0}^{N - 1} {x\ (n){e^{ - j2\pi kn/N}}} ) \cdot {e^{j\frac{{2\pi }}{N}kr}}} } \\
 = N[\sum\limits_{n = 0}^{N - 1} {x\ (n)(\frac{1}{N}\sum\limits_{k = 0}^{N - 1} {{e^{j\frac{{2\pi }}{N}kr(r - n)}}} )} ]
\end{array}$

​        根据正交定理

$\frac{1}{N}\sum\limits_{k = 0}^{N - 1} {{e^{j\frac{{2\pi }}{N}k(r - n)}}}  = \{ _{0{\rm{   }}r \ne n}^{1{\rm{   }}r = n}$		(3.3.5)

则得

 $\sum\limits_{k = 0}^{N - 1} {X\ (k){e^{j\frac{{2\pi }}{N}kr}} = N[\sum\limits_{n = 0}^{N - 1} {x\ (n)} ]} {|_{n = r}} = Nx\ (r)$

以$n$置换$r$得

$x\ (n) = \frac{1}{N}\sum\limits_{k = 0}^{N - 1} {X\ (k){e^{j\frac{{2\pi }}{N}kn}}} $		(3.3.6)

​        和(3.3.4)式一样，(3.3.6)式所表达的也应该是一个以$N$为周期的周期序列

  $\begin{array}{l}
x\ (n + mN) = \frac{1}{N}\sum\limits_{k = 0}^{N - 1} {X\ (k){e^{j\frac{{2\pi }}{N}(n + mN)k}}} \\
 = \frac{1}{N}\sum\limits_{k = 0}^{N - 1} {X\ (k){e^{j\frac{{2\pi }}{N}kn}}} \\
 = x\ (n)
\end{array}$

​        综上所述，离散周期序列的傅里叶级数变换对可表达为

$X\ (k) = {\rm{DFS}}[x\ (n)] = \sum\limits_{n = 0}^{N - 1} {x\ (n){e^{ - j(\frac{{2\pi }}{N})kn}}} $		(3.3.7)

$x\ (n) = {\rm{IDFS}}[X\ (k)] = \frac{1}{N}\sum\limits_{k = 0}^{N - 1} {X\ (k){e^{j(\frac{{2\pi }}{N})nk}}} $	   (3.3.8)

​        其中DFS[ · ]表示离散傅里叶级数正变换，IDFS[ · ]表示离散傅里叶级数逆变换。有时为了方便，令

${W_N} = {e^{ - j\frac{{2\pi }}{N}}}$		(3.3.9)

​        并称之为${W_N}$因子，则(3.3.7)式，(3.3.8)式可表达为

 $X\ (k) = {\rm{DFS}}[x\ (n)] = \sum\limits_{n = 0}^{N - 1} {x\ (n)W_N^{kn}} $		(3.3.10)

$x\ (n) = {\rm{IDFS}}[X\ (k)] = \frac{1}{N}\sum\limits_{k = 0}^{N - 1} {X\ (k)W_N^{ - kn}} $	(3.3.11)

### 3.3.2. 傅里叶级数的主要性质

​        离散傅里叶级数的某些性质对其成功地应用于信号处理问题是极其重要的。下面扼要地介绍一下这些重要性质。

**        1．****线性特性**

​        若有周期皆等于$N$的两个离散周期序列${x_1}\ (n)$和${x_2}\ (n)$线性组合成一个新的周期序列${x_3}\ (n)$

${x_3}\ (n) = a{x_1}\ (n) + b{x_2}\ (n)$		(3.3.12)

则

${x_3}\ (k) = {\rm{DFS[}}a{x_1}\ (n) + b{x_2}\ (n){\rm{] = }}a{X_1}\ (k) + b{X_2}\ (k)$	(3.3.13)

式中$a$,$b$为任意常数。线性特性可根据DFS的定义证明。

​        由于是线性组合，所以${x_3}\ (n)$的周期长度不变，仍为$N$。${x_3}\ (k)$也是周期为N的离散周期序列。

 

2．序列移位

​        1)    时域移位

​        周期序列$x\ (n)$左移$m$位后，得$x\ (n + m)$，则

${\rm{DFS[x\ (n + m)] = W}}_N^{ - mk}X\ (k)$		(3.3.14)

证：

$\begin{array}{l}
{\rm{DFS[x\ (n + m)] = }}\sum\limits_{n = 0}^{N - 1} {{\rm{x\ (n + m)}}W_N^{nk}} \\
 = \sum\limits_{i = m}^{N - 1 + m} {x\ (i)W_N^{ki}W_N^{ - mk}} \\
 = W_N^{ - mk}\sum\limits_{i = m}^{N - 1 + m} {x\ (i)W_N^{ki}} 
\end{array}$  	换元$i = n + m$

由于$x\ (i)$及$W_N^{ki}$都是以$N$为周期的周期函数，因此对$i$求和时，下限从$m$至上限$N-1+m$与由0至$N-1$是相同的。因此

$\sum\limits_{i = m}^{N - 1 + m} {x\ (i)W_N^{ki}}  = \sum\limits_{i = 0}^{N - 1} {x\ (i)} W_N^{ki} = X\ (k)$

​        所以                   

${\rm{DFS[}}x\ (n + m)] = W_N^{ - mk}X\ (k)$  

​        显然，大于周期的任何移位（也即$m \ge N$)）和短于周期的移位在时域上不能区分。

 

​        2)    频域移位

​        当将$ X\ (k)$左移$l$时，得$X\ (k + l)$，则

${\rm{IDFS[}}X\ (k + l){\rm{] = W}}_N^{nl}x\ (n)$		(3.3.15)

可用与上面类似的方法证明(3.3.15)式。

 

3.周期卷积特性

​        1)     时域卷积

​        若${x_1}\ (n)$和${x_ 2}\ (n)$是周期为$N$的两个周期序列，并分别具有离散傅里叶级数${X_1}\ (k)$和${X_2}\ (k)$，则傅里叶级数${X_3}\ (k) = {X_1}\ (k) \cdot {X_2}\ (k)$所对应的序列${x_ 3}\ (n)$为

${x_3}\ (n) = \sum\limits_{m = 0}^{N - 1} {{x_1}\ (m)} {x_2}\ (n - m) = \sum\limits_{m = 0}^{N - 1} {{x_2}\ (m)} {x_2}\ (n - m)$		(3.3.16)

**证：**

$\begin{array}{l}
{x_3}\ (n) = {\rm{IDFS[}}{X_3}{\rm{\ (k)] = IDFS}}[{X_1}{\rm{\ (k)}} \cdot {X_2}{\rm{\ (k)}}]\\
 = \frac{1}{N}\sum\limits_{k = 0}^{N - 1} {{X_1}\ (k){X_2}\ (k)} W_N^{ - nk}
\end{array}$  

代入 

${X_1}\ (k) = \sum\limits_{m = 0}^{N - 1} {{x_1}\ (m)W_N^{mk}} $

则

$\begin{array}{l}
{x_3}\ (n) = \frac{1}{N}\sum\limits_{k = 0}^{N - 1} {\sum\limits_{m = 0}^{N - 1} {{x_1}\ (m){X_2}\ (k)W_N^{ - (n - m)k}} } \\
 = \sum\limits_{m = 0}^{N - 1} {{x_1}\ (m)[\frac{1}{N}\sum\limits_{k = 0}^{N - 1} {{X_2}\ (k)W_N^{ - (n - m)k}} ]} \\
 = \sum\limits_{m = 0}^{N - 1} {{x_1}\ (m)} {x_2}\ (n - m)
\end{array}$ 

只要将${x_1}\ (m)$、${x_2}\ (n-m)$简单换元，我们就可证明

${x_3}\ (n) = \sum\limits_{m = 0}^{N - 1} {{x_2}\ (m){x_1}\ (n - m)} $		(3.3.17)

​        (3.3.16)式，(3.3.17)式是一个卷积公式，但不同于前面讨论过的线性卷积，二者的差别在于这里的卷积过程只限于一个周期以内，表现在(3.3.16)式及(3.3.17)式中$m$取值由0到$N- 1$，所以称为周期卷积。

​        图3.3.1示出了两个周期为*N*=7的序列${x_1}\ (n)$,${x_ 2}\ (n)$进行周期卷积的过程：

(1)   先在哑元座标$m$上作${x_1}\ ( m)$,${x_2}\ ( m)$(中未画出)；

(2)   将${x_2}\ ( m)$以$m=0$的垂直轴为轴作一反卷得，${x_2}\ (-m)$并进行移位，例如图3.3.1(*d*)、(*e*)、(*f*)所示的对应于$n=0,1,2$时的${x_2}\  (n-m)$；

(3)   在一个周期内将${x_2}\  (n-m)$与${x_1}\ ( m)$对应点逐点相乘后求和，就得到相应于$n=0,1,2$时的${x_3}\ ( n)$，继续下去就得到了整个周期内的全部${x_3}\ ( n)$。

由于${x_1}\ ( n)$，${x_2}\ ( n)$都是周期为$N$的周期序列，因此${x_3}\ ( n)$也是周期为$N$的周期序列。

![img](.\fig.\3.3.1.png)

图3.3.1周期卷积

​        2)     频域卷积

​        对于周期序列的乘积，存在着频域的周期卷积。若

${x_3}\ (n) = {x_1}\ (n){x_2}\ (n)$

则 

$\begin{array}{l}
{X_3}\ (k) = {\rm{DFS[}}{x_3}\ (n)]\\
 = \frac{1}{N}\sum\limits_{l = 0}^{N - 1} {{X_1}\ (l)} {X_2}\ (k - l)\\
 = \frac{1}{N}\sum\limits_{l = 0}^{N - 1} {{X_2}\ (l)} {X_1}\ (k - l)
\end{array}$			(3.3.18)

根据DFS与IDFS变换的对称性不难证明上式。

​        此外，同第2章所讨论的序列的傅里叶变换的对称特性一样，周期序列的傅里叶级数也具有类似的对称特性，此处不再赘述，将在习题中给出，请读者自证。

## 3.4     离散傅里叶变换的定义

### 3.4.1. DFT只有$N$个独立的复值

​        离散傅里叶级数变换是周期序列，仍不便于计算机计算。但离散傅里叶级数虽是周期序列却只有$N$个独立的复值，只要知道它的一个周期的内容，其它的内容也就知道了。(3.3.10) 式表明只要把一个周期内的$x\ (n)$乘以对应的$W_N^{nk}$［这里的$n$在内取值，$(0 \sim N - 1)$而$k$可在$( - \infty  \sim \infty )$内取值］，可得任意下$k$的$X\ (k)$。(3.3.11)式表明，仅用$X\ (k)$的一个周期的值［$k$只取$(0:N - 1)$区间内的值］，就可得任意$n$[$n$可在$( - \infty  \sim \infty )$区间内取值］下的$x\ (n)$。如果同时限制(3.3.10)式中的$k$和(3.3.11)式中的$n$都只在区间$[0,N - 1]$内取值，就得到了一个周期的$x(n)$和一个周期的$X(k)$间的对应关系：

$X(k) = DFT[x(n)] = \sum\limits_{n = 0}^{N - 1} {x(n)W_N^{kn}} $          $0 \le k \le N - 1$	(3.4.1)

 $x(n) = IDFT[X(k)] = \frac{1}{N}\sum\limits_{k = 0}^{N - 1} {X(k)W_N^{ - kn}} $      $0 \le n \le N - 1$	(3.4.2)

​        上两式即称为有限长序列的离散傅里叶变换对。(3.4.1) 式称为离散傅里叶变换，简称DFT。(3.4.2) 式称为离散傅里叶逆变换，简称为IDFT。

### 3.4.2. DFT隐含周期性

​        若长度为$N$的有限长序列$x( n)$是由对连续时间函数$x(t)$采样得来的，则频域上已经意味着以${\Omega _s} = \frac{{2\pi }}{T}$(或$\omega  = 2\pi $)为周期作周期延拓。现再对频域作一次采样，则时间序列$x ( n)$按周期$N$延拓成为一周期性时间序列$x\ (n)$。因此，利用DFT对有限列长$N$的时间序列展幵，相当于对此序列作周期性处理。离散傅里叶变换对(3.4.1)式及(3.4.2)式，表面上看去为非周期性的，但一定要想到它们隐含周期性。

### 3.4.3. 周期序列与有限长序列的本质联系

​        周期序列与有限长序列有着本质的联系。周期序列$x\ (n)$可看作是以长度为$N$的有限长序列$x (n)$周期延拓而成，而$x (n)$是它的一个周期，即

$x\ (n) = \sum\limits_{r =  - \infty }^\infty  {x(n + rN)} $		(3.4.3)

$x(n) = \{ _{0{\rm{            else }}     n}^{x\ (n){\rm{   }}0 \le n \le N - 1}$			(3.4.4)

其关系如图3.4.1所示，我们定义周期序列$x\ (n)$的$n=0$到$N-1$的第一个周期为$x\ (n)$周期的“主值区间”。因此$x ( n )$与$x\ (n)$的关系可以说成是 

​        $x\ (n)$是$x(  n)$的周期延拓， 

​        $x (  n)$是$x\ (n)$的“主值序列”(即主值区间上的序列)

​        为了以后叙述方便，将(3.4.3)式及(3.4.4)式 表达为下面形式
$x\ (n) = x{((n))_N}$		(3.4.5)

$x(n) = x\ (n){R_N}(n)$	  (3.4.6)

![img](.\fig\3.4.1.png)

图3.4.1有限长序列及其周期延拓

式中${R_N}(n)$是矩形序列，$x{((n))_N}$表示以$N$为周期的周期序列，可说明如下：

​        ${((n))_N}$是余数运算表达式，它表示将$n$除以$N$可得一整数商值$m$及余数$n_1$，显然$n_1$值的范围是$0 \le n_1 \le N - 1$内的整数，这个$n _1$为余式 ${((n))_N}$的解，即

$n = mN + {n_1}$	$0 \le n_1 \le N - 1$,$m$为整数

${((n))_N} = {n_1}$	$x{((n))_N} = x({n_1})$		(3.4.7)

显然$x\ (n) = x\ (mN + {n_1}) = x\ ({n_1})$，$x\ ({n_1})$是主值区间的序列值，故有$x\ ({n_1}) = x({n_1})$，因此

$x\ (n) = x{((n))_N} = x({n_1})$

​        **例** 求周期$N=8$的序列$x\ (n)$的$n=18$及$n=-4$时的序列值。用余数运算得 

$n = 18 = 2 \times 8 + 2$		${((18))_8} = 2$，所以$x\ (18) = x(2)$

$n =  - 4 = ( - 1) \times 8 + 4$	${((-4))_8} = 4$，所以$x\ ( - 4) = x(4)$

${((n))_N}$也简称为“取余数”或“取模值”。

​        周期序列$x\ (n)$的离散傅里叶级数$ X\ (k)$也是一个周期序列，因而也给它定义一主值区间$0 \le  k \le N - 1$，以及主值序列$X( k)$。从而$  X\ (k)$是$X ( k)$的周期延拓，$X ( k)$是$  X\ (k)$的主值序列，即

$X(k) = X\ (k){R_N}(k)$		(3.4.8)

 $X\ (k) = X{((k))_N}$		     (3.4.9)

### 3.4.4. DFT是连续傅里叶变换的近似且便于计算机计算

​        离散傅里叶变换可以看成是连续函数在时域、频域采样构成的变换。只要取出$x\ (n)$的一个周期，乘以相应的内插函数就可恢复原连续函数。由以后分析可知，对频域也可取出$ X\ (k)$的一个周期，乘以相应的内插函数,就可恢复原连续的频率函数。DFT变换对可唯一地确定$ X\ (k)$的一个周期$ X(k)$及$x\ (n)$的一个周期$x(n)$。$x(n)$及$X(k)$都是长度为$N$的序列，都有$N$个独立复值，因而具有的信息是等量的，给它们乘以相应的内插函数后，复原的连续函数也就完全确定了，因而离散傅里叶变换可以看作连续傅里叶变换的近似。$x(n)$及$ X(k)$都是有限长序列，便于用数字计算机计算，这样对连续函数的处理就可代之以离散采样的处理。这就是为什么要采用离散傅里叶变换的原因。

## 3.5 离散傅里叶变换的性质

在下面的讨论中，假定${x_1}\left( n \right)$与${x_2}\left( n \right)$都是列长为$N$​的有限长序列，它们的离散傅里叶变换分別为

${X_1}\left( k \right) = {\rm{DFT}}\left[ {{x_1}\left( n \right)} \right]$

${X_2}\left( k \right) = {\mathop{\rm DFT}\nolimits} \left[ {{x_2}\left( n \right)} \right]$

### 3.5.1 线性性质

若两个有限长序列${x_1}\left( n \right)$和${x_2}\left( n \right)$​​的线性组合为

${x_3}\left( n \right) = a{x_1}\left( n \right) + b{x_2}\left( n \right)$  (3.5.1)  

则${x_3}\left( n \right)$的离散傅里叶变换为${X_1}\left( k \right)$与${X_2}\left( k \right)$​的线性组合

$\begin{array}{l}
{X_3}\left( k \right) = {\mathop{\rm DFT}\nolimits} \left[ {a{x_1}\left( n \right) + b{x_2}\left( n \right)} \right]\\
{\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt}  = a{\mathop{\rm DFT}\nolimits} \left[ {{x_1}\left( n \right)} \right] + b{\mathop{\rm DFT}\nolimits} \left[ {{x_2}\left( n \right)} \right]\\
{\rm{            = }}a{X_1}(k) + b{X_2}(k)
\end{array}$  (3.5.2)  

式中$a$、$b$​为任意常数。

注意，如果${x_1}\left( n \right)$列长为${N_1}$，${x_2}\left( n \right)$列长为${N_2}$，则${x_3}\left( n \right)$的最大列长为${N_3} = \max \left[ {{N_1},{N_2}} \right]$。因而，离散傅里叶变换${X_3}\left( k \right)$必须按$N = {N_3}$计算。例如，若${N_1} < {N_2}$，则${X_1}\left( k \right)$就是序列${x_1}\left( n \right)$增补${N_2} - {N_1}$个零点后的离散傅里叶变换。



### 3.5.2 离散傅里叶逆变换的另一公式

(3.4.2) 式给出的离散傅里叶逆变换形式与正变换不同之处在于${W_N}$因子用负指数，且有一比例系数$\frac{1}{N}$。
离散傅里叶逆变换还有另一种形式，即

$x\left( n \right) = \frac{1}{N}{\left[ {\sum\limits_{k = 0}^{N - 1} {{X^*}\left( k \right)W_N^{nk}} } \right]^*} $ $0 \le n \le N - 1$  (3.5.3)  

**证** 

$\frac{1}{N}{\left[ {\sum\limits_{k = 0}^{N - 1} {{X^*}\left( k \right)W_N^{nk}} } \right]^*} = \frac{1}{N}\left[ {\sum\limits_{k = 0}^{N - 1} {X\left( k \right)W_N^{ - nk}} } \right] = x\left( n \right)$  (3.5.4)  

(3.5.3) 式的逆变换公式中括号内${W_N}$因子用正指数.与正变换公式中${W_N}$指数一致。(3.5.3) 式与正变换公式不同之处是用$X\left( k \right)$的共轭${X^*}\left( k \right)$来作运算，并在作出括号内的变换运算后，再取共轭并乘以常数$\frac{1}{N}$，得出时间序列$x\left( n \right)$。这种逆变换形式在运算上与正变换一样，这样在数字电子计算机上，只要编一个程序就可以既用来计算离散傅里叶变换，又用来计算它的逆变换。

### 3.5.3 对称定理

若$x\left( n \right)$的离散傅里叶变换为$X\left( k \right)$，则当时间序列具有频谱序列的形状$X\left( n \right)$​时，其对应的离散傅里叶变换对如下

$\frac{1}{N}X\left( n \right) \Leftrightarrow x\left( { - k} \right) = x\left( {N - k} \right)$  (3.5.5)  

上式说明$X\left( n \right)$的对应频谱序列具有原来的时间序列$x\left( n \right)$在时间上倒置的形状。

**证：**

因为

$x\left( { - n} \right) = x\left( {N - n} \right) = \frac{1}{N}\sum\limits_{k = 0}^{N - 1} {X\left( k \right)W_N^{ - \left( {N - n} \right)k}}  = \frac{1}{N}\sum\limits_{k = 0}^{N - 1} {X\left( k \right)W_N^{nk}} $

故得

$x\left( { - k} \right) = x\left( {N - k} \right) = \sum\limits_{n = 0}^{N - 1} {\left[ {\frac{{X\left( n \right)}}{N}} \right]W_N^{kn}}  = {\mathop{\rm DFT}\nolimits} \left[ {\frac{{X\left( n \right)}}{N}} \right]$

关于$x\left( { - n} \right) = x\left( {N - n} \right)$，$X\left( { - k} \right) = X\left( {N - k} \right)$的说明见后面离散傅里叶变换的奇偶性及对称性。



### 3.5.4 反转定理

若$x\left( n \right)$的离散傅里叶变换成$X\left( k \right)$，则$x\left( -n \right)$的离散傅里叶变换为$X\left( -k \right)$​。这可直接由离散傅里叶变换的定义得到证明。

### 3.5.5 序列的总和

列长为*N*的时间序列$x\left( n \right)$中各采样值的总和等于其离散傅里叶变换$X\left( k \right)$在时$k = 0$的值，即

${\left. {X\left( k \right)} \right|_{k{\rm{ = }}0}} = \sum\limits_{n = 0}^{N - 1} {{{\left. {x\left( n \right)W_N^{nk}} \right|}_{k{\rm{ = }}0}}}  = \sum\limits_{n = 0}^{N - 1} {x\left( n \right)} $(3.5.6)



### 3.5.6 序列的始值

若序列的离散傅里叶变换为$X\left( k \right)$，则对应的时间序列$x\left( n \right)$的始值$x\left( 0 \right)$为频谱序列各采样值$X\left( k \right)$的总和除以$N$，即

$x\left( 0 \right) = \frac{1}{N}\sum\limits_{k = 0}^{N - 1} {X\left( k \right)} $​​  (3.5.7)  

### 3.5.7 延长序列的离散傅里叶变换

把序列$x\left( n \right)$,${\rm{0}} \le N - 1$，填充零值，人为地加长到$rN$，得到

$g\left( n \right)$   $0 \le n \le rN - 1$

式中$r$​为正整数，而

$g\left( n \right) = \left\{ {\begin{array}{*{20}{l}}
{x\left( n \right)}&{0 \le n \le N - 1}\\
0&{N \le n \le rN - 1}
\end{array}} \right.$(3.5.8)

$g\left( n \right)$的离散傅里叶变换为

$\begin{array}{l}
G\left( k \right) = {\mathop{\rm DFT}\nolimits} \left[ {g\left( n \right)} \right] = \sum\limits_{n = 0}^{rN - 1} {g\left( n \right){{\rm{e}}^{ - {\rm{j}}\frac{{2\pi nk}}{{rN}}}}} \\
{\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt}  = \sum\limits_{n = 0}^{N - 1} {x\left( n \right){{\rm{e}}^{ - {\rm{j}}\frac{{2\pi n\left( {\frac{k}{r}} \right)}}{N}}}} \\
{\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt}  = X\left( {\frac{k}{r}} \right)\qquad k = 0,1, \cdots  \cdots ,rN - 1
\end{array}$  (3.5.9)  

这意味着，$g\left( n \right)$的频谱$G\left( k \right)$与$x\left( n \right)$的频谱$X\left( k \right)$是相对应的，只不过$G\left( k \right)$的频谱间隔比$X\left( k \right)$的频谱间隔降低$\frac{k}{r}$。也就是说，若把序列$x\left( n \right)$填充零值而人为的加长以后再进行离散傅里叶变换，就可使得到的频谱更加细致。

假若增加的长度并非$N$的整数倍，例如$g\left( n \right)$的长度为$L > N$，则由列长为$L$的序列$g\left( n \right)$的离散傅里叶变换$G\left( k \right)$，可得到序列$x\left( n \right)$的$L$根谱线，它比由$X\left( k \right)$得出的$N$​根谱线要多。

### 3.5.8 序列的圆周位移

#### 1. 圆周移位

一列长为$N$的有限长序列$x\left( n \right)$，在区间内$\left[ {0,N - 1} \right]$取非零值，如图3.5.1(*a*)所示。如令其沿坐标$n$ 右移后$m$仍在$\left[ {0,N - 1} \right]$区间内取值，如图3.5.1(*b*) 所示，则将发生信息损失。为避免这种情况，可将$x\left( n \right)$以$N$为周期作周期延拓得

$\tilde x\left( n \right) = x{\left( {\left( n \right)} \right)_N}$

再把$\tilde x\left( n \right)$偏移$m$得

$\tilde x\left( {n + m} \right) = x{\left( {\left( {n + m} \right)} \right)_N}$(3.5.10)

上述过程如图3.5.1(*c*)，(*d*)所示。 然后再对$\tilde x(n + m)$仍在$\left[ {0,N - 1} \right]$区间上取值，即取移位周期序列$\tilde x(n + m)$的主值序列$x{\left( {\left( {n + m} \right)} \right)_N}{R_N}(n)$​，如图3.5.1(*e*)所示。

<img src=".\fig\3.5.1.png" style="zoom:90%;" /> 

图3.5.1 圆周移位过程图

这样，有限长序列$x\left( n \right)$​的圆周移位定义为

${x_1}\left( n \right) = x{\left( {\left( {n + m} \right)} \right)_N}{R_N}\left( n \right)$(3.5.11)

${x_1}\left( n \right)$仍是一长度为$N$的有限长序列，它实际上$x\left( n \right)$是向左移位，但$m$移到$n$负轴上的序列又从右边$N-1$处循环回来。这可想像为将序列$x\left( n \right)$排列在一个等$N$分的圆周上，且$n=0$的点取为正水平方向。由于列长为，$N$故相邻二点的间隔为角$2\pi /N$度，然后将圆顺时针旋转$m$个$2\pi /N$的角度，再从正水平方向开始依序取下各点的序列值，即得$x\left( n \right)$的圆周移位序列${x_1}\left( n \right)$，因此得名为“圆周移位”，也称“循环移位”。其过程如图3.5.2所示。

<img src=".\fig\3.5.2(a).png" style="zoom:90%;" />

(a)

<img src=".\fig\3.5.2(b).png" style="zoom:90%;" />

(b)

<img src=".\fig\3.5.2(c).png" style="zoom:90%;" />

(c)

图3.5.2 序列的圆周移位

(a)$N$等分的圆周 (b)将序列排列在$N$等分的圆周上 (c)令圆周周旋转得$x\left( n \right)$的圆周移位

#### 2.  **有限长序列圆周移位定理**

##### 1) 时间移位定理

设$\tilde X\left( k \right)$和${\tilde X_1}\left( k \right)$分别表示周期序列$\tilde x\left( n \right)$和${\tilde x_1}\left( n \right) = \tilde x\left( {n + m} \right)$的离散傅里叶级数。据(3.3.14)式有

${\tilde X_1}\left( k \right) = W_N^{ - km}\tilde X\left( k \right)$

由(3.4.8)式可得序列$x\left( n \right)$圆周移位所得的序列${x_1}\left( n \right)$的DFT为

${X_1}\left( k \right) = W_N^{ - km}\left( k \right)\tilde X\left( k \right){R_N}\left( k \right) = W_N^{ - km}X\left( k \right)$  (3.5.12)  

这就是时间移位定理。它说明：序列在时间上的时移将引起各根谱线有相应的相移。



##### 2) 频率移位定理(也称调制定理)

对于频域，有限长序列$X\left( k \right)$也可以认为是分布在一个${x_1}\left( n \right)$等分的圆周上。$X\left( k \right)$的圆周移位为$X{\left( {\left( {k + l} \right)} \right)_N}{R_N}\left( k \right)$，利用$x\left( n \right)$与$X\left( k \right)$的对称特性可证明。

${\mathop{\rm IDFT}\nolimits} \left[ {X{{\left( {\left( {k + l} \right)} \right)}_N}{R_N}\left( k \right)} \right] = W_N^{nl}x\left( n \right)$  (3.5.13)  

(3.5.13)式即称为频率移位定理，有时也称为调制定理。此定理说明：若频谱序列在频率上作位移$l$，则时间序列调制了$l\Omega $的频率。这可以由下式看出

$W_N^{nl}x\left( n \right) = {{\rm{e}}^{ - j\left( {\frac{{2\pi }}{N}} \right)nl}}x\left( n \right) = x\left( n \right){{\rm{e}}^{ - j\left( {\frac{{2\pi }}{{NT}}} \right)nlT}} = x\left( n \right){{\rm{e}}^{ - j{\kern 1pt} l{\kern 1pt} {\Omega _n}T}}$​(3.5.14)



**例程3.5.1**

序列圆周移位，已知序列$u(n) = \left[ {\begin{array}{*{20}{c}}
0&1&2&1&0
\end{array}} \right]$，求：

(1)   循环右移2位

(2)   循环左移2位

(3)   序列反转

(4)   序列反转循环右移1位

```
u = [0 1 2 1 0];
u1 = circshift(u,2);   %循环右移2：u1=u((n-2));
u2 = circshift(u,-2);  %循环左移2：u2=u((n+2));
u3 = flip(u);           %序列反转：u3=u(-n);;
u4 = circshift(flip(u),1); %序列反转、循环右移1：u4=u(-(n+1));
subplot(5,1,1); stem(u); xlabel('序号'); ylabel('u(n)');
subplot(5,1,2); stem(u1); xlabel('序号'); ylabel('u1)');
subplot(5,1,3); stem(u2); xlabel('序号'); ylabel('u2');
subplot(5,1,4); stem(u3); xlabel('序号'); ylabel('u3');
subplot(5,1,5); stem(u4); xlabel('序号'); ylabel('u4');
```

<img src=".\fig\p3.5.1.png" style="zoom:90%;" />

### 3.5.9 圆周卷积及其与有限长序列的线性卷积关系

圆周卷积也称循环卷积。**圆周卷积定理**：两序列离散傅里叶变换的乘积等于此两序列的圆周卷积的离散傅里叶变换，即若

${X_3}\left( k \right) = {X_1}\left( k \right){X_2}\left( k \right)$

则

$\begin{array}{l}
{x_3}\left( n \right) = {\mathop{\rm IDFT}\nolimits} \left[ {{X_3}\left( k \right)} \right] = \sum\limits_{m = 0}^{N - 1} {{x_1}} \left( m \right){x_2}{\left( {\left( {n - m} \right)} \right)_N}{R_N}\left( n \right)\\
{\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt}  = \sum\limits_{m = 0}^{N - 1} {{x_2}} \left( m \right){x_1}{\left( {\left( {n - m} \right)} \right)_N}{R_N}\left( n \right)
\end{array}$(3.5.15)

证 由于${X_1}\left( k \right),{X_2}\left( k \right)$都隐含周期性，所以其乘积${X_3}\left( k \right)$同样隐含周期性。为此要证明 (3.5.15) 式可以简单地应用周期卷积的结果。

(3.5.15) 式的卷积可以看作是周期序列${\tilde x_1}\left( n \right)$与${\tilde x_2}\left( n \right)$卷积后再取其主值序列，即将${X_3}\left( k \right)$周期延拓

${\tilde X_3}\left( k \right) = {\tilde X_1}\left( k \right){\tilde X_2}\left( k \right)$

则

$\begin{array}{l}
{{\tilde x}_3}\left( n \right) = {\mathop{\rm IDFS}\nolimits} \left[ {{{\tilde X}_3}\left( k \right)} \right] = \sum\limits_{m = 0}^{N - 1} {{{\tilde x}_1}\left( m \right){{\tilde x}_2}\left( {n - m} \right)} \\
{\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt}  = \sum\limits_{m = 0}^{N - 1} {{x_1}{{\left( {\left( m \right)} \right)}_N}{x_2}{{\left( {\left( {n - m} \right)} \right)}_N}} 
\end{array}$

因$0 \le m \le N - 1,{\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {x_1}{\left( {\left( m \right)} \right)_N} = {x_1}\left( m \right)$，因此

${x_3}\left( n \right) = {\tilde x_3}\left( n \right){R_N}\left( n \right) = \left[ {\sum\limits_{m = 0}^{N - 1} {{x_1}\left( m \right){x_2}{{\left( {\left( {n - m} \right)} \right)}_N}} } \right]{R_N}\left( n \right)$(3.5.16)

上式经过简单换元可得

${x_3}\left( n \right) = \sum\limits_{m = 0}^{N - 1} {{x_2}\left( m \right){x_1}{{\left( {\left( {n - m} \right)} \right)}_N}{R_N}\left( n \right)} $

(3.5.16)式的卷积过程如图3.5.3所示，与图3.3.1的周期卷积相比,两者的卷积过程是一样的，只是这里只取卷积结果的主值序列。由于卷积过程只在主值区间内进行$0 \le m \le N - 1$，因此实${x_2}{\left( {\left( {n - m} \right)} \right)_N}{R_N}\left( n \right)$际上就是${x_2}\left( m \right)$的圆周移位，所以上述的卷积称为圆周卷积，习惯上常用$\otimes$表示圆周卷积，以区别于线性卷积。(3.5.16)式的圆周卷积可表示为：

${x_3}\left( n \right) = {x_1}\left( n \right)\otimes{x_2}\left( n \right)$  (3.5.17)  

<img src=".\fig\3.5.3.png" style="zoom:90%;" />

图3.5.3 圆周卷积

(*a*)序列${x_1}\left( n \right)$ (*b*) 序列${x_2}\left( n \right)$  (*c*)${x_2}{\left( {\left( {0 - m} \right)} \right)_N}$ (*d*)${x_2}{\left( {\left( {1 - m} \right)} \right)_N}$ (*e*)序列${x_3}\left( n \right)$

必须指出，两列长为$N$的有限长序列的圆周卷积的结果也是一列长为$N$的有限氏序列，而不是像线性卷积那样列长为$2N-1$。

由于${x_3}\left( n \right)$与${X_3}\left( k \right)$的对称特性，若

${x_3}\left( n \right) = {x_1}\left( n \right){x_2}\left( n \right)$

同样可以证明

$\begin{array}{l}
{X_3}\left( k \right) = {\mathop{\rm DFT}\nolimits} \left[ {{x_3}\left( n \right)} \right]\\
{\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt}  = \frac{1}{N}\sum\limits_{l = 0}^{N - 1} {{X_1}\left( l \right){X_2}{{\left( {\left( {k - l} \right)} \right)}_N}{R_N}\left( k \right)} \\
{\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt}  = \frac{1}{N}\sum\limits_{l = 0}^{N - 1} {{X_2}\left( l \right){X_1}{{\left( {\left( {k - l} \right)} \right)}_N}{R_N}\left( k \right)} 
\end{array}$(3.5.18)

(3.5.18)有时称为频率卷积定理。

#### 1.  **圆周卷积和线性卷积的关系**

实际问题求解线性卷积：例如信号$x\left( n \right)$通过系统$h\left( n \right)$其输出为线性卷积。$y\left( n \right) = x\left( n \right)*h\left( n \right)$以后将会看到，圆周卷积由于可以采用快速傅里叶变换技术，所以比线性卷积运算速度快。如果$x\left( n \right)$，$h\left( n \right)$都是有限长序列，能否用圆周卷积来取代线性卷积而不失真呢？为此必须弄清圆周卷积与线性卷积的关系，这是正确运用圆周卷积的关键。

假定${x_1}\left( n \right)$是列长为$N$的有限长序列，${x_2}\left( n \right)$是列长为$M$的有限长序列，二者的线性卷积为

$x\left( n \right) = {x_1}\left( n \right) * {x_2}\left( n \right) = \sum\limits_{m =  - \infty }^\infty  {{x_1}\left( m \right){x_2}\left( {n - m} \right)} $

$x\left( n \right)$也是有限长序列，其列长可以这样来决定

从${x_1}\left( m \right)$看，序号$m$​的区间为

$0 \le m \le N - 1$

从${x_2}\left( {n - m} \right)$看，序号$n - m$的区间为

$0 \le n - m \le M - 1$

将上面两不等式相加，有

$0 \le n \le N + M - 2$

在上述区间外不是${x_1}\left( m \right) = 0$就是!${x_2}\left( m \right) = 0$，因而$x\left( n \right) = 0$。所以$x\left( n \right)$是一个$n$由零起到$N+M-2$的序列，列长为$N+M-1$(两序列长度之和减1)。例如图3.5.4中${x_1}\left( n \right)$为$N-3$的矩形序列，${x_2}\left( n \right)$为$M=5$ 的矩形序列，两者的线性卷积$x\left( n \right)$是具有$N + M - 1 = 7$的采样值的序列。

<img src=".\fig\3.5.4.png" style="zoom:90%;" />

图3.5.4 圆周卷积与线性卷积

(a) 序列${x_1}\left( n \right)$ (*b*)序列${x_2}\left( n \right)$

(c)序列${x_1}\left( n \right)$与${x_2}\left( n \right)$的线性卷积结果

(d)${x_1}\left( n \right)$与${x_2}\left( n \right)$的列长$L=5$的圆周卷积

(e)${x_1}\left( n \right)$与${x_2}\left( n \right)$的列长的$L=6$圆周卷积

(f)${x_1}\left( n \right)$与${x_2}\left( n \right)$的列长$L \ge 7$​的圆周卷积

再看对${x_1}\left( n \right)$和${x_2}\left( n \right)$进行列长为$L$的圆周卷积${X_L}(n) = {x_1}(n)\otimes{x_2}(n)$的情况。为此把列长为$N$的序列${x_1}\left( n \right)$后面补上$L-N$个零值点，把列长为$M$的${x_2}\left( n \right)$后面补上$L \ge 7$个零值点各构成列长为$L$的有限长序列。为了进行圆周卷积。我们先将${x_1}\left( n \right)$，${x_2}\left( n \right)$进行周期延拓

$\begin{array}{l}
{{\tilde x}_1}\left( n \right) = \sum\limits_{q =  - \infty }^\infty  {{x_1}\left( {n + qL} \right)} \\
{{\tilde x}_2}\left( n \right) = \sum\limits_{k =  - \infty }^\infty  {{x_2}\left( {n + qL} \right)} 
\end{array}$

则

${\tilde x_2}\left( { - m} \right) = \sum\limits_{k =  - \infty }^\infty  {{x_2}\left( { - m + kL} \right)} $

${\tilde x_2}\left( {n - m} \right) = \sum\limits_{k =  - \infty }^\infty  {{x_2}\left( {n - m + kL} \right)} $

${\tilde x_1}\left( n \right),{\tilde x_2}\left( n \right)$的列长为${x_2}\left( n \right)$的周期卷积为

$\begin{array}{l}
{{\tilde x}_L}\left( n \right) = \sum\limits_{m = 0}^{L - 1} {\sum\limits_{q =  - \infty }^\infty  {{x_1}\left( {m + qL} \right)} } \sum\limits_{k =  - \infty }^\infty  {{x_2}\left( {n - m + kL} \right)} \\
{\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt}  = \sum\limits_{m = 0}^{L - 1} {\sum\limits_{k =  - \infty }^\infty  {{x_1}\left( m \right){x_2}\left( {n - m + kL} \right)} } 
\end{array}$

交换求和次序，有

$\begin{array}{l}
{{\tilde x}_L}\left( n \right) = \sum\limits_{k =  - \infty }^\infty  {\sum\limits_{m = 0}^{L - 1} {{x_1}\left( m \right){x_2}\left( {n + kL - m} \right)} } \\
{\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt}  = \sum\limits_{k =  - \infty }^\infty  {x\left( {n + kL} \right)} 
\end{array}$  (3.5.19)  

(3.5.19) 式表明：${x_1}\left( n \right)$ 、${x_2}\left( n \right)$的周期卷积是${x_1}\left( n \right)$、${x_2}\left( n \right)$的线性卷积$x\left( n \right)$以为周期的延拓。

有前面分析我们知道，线性卷积$x\left( n \right)$具有$N+M-1$个非零序列值。因此，如果周期卷积的周期$L < N + M - 1$,则$x\left( n \right)$的周期延拓就必然有一部分非零序列值要交叠起来，发生混淆。只有当$L \ge N + M - 1$时，才不会发生交叠，这时$x\left( n \right)$的周期延拓${\tilde x_1}\left( n \right)$中的每一个周期$L$内，前$N+M-1$个序列值正是序列$x\left( n \right)$的值，而剩下的$L - (N + M - 1)$个点上序列则是补充的零值。

我们知道，圆周卷积就是周期卷积取主值序列，即

${x_L}\left( n \right) = {x_1}\left( n \right)\otimes{x_2}\left( n \right) = {\tilde x_L}\left( n \right){R_L}\left( n \right)$

因此

${x_L}\left( n \right) = \left[ {\sum\limits_{k =  - \infty }^\infty  {x\left( {n + kL} \right)} } \right]{R_L}\left( n \right)$

所以要使圆周卷积与线性卷积相等，而不产生混淆的必要条件是

$L \ge N + M - 1$  (3.5.20)  

符合 (3.5.20) 式的条件，则${x_L}\left( n \right) = x\left( n \right)$​，即

${x_1}\left( n \right)\otimes{x_2}\left( n \right) = {x_1}\left( n \right) * {x_2}\left( n \right)$

图3.5.4 (*d*) (*e*) (*f*) 反映了当${x_L}\left( n \right) = x\left( n \right)$取值不同时，线性卷积与圆周卷积的关系。图3.5.4 (*d*) 中$L=5$, 这时混淆现象严重，致使工${x_L}(n)$与$x\left( n \right)$完全不一样，而图3.5.4 (e) 中$L=6$,这时有两点$\left( {n = 0,n = 6} \right)$发生混淆失真，只有在图3.5.4 (*f*) 中，满足条件$L \ge N + M - 1 = 7$时，圆周卷积才与线性卷积的结果相同。只要具体比较一下在这种条件下，圆周卷积与线性卷积的实际过程就会透彻地理解两者卷积为什么相等。

<img src=".\fig\3.5.5.png" style="zoom:90%;" />

图3.5.5 圆周位移及线性位移比较

(a) 补充零值点的列长为$L$的${x_1}\left( n \right)$ (*b*)补充零值点的列长为$L$的${x_2}\left( n \right)$ 

(b) (c)线性移位零位的${x_2}\left( -m \right)$ (d)圆周移位零位的${x_2}{\left( {\left( { - m} \right)} \right)_L}$ 

(c) (e)线性移位2位的${x_2}\left( 2-m \right)$ *(f*)圆周移位2位的${x_2}{\left( {\left( { 2- m} \right)} \right)_L}$

(g)线性移位L—1位的${x_2}\left( L-1-m \right)$ (h)圆周移位L-1位的${x_2}{\left( {\left( { L-1-m} \right)} \right)_L}$ 

(i)线性卷积与圆周卷积相等的$x\left( n \right)$

如图3.5.5所示，$L$满足$L \ge N + M - 1 = 7$的条件，列长为$N = 3$的序列$x\left( n \right)$已补上$L - N = 4$个零值点（图3.5.5 (*a*)）；列长为$M = 5$的序列${x_2}\left( n \right)$已补充上$L - M = 2$个零值点（图3.5.5 (b)），则在$L$长的区间上对两序列作圆周卷积时，由于${x_2}\left( -m \right)$有$L-M$个零值点，所以它在$\left[ {0~~L - 1} \right]$区间上作圆周移位时，在$\left[ {0~~L - 1} \right]$区间上移位的结果和${x_2}\left( -m \right)$的线性移位结果是一样的，如图3.5.5 (*c*)，(*d*)，(*e*)，(*f*)，(*g*)，(*h*)所示。另一方面，虽然在$\left[ {N~~L - 1} \right]$区间上圆周移位结果和线性移位结果可能会不同，但由于${x_1}\left( n \right)$在此区间均为零值点，所以也不会有输出。因而在区间$\left[ {0~~L - 1} \right]$上的圆周卷积结果和${x_1}\left( n \right)$，${x_2}\left( n \right)$的线性卷积结果实际是一样的。

综上所述可以清楚看出：有限长序列${x_1}\left( n \right)$，${x_2}\left( n \right)$的周期卷积是${x_1}\left( n \right)$，${x_2}\left( n \right)$的线性卷积以周期期延拓。而圆周卷积是周期卷积去主值序列，当满足$L \ge N + M - 1$的条件时，圆周卷积与线性卷积的结果是相同的。



**例程 3.5.2**

已知$u(n) = \left[ {\begin{array}{*{20}{c}}
0&1&2&1&0
\end{array}} \right]$和$v(n) = \left[ {\begin{array}{*{20}{c}}
0&1&0&1&0
\end{array}} \right]$

求：

(1)  $x = u\left( {\left( {n - 2} \right)} \right)$，$y = u\left( {\left( {n + 2} \right)} \right)$

(2)  $u\left( n \right)$和$v\left( n \right)$的线性卷积

(3)  $u\left( n \right)$和$v\left( n \right)$的圆周卷积

```
u = [0 1 2 1 0];
v = [0 1 0 1 0];
Lconv = conv(u,v);
Cconv_5 = cconv(u,v,5);
Cconv_10 = cconv(u,v,10);
x = circshift(u,2);  %循环右移2 x=u((n-2));
y = circshift(u,-2); %循环左移2 y=u((n+2));
subplot(4,2,1); stem(u); xlabel('序号'); ylabel('u(n)');
subplot(4,2,2); stem(v); xlabel('序号'); ylabel('v(n)');
subplot(4,2,[3, 4]); stem(Lconv); xlabel('序号'); ylabel('Lconv'); xlim([0 10]);
subplot(4,2,[5, 6]); stem(Cconv_5); xlabel('序号'); ylabel('Cconv_5'); xlim([0 10]);
subplot(4,2,[7, 8]); stem(Cconv_10); xlabel('序号'); ylabel('Cconv_10'); xlim([0 10]);
```

<img src=".\fig\p3.5.2.png" style="zoom:90%;" />

#### 2.  **圆周卷积在信号处理中的应用——重叠相加法与重叠保留法**

可用两种办法计算线性系统的输出序列：

(1)   按线性卷积来计算；

(2)   通过圆周卷积，用快速卷积法计算。

设输入$x\left( n \right)$的列长为$N$，系统的单位采样响应的列长为$M$，则二者线性卷积后的输出序列$y\left( n \right)$的列长为$L = N + M - 1$。由圆周卷积定理可知，两序列离散傅里叶变换的乘积等于它们圆周卷积的离散傅里叶变换。我们分别取$x\left( n \right)$和$h\left( n \right)$的$L \ge N + M - 1$点的离散傅里叶变换$X\left( k \right)$和$H\left( k \right)$，将两者相乘再求其逆变换即得两序列的圆周卷积，此时圆周卷积与线性卷积相等。这种方法称为快速卷积法，因为可以利用快速傅里叶变换迅速而有效的求出卷积，甚至对于$N - M - 1$约为30，快速卷积法也比直接卷积法更有效。快速卷积法是一种重要的信号处理工具。

当输入序列$x\left( n \right)$极长时，为了尽快得到输出，不允许等$x\left( n \right)$全部集齐后再进行卷积,否则会使输出相对于输入有较长的延时。再者，如果$N + M - 1$太大，则需要大量存储单元。为此，可把$x\left( n \right)$分段，分别求出每段的卷积，合在一起即得总的输出。这种成组进行卷积法可利用前面介绍的离散傅里叶变换实现，并可细分为重叠相加法、重叠保留法两种。下面针对图3.5.6 所描绘的信号$x\left( n \right)$和列长为$M$ 的单位采样响应$h\left( n \right)$来解释这两种方法。



##### 1) **重叠相加法**

$h\left( n \right)$的列长为$M$，信号为$x\left( n \right)$。我们将$x\left( n \right)$分解为几段之和，每段长为$L$点，如图3.5.6所示。选择$L$所应作的考虑是相当复杂的，一个好的经验是选择$L$使与$M$的数量级相同。

<img src=".\fig\3.5.6.png" style="zoom:90%;" />

图3.5.6 有限列长的单位采样响应及待处理的信号

(a)单位采样响应$h\left( n \right)$；(b)待处理的信号$x\left( n \right)$

以${x_k}\left( n \right)$表示第$k$段$x\left( n \right)$，于是输入信号$x\left( n \right)$可表示成

$x\left( n \right) = \sum\limits_{k = 0}^\infty  {{x_k}\left( n \right)} $  (3.5.21)  

式中

${x_k}\left( n \right) = \left\{ {\begin{array}{*{20}{l}}
{x\left( n \right)}&{kL \le n \le \left( {k + 1} \right)L - 1}\\
0&{{\rm{else}}}
\end{array}} \right.$  (3.5.22)  

$x\left( n \right)$与$h\left( n \right)$的线性卷积等于${x_k}\left( n \right)$和$h\left( n \right)$卷积之和，即

$x(n) * h(n) = \sum\limits_{k = 0}^\infty  {{x_k}} (n) * h(n)$  (3.5.23)  

(3.5.23) 和式中的每一项$\left[ {{x_k}\left( n \right)*h\left( n \right)} \right]$的列长为$L + M - 1$因此可将$h\left( n \right)$及${x_k}\left( n \right)$二个序列补零，都加长到$L + M - 1$点,以利用$L + M - 1$的DFT，通过圆周卷积得到线性卷积${x_k}\left( n \right)*h\left( n \right)$。为便于用基-2FFT运算，一般可取$L + M - 1 = {2^k}$。由于每一段的起点和前后相邻各段起点相隔$L$个点，而每一段信号${x_k}\left( n \right)$和$h\left( n \right)$卷积后列长$L + M - 1$，所以在作 (3.5.23) 式的求和时，每段卷积之最后$M-1$个点必须和下一段之前$M-1$个点重叠，如图3.5.7所示。输入各段${x_k}\left( n \right)$描绘于图3.5.7 (*a*)，相加各${x_k}\left( n \right)$波形即可重新组成输入信号$x\left( n \right)$波形。卷积后各段输出示于图3.5.7 (b)，而总的输出序列$y\left( n \right) = x\left( n \right)*h\left( n \right)$是通过相加图3.5.7(b)中各段构成的。重叠部分也要相加，故称为重叠相加法。重叠是由于每段输入序列${x_k}\left( n \right)$与单位采样响应$h\left( n \right)$的线性卷积后的列长长于$x\left( n \right)$的分段长度造成的。

<img src=".\fig\3.5.7.png" style="zoom:90%;" />

图3.5.7 重叠相加法图形

(a)将$x\left( n \right)$分解为列长为$L$的不重复的几段    (b)每段${x_k}\left( n \right)$和$h\left( n \right)$​卷积的结果

##### **2)**    **重叠保留法**

这种方法延长分段序列的办法不是补零，而是保留原来的输入序列值，且保留在每段的前端，如图3.5.8(b) 中的虚线部分所示的那样。这时如利用DFT实现$h\left( n \right)$和${x_k}\left( n \right)$的圆周卷积，则其每段卷积结果的前$M-1$个点不等于线性卷积值而需舍去。

为了清楚地看出这点，我们研究一下$x\left( n \right)$中的任意一段列长为$N$的序列${x_i}\left( n \right)$与列长为$M$的$h\left( n \right)$​的圆周卷积情况：

$y_i^\prime \left( n \right) = {x_i}\left( n \right)\otimes h\left( n \right) = \sum\limits_{m = 0}^{N - 1} {{x_i}\left( m \right)h{{\left( {\left( {n - m} \right)} \right)}_N}{R_N}\left( n \right)} $(3.5.24)

由于$h\left( n \right)$的列长为$M$，当在$0 \le n \le M - 2$范围内进行圆周位移时，$h{\left( {\left( {n - m} \right)} \right)_N}$将在${x_i}\left( m \right)$的尾部出现有非零值，如图3.5.8(c)所示的$n = 1$的情况就是这样。所以在这一部分$0 \le n \le M - 2$的${y_i}^\prime \left( n \right)$值中将混入${x_i}\left( m \right)$尾部与$h{\left( {\left( {n - m} \right)} \right)_N}$的卷积值，从而使${y_i}^\prime \left( n \right)$不同于线性卷积结果。但是当$n$从$M-1$开始，直到$N-1$点，则有$h{\left( {\left( {n - m} \right)} \right)_N} = h\left( {n - m} \right)$，如图3.5.8(d)，(e)所示。因此从$n = M - 1$点后，圆周卷积值完全与线性卷积值一样，${y_i}^\prime \left( n \right)$才是正确的卷积值，因而每一段卷积运算结果的前$M-1$个值需去掉。如图3.5.8(f)所示。

<img src=".\fig\3.5.8.png" style="zoom:90%;" />

图3.5.8 用保留信号代替补零后局部的混淆现象

为了不造成输出信号的遗漏，对$x\left( n \right)$分段时，就需使相邻两段有$M-1$个点的重叠（对于第一段$x\left( n \right)$由于没有前一段保留信号，则在其前填充$M-1$个零值点），为此我们将${x_k}\left( n \right)$​定义为

${x_k}\left( n \right) = \left\{ {\begin{array}{*{20}{l}}
{x\left[ {n + k\left( {N - \left( {M - 1} \right)} \right) - M + 1} \right]}&{0 \le n \le N - 1}\\
0&{{\rm{else}}}
\end{array}} \right.$(3.5.25)

式中我们已规定将每一段的时间原点，放在那一段的起始点，而不是$x\left( n \right)$的原点。

这种分段方法描绘于图3.5.9(a)。每段和$h\left( n \right)$的圆周卷积以${y_k}^\prime \left( n \right)$表示，如图3.5.9(b)所示。图中已标明每一输出波形段开始的$0 \le n \le M - 2$部分须舍去，把相邻各输出段留下的序列衔接起来，就构成了最终的没有遗漏而又正确的输出，即

$y\left( n \right) = \sum\limits_{k = 0}^\infty  {{y_k}\left( {n - k\left( {N - M + 1} \right)} \right)} $

这里$n$为总的输出序列$y\left( n \right)$的序号。而式中

${y_k}\left( n \right) = \left\{ {\begin{array}{*{20}{l}}
{y_k^\prime \left( n \right)}&{M - 1 \le n \le N - 1}\\
0&{else}
\end{array}} \right.$  (3.5.26)  

每段输出的时间原点放在${y_k}\left( n \right)$的起始点，而不是$y\left( n \right)$的原点。

重叠保留法的名称是因为每一相继的输入段均由$N - M + 1$个新点和前一段保留下来的$M + 1$个点所组成而得名的。

<img src=".\fig\3.5.9.png" style="zoom:90%;" />

图3.5.9 重叠保留法示意图

(a)$x\left( n \right)$分解为列长为$N$的不重复的几段 

(b)每一段与$h\left( n \right)$圆周卷积的结果，图中标出在形成线性卷积时每一段要去掉的部分

### 3.5.10. 圆周相关定理

​	圆周相关也称循环相关。

​	若$X_3\left( k \right) =X_{1}^{*}\left( k \right) X_2\left( k \right)$

则

|      | $\begin{aligned}x_3\left( n \right) =\mathrm{IDFT}\left[ X_3\left( k \right) \right] =\sum_{i=0}^{N-1}{x_{1}^{*}}\left( l \right) x_2\left( \left( l+n \right) \right) _NR_N\left( n \right)\end{aligned}$ | (3.5.27) |
| ---- | :----------------------------------------------------------: | -------: |

​	证：由于${X_1}(k)$，${X_2}(k)$都隐含周期性，所以其乘积${X_3}(k)$同样隐含周期性。将${X_3}(k)$周期延拓，则

|      | $$\begin{aligned}\tilde{X}_3\left( k \right) =\tilde{X}_{1}^{*}\left( k \right) \tilde{X}_2\left( k \right)\end{aligned}$$ |      |
| ---- | :----------------------------------------------------------: | ---- |

则

|      | $\begin{aligned}\tilde{x}_3\left( n \right) =\mathrm{IDFS}\left[ \tilde{X}_3\left( k \right) \right] =\frac{1}{N}\sum_{k=0}^{N-1}{\tilde{X}_{1}^{*}\left( k \right) \tilde{X}_2\left( k \right) W_{N}^{-nk}}\end{aligned}$ |      |
| :--: | :----------------------------------------------------------: | ---- |

代入          

|      | $$\begin{aligned}\tilde{X}_1\left( k \right) =\left[ \sum_{l=0}^{N-1}{\tilde{X}_1\left( l \right) W_{N}^{lk}} \right] ^*\end{aligned}$$ |      |
| ---- | :----------------------------------------------------------: | ---- |

则

|      | $$\begin{aligned}\tilde{x}_3\left( n \right) &=\frac{1}{N}\sum_{k=0}^{N-1}{\sum_{l=0}^{N-1}{\tilde{x}_{i}^{*}\left( l \right) \tilde{X}_2\left( k \right) W_{N}^{-\left( n+l \right) k}}}\\	&=\sum_{i=0}^{N-1}{\tilde{x}_{i}^{*}\left[ \small{\frac{1}{N}}\sum_{k=0}^{N-1}{\tilde{X}_2\left( k \right) W_{N}^{-\left( n+1 \right) k}} \right]}\\	&=\sum_{i=0}^{N-1}{\tilde{x}_1\left( l \right) \tilde{x}_2\left( n+l \right)}\\&=\sum_{l=0}^{N-1}{x_{i}^{*}\left( \left( l \right) \right) _Nx_2\left( \left( n+l \right) \right) _N}\\\end{aligned}$$ |      |
| ---- | :----------------------------------------------------------: | ---- |

因$$0\leqslant l\leqslant N-1$$，$$x_{1}^{*}\left( \left( l \right) \right) _N=x_{1}^{*}\left( l \right)$$故有

|      | $$\begin{aligned}x_3\left( n \right) =\tilde{x}_3\left( n \right) R_N\left( n \right) =\left[ \sum_{i=0}^{N-1}{x_{i}^{*}\left( l \right) x_2\left( \left( n+l \right) \right) _N} \right] R_N\left( n \right)\end{aligned} $$ | (3.5.28) |
| ---- | :----------------------------------------------------------: | -------: |

​	如果${x_1}(l)$仅考虑是实数，其共轭还是其本身，则得

|      | $\begin{aligned}x_3\left( n \right) =\left[ \sum_{i=0}^{N-1}{x_1\left( l \right) x_2\left( \left( n+l \right) \right) _N} \right] R_N\left( n \right)\end{aligned} $ |      |
| ---- | :----------------------------------------------------------: | ---- |

上式为两$N$点有限长实序列${x_1}(n)$与${x_2}(n)$的$N$点圆周相关，而${x_2}{((n+l))_N}{R_N}(n)$正好是${x_2}(n)$的圆周移位，变量是$n$，且不需折叠。若定义$$\begin{aligned}x_3\left( n \right) =\sum_{m=-\infty}^{\infty}{x_1\left( m \right) x_2\left( n+m \right)}\end{aligned}$$为线性相关，则两列长分别为${N_1}$及${N_2}$的线性相关，应等于将这两序列补零到$N={N_1}+{N_2}-1$列长后的圆周相关。圆周相关定理告诉我们，实信号的相关性，可借助于离散傅里叶正反变换求得。当一较短的序列与一很长序关时，可类似圆周卷积的做法，采用分段相关的办法。

### 3.5.11. 帕斯维尔定理

若$X\left( k \right) =\mathrm{DFT}\!\:\left[ x\left( n \right) \right]$，则

|      | $\begin{aligned}\sum_{n=0}^{N-1}{x^2\left( n \right)}=\frac{1}{N}\sum_{k=0}^{N-1}{\left| X\left(k \right) \right|}^2\end{aligned}$ | (3.5.29) |
| :--: | :----------------------------------------------------------: | -------: |

证在圆周相关定理中，取$$x_2\left( l \right) =x_1\left( l \right)$$，且$$n=0$$，则

|      | $\begin{aligned}\sum_{i=0}^{N-1}{x_1\left( l \right) x_2\left( l \right)}=\frac{1}{N}\sum_{k=0}^{N-1}{X^*\left( k \right) X\left( k \right) W_{N}^{0}}\end{aligned}$ |      |
| ---- | :----------------------------------------------------------: | ---- |

所以

|      | $\begin{aligned}\sum_{n=0}^{N-1}{x^2\left( n \right)}=\frac{1}{N}\sum_{k=0}^{N-1}{\left| X\left(k\right)\right|}^2\end{aligned}$ |      |
| ---- | :----------------------------------------------------------: | ---- |

帕斯维尔定理建立了离散函数时算能量和频域计算能量之间的关系，又称之为能量定理。

### 3.5.12. 离散傅里叶变换的奇偶性及对称性

##### 	1．周期性共轭对称和共轭反对称分量

​	第2章曾讨论过任一序列都可分解成共轭对称与共轭反对称两个分量之和。共轭对称分量为

|      | $$x_e\left( n \right) =\frac{1}{2}\left[ x\left( n \right) +x^*\left( -n \right) \right]$$ | (3.5.30) |
| ---- | :----------------------------------------------------------: | -------: |

共轭反对称分量为

|      | $$x_o\left( n \right) =\frac{1}{2}\left[ x\left( n \right) -x^*\left( -n \right) \right]$$ | (3.5.31) |
| :--: | :----------------------------------------------------------: | -------: |

​	在讨论有限长序列离散傅里叶变换对称性质时，一般不采用第2章给出的共轭对称和共轭反对称分量的定义。因为列长为$$N$$的序列$$X\left( k \right)$$其离散傅里叶变换的列长也为$$N$$，而其$$x_e\left( n \right)$$及$$x_o\left( n \right)$$的列长却都为$$\left( 2N-1 \right)$$[见图3.5.10 (g)至(j)]，难以由它们找出DFT的对称性。因为DFT的列长为$$N$$。

![](.\fig\3.5.10.png)

图3.5.10 周期与非周期序列的共轭对称及共轭反对称分量以及周期性共轭对称及共轭反对称分量

​	为解决上述困难，我们注意到对于周期为$$N$$的周期序列$$\tilde{x}\left( n \right)$$来说，它的共轭对称分量和共轭反对称分量仍然都是周期性的，并且周期仍为$$N$$。这就启示我们将$$x\left( n \right)$$分解成两个列长为$$N$$的有限长序列，其一对应于$$\tilde{x}\left( n \right)$$的共轭对称分量的一个周期，记作$$x_{ep}\left( n \right)$$，另一对应于$$\tilde{x}\left( n \right)$$的共轭反对称分量的一个周期，记作$$x_{op}\left( n \right)$$。

​	为此，将$$x\left( n \right)$$以$$N$$为周期延拓成周期序列

|      | $$\tilde{x}\left( n \right) =x\left( \left( n \right) \right) _N$$ |      |
| ---- | :----------------------------------------------------------: | ---- |

则周期序列$$\tilde{x}\left( n \right)$$的共轭对称和共轭反对称分量分别为

|      | $$\tilde{x}_e\left( n \right) =\frac{1}{2}\left[ \tilde{x}\left( n \right) +\tilde{x}^*\left( -n \right) \right]$$ | (3.5.32) |
| ---- | :----------------------------------------------------------: | -------: |

|      | $$\tilde{x}_e\left( n \right) =\frac{1}{2}\left[ \tilde{x}\left( n \right) -\tilde{x}^*\left( -n \right) \right]$$ | (3.5.33) |
| ---- | :----------------------------------------------------------: | -------: |

取它们从0到$$N-1$$的一个周期值，则得

|      | $$\begin{aligned}x_{ep}\left( n \right) &=\frac{1}{2}\left[ x\left( \left( n \right) \right) _N+x^*\left( \left( -n \right) \right) _N \right] R_N\left( n \right) \mathrm{         }\\&=\frac{1}{2}\left[ x\left( n \right) +x^*\left( N-n \right) \right]\end{aligned}$$ | (3.5.34) |
| ---- | :----------------------------------------------------------: | -------: |

 

|      | $$\begin{aligned}x_{op}\left( n \right) &=\frac{1}{2}\left[ x\left( \left( n \right) \right) _N-x^*\left( \left( -n \right) \right) _N \right] R_N\left( n \right) \mathrm{         }\\&=\frac{1}{2}\left[ x\left( n \right) -x^*\left( N-n \right) \right]\end{aligned}$$ | (3.5.35) |
| ---- | :----------------------------------------------------------: | -------: |

又由(3.5.32)式及(3.5.33)式可得

|      | $$\tilde{x}\left( n \right) =\tilde{x}_e\left( n \right) +\tilde{x}_o\left( n \right)$$ |      |
| ---- | :----------------------------------------------------------: | ---- |

因此

|      | $$\begin{aligned}x\left( n \right) &=\tilde{x}\left( n \right) R_N\left( n \right) \mathrm{}\\&=\left[ \tilde{x}_e\left( n \right) +\tilde{x}_o\left( n \right) \right] R_N\left( n \right) \mathrm{       }\\&=x_{ep}\left( n \right) +x_{op}\left( n \right)\end{aligned}$$ | (3.5.36) |
| ---- | :----------------------------------------------------------: | -------: |

​	序列$$x_{ep}\left( n \right)$$和$$x_{op}\left( n \right)$$分别称为列长为$$N$$的序列$$x\left( n \right)$$的周期性共轭对称分量和周期性共轭反对称分量。当$$x_{ep}\left( n \right)$$和$$x_{op}\left( n \right)$$为实序列时，分别称作周期性偶分量和周期性奇分量。这样的术语易使人误解，因为序列$$x_{ep}\left( n \right)$$和$$x_{op}\left( n \right)$$并不是周期序列，它们只是分别表示周期序列$$\tilde{x}_e\left( n \right)$$和$$\tilde{x}_o\left( n \right)$$的一个周期，其间关系如图3.5.10(c)，(d)，(e)，(f)所示。

显然，$$x_{ep}\left( n \right)$$和$$x_{op}\left( n \right)$$与(2.6.3)式定义的$$x_e\left( n \right)$$和(2.6.4)式定义的$$x_o\left( n \right)$$并不等价。然而不难证明，$$x_{ep}\left( n \right)$$和$$x_{op}\left( n \right)$$与列长为$$\left( 2N-1 \right)$$的$$x_e\left(n\right)$$和$$x_o\left( n \right)$$。有下述关系

|      | $$x_{ep}\left( n \right) =\left[ x_e\left( n \right) +x_e\left( n-N \right) \right] R_N\left( n \right)$$ | (3.5.37) |
| ---- | :----------------------------------------------------------: | -------: |

 

|      | $$x_{op}\left( n \right) =\left[ x_o\left( n \right) +x_o\left( n-N \right) \right] R_N\left( n \right)$$ | (3.5.38) |
| ---- | :----------------------------------------------------------: | -------: |

以上讨论也完全适用于序列$$X\left( k \right)$$，并得出类似的表达式。

最后还须指出：因为我们把有限长序列视为周期为$$N$$的时间序列中的一个周期，因此有

|      | $$x\left( -n \right) =x\left( N-n \right)$$ | (3.5.39) |
| ---- | :-----------------------------------------: | -------: |

同样地

|      | $$X\left( -k \right) =X\left( N-k \right)$$ | (3.5.40) |
| ---- | :-----------------------------------------: | -------: |

 

##### 	2．奇偶序列的DFT

​	1）奇序列的DFT 

​	当序列是奇对称时，即

|      | $$x\left( n \right) =-x\left( -n \right) =-x\left( N-n \right) $$ | (3.5.41) |
| ---- | :----------------------------------------------------------: | -------: |

则其离散傅里叶变换也是奇对称的，即

|      | $$X\left( k \right) =-X\left( -k \right) =-X\left( N-k \right) $$ | (3.5.42) |
| ---- | :----------------------------------------------------------: | -------: |

证

|      | $$\begin{aligned}X\left( k \right) =\sum_{n=0}^{N-1}{x\left( n \right) W_{N}^{kn}}=\left\{\begin{aligned}\sum_{n=0}^{N-1}{\left[ -x\left( -n \right) \right] W_{N}^{\left( -k \right) \left( -n \right)}}=-X\left( -k \right)\\\sum_{n=0}^{N-1}{\left[ -x\left( N-n \right) \right] W_{N}^{\left( N-k \right) \left( N-n \right)}}=-X\left( N-k \right)\\\end{aligned} \right.\end{aligned} $$ |      |
| ---- | :----------------------------------------------------------: | ---- |

上式证明中，使用了下述关系

|      | $$W_{N}^{\left( N-k \right) \left( N-n \right)}=W_{N}^{N^2}\cdot W_{N}^{-kN}\cdot W_{N}^{-nN}\cdot W_{N}^{kn}=W_{N}^{kn}$$ |      |
| ---- | :----------------------------------------------------------: | ---- |

 

​	 2）偶序列的DFT 

​	当序列是偶对称时，即

|      | $$x\left( n \right) =x\left( -n \right) =x\left( N-n \right) $$ | (3.5.43) |
| ---- | :----------------------------------------------------------: | -------: |

则其离散傅里叶变换也是偶对称的，即

|      | $$X\left( k \right) =X\left( -k \right) =X\left( N-k \right) $$ | (3.5.44) |
| ---- | :----------------------------------------------------------: | -------: |

可用1.中相似的方法证明。

 

​	3．共轭复序列的DFT

​	若$$x^*\left( n \right)$$为$$x\left( n \right)$$的共辄复数序列，则

|      | $$\mathrm{DFT}\!\:\left[ x^*\left( n \right) \right] =X^*\left( N-k \right)$$ | (3.5.45) |
| ---- | :----------------------------------------------------------: | -------: |

 **证**
$$
\mathrm{DFT}\!\:\left[ x^*\left( n \right) \right] =\sum\nolimits_{n=0}^{N-1}{x^*\left( n \right) W_{N}^{nk}}=\left[ \sum\nolimits_{n=0}^{N-1}{x\left( n \right) W_{N}^{-nk}} \right] ^*\mathrm{ }0\le k\le N-1
$$
  由于

|      | $$W_{N}^{nN}=e^{-j\frac{2\pi}{N}nN}=e^{-j2\pi n}=1$$ |      |
| ---- | :--------------------------------------------------: | ---- |

故

|      | $$\begin{aligned}\mathrm{DFT}\left[ x^*\left( n \right) \right] &=\left[ \sum_{n=0}^{N-1}{x\left( n \right) W_{N}^{(N-k)n}} \right] ^*\mathrm{  }\\&=X^*\left( \left( N-k \right) \right) _N\mathrm{}\\&=X^*\left( N-k \right)\end{aligned}$$ |      |
| ---- | :----------------------------------------------------------: | ---- |

​	请注意，$$k=0$$时不能使用等式$$X^*\left( \left( N-k \right) \right) _N=X^*\left( N-k \right)$$，因为这时$$X^*\left( \left( N-0 \right) \right) _N=X^*\left( N-0 \right) =X^*\left( N\right)$$，而$$X\left( k \right)$$只有$$0\le k\le N-1$$范围内的$$N$$个值，所以已超出主值区间。(3.5.45)式的严格公式应该是

|      | $$\mathrm{DFT}\!\:\left[ x^*\left( n \right) \right] =X^*\left( \left( N-k \right) \right) _N$$ | (3.5.46) |
| ---- | :----------------------------------------------------------: | -------- |

这样，当$$k=0$$时有$$X^*\left( \left( N-0 \right) \right) _N=X^*\left( 0 \right)$$的正确结果。因为$$X\left( k \right)$$可认为是分布在$$N$$等分的圆周上，它的末点即它的始点，也即$$X\left( N \right) =X\left( 0 \right)$$。因此仍采用(3.5.45)式的习惯形式。在以下有关对称性的讨论中，凡是$$X\left( N \right)$$都认为是$$X\left( \left( N \right) \right) _N=X\left( 0 \right)$$。

 

##### 	4．复数序列的DFT

​	若有限长序列$$x\left( n \right)$$是一复数序列，设$$x_r\left( n \right)$$及$$jx_i\left( n \right)$$分别表示$$x\left( n \right)$$的实部与虚部，即

|      | $$x\left( n \right) =x_r\left( n \right) +jx_i\left( n \right) $$ | (3.5.47) |
| ---- | :----------------------------------------------------------: | -------: |

而

|      | $$\left\{ \begin{array}{c}x_r\left( n \right) =\frac{1}{2}\left[ x\left( n \right) +x^*\left( n \right) \right]\\	jx_i\left( n \right) =\frac{1}{2}\left[ x\left( n \right) -x^*\left( n \right) \right]\\\end{array} \right. $$ | (3.5.48) |
| ---- | :----------------------------------------------------------: | -------: |

我们以$$x_{ep}\left( k \right)$$及$$x_{op}\left( k \right)$$分别表示实部及虚部序列的DFT，则

|      | $$\begin{aligned}X_{ep}\left( k \right) &=\mathrm{DFT}\!\:\left[ x_r\left( n \right) \right] \mathrm{}\\&=\frac{1}{2}\mathrm{DFT}\left[ x\left( n \right) +x^*\left( n \right) \right] \mathrm{}\\&=\frac{1}{2}\left[ X\left( k \right) +X^*\left( N-k \right) \right] \end{aligned}$$ | (3.5.49) |
| ---- | :----------------------------------------------------------: | -------: |
|      | $$\begin{aligned}X_{op}\left( k \right) &=\mathrm{DFT}\left[ jx_i\left( n \right) \right] \mathrm{}\\&=\frac{1}{2}\mathrm{DFT}\left[ x\left( n \right) -x^*\left( n \right) \right] \mathrm{ }\\&=\frac{1}{2}\left[ X\left( k \right) -X^*\left( N-k \right) \right] \end{aligned}$$ | (3.5.50) |

  根据线性特性

|      | $$X\left( k \right) =X_{ep}\left( k \right) +X_{op}\left( k \right) $$ | (3.5.51) |
| ---- | :----------------------------------------------------------: | -------: |

注意，这里$$X_{ep}\left( k \right)$$和$$X_{op}\left( k \right)$$均为复数，所以 (3.5.51) 式右端总的实部和总的虚部还是不能直接表示出来。

现在分析一下$$X_{ep}\left( k \right)$$与$$X_{op}\left( k \right)$$的一些对称特性。由 (3.5.49) 式得

|      | $$\begin{aligned}X_{ep}^{*}\left( N-k \right) &=\frac{1}{2}\left[ X\left( N-k \right) +X^*\left( N-N+k \right) \right] ^*\mathrm{  }\\&=\frac{1}{2}\left[ X^*\left( N-k \right) +X\left( k \right) \right] \end{aligned}$$ | (3.5.52) |
| ---- | :----------------------------------------------------------: | -------: |

与(3.5.49)式比较，可知

|      | $$X_{ep}\left( k \right) =X_{ep}^{*}\left( N-k \right) $$ | (3.5.53) |
| ---- | :-------------------------------------------------------: | -------: |

因此$$X_{ep}\left( k \right)$$称为$$X\left( k \right)$$的周期性共轭对称分量，其含义在前面已经说明。由此可认为$$X_{ep}\left( k \right)$$是分布在$N$等分圆周上，则以$k=0$为原点，$$X_{ep}\left( k \right)$$在左半圆上的序列与右半圆上的序列是共轭对称的。图3.5.11直观地表示了$$X_{ep}\left( k \right)$$为实数时的示意图。若$$X_{ep}\left( k \right)$$为复数，则其共轭对称的含义是模相等，幅角相反，即

|      | $$\left\{ \begin{array}{c}\left| X_{ep}\left( k \right) \right|=\left|X_{ep}\left( N-k \right) \right|\\	arg\!\:\left[ X_{ep}\left( k \right) \right] =-arg\!\:\left[ X_{ep}\left( N-k \right)\right]\\\end{array} \right. $$ | (3.5.54) |
| ---- | :----------------------------------------------------------: | -------: |

或说实部相等，虚部相反。

​	根据(3.5.50)可以推得

|      | $$X_{op}\left( k \right) =-X_{op}^{*}\left( N-k \right) $$ | (3.5.55) |
| ---- | :--------------------------------------------------------: | -------: |

$$X_{op}\left( k \right)$$称为$$X\left( k \right)$$的周期性共轭反对称分量，它表示$$X_{op}\left( k \right)$$分布在圆周上时，以$k=0$为中心，$$X_{op}\left( k \right)$$在左半圆上的序列与$$X_{op}\left( k \right)$$在右半圆上的序列是共轭反对称的。图3.5.12是$$X_{op}\left( k \right)$$为实数时的示意图。当$$X_{op}\left( k \right)$$为复数时，则应按(3.5.55)式的意义去理解共轭反对称，即实部相反，虚部相等。

|      | $$\left\{ \begin{array}{c}	\left|X_{op}\left( k \right) \right|=-\left|X_{op}\left( N-k \right) \right|\\	arg\!\:\left[ X_{op}\left( k \right) \right] =arg\!\:\left[ X_{op}\left( N-k \right)\right]\\\end{array} \right. $$ | (3.5.56) |
| ---- | :----------------------------------------------------------: | -------: |

​	通过上面的分析可知，对于一复时间序列的DFT来说，序列的实部对应于$$X\left( k \right)$$的周期性共轭对称分量$$X_{ep}\left( k \right)$$；序列的虚部对应于$$X\left( k \right)$$的周期性共轭反对称分量$$X_{op}\left( k \right)$$。这种结果是有一定意义的。我们可以把两个实数序列$$x_{1}\left( n \right)$$和$$x_{2}\left( n \right)$$组合为单一的复数函数$$x\left( n \right)$$，如(3.5.47)式所示。当算出复数表示的$$X\left( k \right)$$后，即可利用(3.5.49)式，(3.5.50)式将$$X\left( k \right)$$分成两个独立的分量$$X_{ep}\left( k \right)$$和$$X_{op}\left( k \right)$$，它们分别对应于$$x_{1}\left( n \right)$$和$$x_{2}\left( n \right)$$的离散傅里叶变换。因此利用这种方法，在一次计算中即可得出两个独立信号的变换。

​	根据$$x_{1}\left( n \right)$$与$$x_{2}\left( n \right)$$的对称特性，同样可以找到$$X\left( k \right)$$的实部、虚部与$$x\left( n \right)$$的周期性共轭对称分量$$X_{ep}\left( k \right)$$、周期性共轭反对称分量$$X_{op}\left( k \right)$$的关系。请读者自行证明：$$X_{ep}\left( k \right)$$的DFT是$$X\left( k \right)$$的实部$\mathrm{Re}\left[ X\left( k \right) \right] $，$$X_{op}\left( k \right)$$的DFT是$$X\left( k \right)$$的虚部$j\mathrm{Im}\left[ X\left( k \right) \right]$。

 ![](.\fig\3.5.11.png) 



  图3.5.11周期性共轭对称分量$$X_{ep}\left( k \right)$$

![](.\fig\3.5.12.png)

 图3.5.12周期性共轭反对称分量$$X_{op}\left( k \right)$$



##### 5．虚实序列的DFT

1）虚序列的DFT

当序列是纯虚序列，即$$x\left( n \right) =jx_i\left( n \right)$$时，则由(3.5.50)式知其$$X\left( k \right)$$只有周期性共轭反对称分量，即$$X\left( k \right) =X_{op}\left( k \right)$$，由(3.5.54)式可见，虚序列的离散傅里叶变换$$X\left( k \right)$$的实部是奇对称的，虚部是偶对称的。

2）实序列的DFT

若$$x\left( n \right)$$是纯实数序列，即$$x\left( n \right) =x_r\left( n \right)$$时，由(3.5.49)式知其$$X\left( k \right)$$只有周期性共轭对称分量，即$$X\left( k \right) =X_{ep}\left( k \right)$$，由(3.5.54)式知，其模是偶函数，而相角是奇函数，或者说，其实部是偶对称的，而虚部是奇对称的。

上述两种情况不论那一种都只要知道一半数目的$$X\left( k \right)$$，利用对称特性就可以得到另一半数目的$$X\left( k \right)$$。在DFT运算中利用这个特点，可以提高运算效率。

联合考虑序列的奇偶持性及虚实特性，还可证明如下特性：

(1)   当序列是实的偶对称序列，则其离散傅里叶变换是实的偶对称的。

(2)   当序列是实的奇对称的序列，则其离散傅里叶变换是虚的奇对称的。

(3)   当序列是虚的偶对称的序列，则其离散傅里叶变换是虚的偶对称的。

(4)   当序列是虚的奇对称序列时，则其离散傅里叶变换是实的奇对称的。

在结束有关奇偶性及对称性的讨论时，为便于学习和比较，我们将DFT的奇偶虚实特性列于表3.5.1中

|      | DFT的奇偶虚实特性 | 表3.5.1 |
| ---- | :---------------: | ------: |

| $$x\left( n \right)$$ | $$X\left( k \right)$$ |
| :-------------------: | :-------------------: |
|        偶序列         |        偶序列         |
|        奇序列         |        奇序列         |
|          实           |  实部为偶，虚部为奇   |
|          虚           |  实部为奇，虚部为偶   |
|         实偶          |         实偶          |
|         实奇          |         虚奇          |
|         虚偶          |         虚偶          |
|         虚奇          |         实奇          |

 

根据$$x\left( n \right)$$与$$X\left( k \right)$$变换关系的对称性，只要交换$x\left(n\right)$和$X\left( k \right)$列的标题，表中各项仍然是正确的。

应该指出，为了更有效地运用计算程序和更好地理解所得结果，对上述特性应深入地理解。

### 3.5.13. 离散傅里叶变换可看作一组滤波器

​	序列$$x\left( n \right)$$的离散傅里叶变换

|      | $$\begin{aligned}X\left( k \right) &=DFT\!\:\left[ x\left( n \right) \right] =\sum_{n=0}^{N-1}{x}\left( n \right) W_{N}^{nk}\mathrm{ }\\&=x\left( 0 \right) +x\left( 1 \right) W_{N}^{k}+x\left( 2 \right) W_{N}^{2k}+x\left( 3 \right) W_{N}^{3k}+\cdots +x\left( N-1 \right) W_{N}^{\left( N-1 \right) k}\end{aligned}$$ | (3.5.57) |
| ---- | :----------------------------------------------------------: | -------: |

$$X\left( k \right)$$为序列$$x\left( n \right)$$中$k$频率分量的大小，可看作如下的卷积形式

|      | $$\begin{aligned}X\left( k \right) =\sum_{n=0}^{N-1}{x\left( n \right) h_k\left( N-1-n \right)}\end{aligned}$$ | (3.5.58) |
| ---- | :----------------------------------------------------------: | -------: |

​	令系统的单位采样响应为

|      | $$h_k\left( n \right) =\left\{ \begin{matrix}	W_{N}^{\left( N-1-n \right) k}&n=0,1,2,\cdots N-1\\0&n<0\text{和}n\ge N\end{matrix} \right.$$ | (3.5.59) |
| ---- | :----------------------------------------------------------: | -------: |

输入序列为

|      | $$0,0,0,x\left( 0 \right) ,x\left( 1 \right) ,x\left( 2 \right) ,\cdots x\left( N-1 \right) ,0,0,0\cdots  $$ |      |
| ---- | :----------------------------------------------------------: | ---- |

此输入序列加入到单位采样响应为$$h_k\left( n \right)$$的滤波器后，在$$\left( N-1 \right)$$时刻的输出为

|      | $$\begin{aligned}y\left( N-1 \right) &=\sum_{n=0}^{N-1}{x}\left( n \right) h_k\left( N-1-n \right) \mathrm{ }\\&=x\left( 0 \right) h_k\left( N-1 \right) +x\left( 1 \right) h_k\left( N-2 \right) +x\left( 2 \right) h_k\left( N-3 \right) +\cdots +x\left( N-1 \right) h_k(0)\mathrm{ }\\&=x\left( 0 \right) W_{N}^{\left( N-1-N+1 \right) k}+x\left( 1 \right) W_{N}^{\left( N-1-N+2 \right) k}+x\left( 2 \right) W_{N}^{\left( N-1-N+3 \right) k}+\cdots +x\left( N-1 \right) W_{N}^{(N-1)k}\mathrm{ }\\&=x\left( 0 \right) +x\left( 1 \right) W_{N}^{k}+x\left( 2 \right) W_{N}^{2k}+x\left( 3 \right) W_{N}^{3k}+\cdots +x\left( N-1 \right) W_{N}^{(N-1)k}\end{aligned}$$ | (3.5.60) |
| ---- | :----------------------------------------------------------: | -------: |

​	比较(3.5.57)式和(3.5.60)式可见，二者的结果是一样的。因此，求序列$$x\left( n \right)$$的离散傅里叶变换$$X\left( k \right)$$的过程相当于以序列$$x\left( n \right)$$为输入，加到单位采样响应为$$h_k\left( n \right)$$的滤波器，其在$$(N-1)$$时刻的输出就是$$X\left( k \right)$$。由(3.5.59)式可见，$$(N-1)$$与$$k$$值有关，一定的$$k$$值对应一定的单位采样响应，取不同的$$k$$值可得不同的单位采样响应，分别对应不同滤波特性的数字滤波器。把$$k$$值取在$$0\le k\le N-1$$区间，就可得$$N$$个不同滤波特性的数字滤波器。对$$x\left( n \right)$$实施$$N$$个滤波器的滤波运算就可分别得到$$N$$个不同$$k$$值的$$X\left( k \right)$$。所以离散傅里叶变换可看作一组滤波器。

​	下面分析这组滤波器的频率特性。为此先对$$h_k\left( n \right)$$作$$z$$变换可得

|      | $$\begin{aligned}H_k\left( z \right) &=\sum_{n=0}^{N-1}{h_k\left( n \right) z^{-n}}\mathrm{}\\&=\sum_{n=0}^{N-1}{W_{N}^{(N-1-n)k}}z^{-n}\mathrm{ }\\&=W_{N}^{\left( N-1 \right) k}\sum_{n=0}^{N-1}{\left( W_{N}^{-k}z^{-1} \right) ^n}\mathrm{ }\\&=W_{N}^{\left( N-1 \right) k}\frac{1-z^{-N}W_{N}^{-Nk}}{1-z^{-1}W_{N}^{-k}}\end{aligned}$$ | (3.5.61) |
| ---: | :----------------------------------------------------------: | -------: |

我们知道$$W_N=e^{-j\frac{2\pi}{N}}$$同时令$$z=e^{j\omega}$$，代入上式，得出滤波器的振幅频率特性为
$$
\left| H_k\left( e^{j\omega} \right) \right|=\left| \frac{1-\left( e^{j\omega} \right) ^{-N}\left( e^{j\frac{2\pi}{N}k} \right) ^N}{1-\left( e^{j\omega} \right) ^{-1}\left( e^{j\frac{2\pi}{N}k} \right) ^1} \right|=\left| \frac{e^{j\frac{N}{2}}\left( \omega -\frac{2\pi}{N}k \right) -e^{-j\frac{N}{2}}\left( \omega -\frac{2\pi}{N}k \right)}{e^{j\frac{1}{2}}\left( \omega -\frac{2\pi}{N}k \right) -e^{-j\frac{1}{2}}\left( \omega -\frac{2\pi}{N}k \right)} \right|
$$
根据公式$$sin\!\:x=\frac{e^{jx}-e^{-jx}}{2j}$$可得

|      | $$\begin{aligned}\left| H_k\left(e^{j\omega} \right) \right|=\left| \frac{sin\!\:\frac{N}{2}\left( \omega -\frac{2\pi}{N}k \right)}{sin\!\:\frac{1}{2}\left( \omega -\frac{2\pi}{N}k \right)} \right|\end{aligned}$$ | (3.5.62) |
| ---- | :----------------------------------------------------------: | -------: |

若令$$x=\frac{1}{2}\left( \omega -\frac{2\pi}{N}k \right)$$，则这种振幅频率特性具有$$\frac{sin\!\:Nx}{sin\!\:x}$$的形式。在$$k=0$$时，

|      | $\begin{aligned}H_0=\left|\frac{sin\!\:\frac{N\omega}{2}}{sin\!\:\frac{\omega}{2}} \right|\end{aligned}$ |      |
| ---- | :----------------------------------------------------------: | ---- |

也是一种$$\frac{sin\!\:Nx}{sin\!\:x}$$的频率响应特性，当$$\omega =0$$时，$$H_0=N$$，可作出其振幅特性如图3.5.13所示，第一副瓣电平约为-13.3dB。

![](.\fig\3.5.13.png)

图3.5.13 $$k=0$$时，$$H_0$$的归一化振幅特性

​	若$$k\ne 0$$，而是等于$$1,2,3,\cdots N-1$$，则由(3-96)式可得出一组滤波器的振幅特性如图3.5.14所示。图中$$N=8$$。各$$H_k$$的响应形式和$$H_0$$一样，最大幅值也为$$N$$，差别在于主瓣移到了$$\omega =\frac{2\pi}{N}k$$上。这些滤波器中心频率的间隔为$$\omega =\frac{2\pi}{N}$$。

![](.\fig\3.5.14.png)

图3.5.14 $$N=8$$时，不同k值的$$H_k$$的振幅特性

因此，在频域我们进一步看到了离散傅里叶变换相当于用中心频率为$$\omega =\frac{2\pi}{N}$$（$$k=0,1,2,\cdots N-1$$）的频率响应形式为$$\frac{sin\!\:Nx}{sin\!\:x}$$的$$N$$个滤波器对输入序列进行滤波。因为$$\omega =\varOmega T=\frac{\varOmega}{f_s}$$，在$$\omega =\frac{2\pi}{N}$$时，有$$\varOmega =\frac{2\pi}{N}f_s=\frac{2\pi}{NT}$$。故当$$\omega =\frac{k2\pi}{N}$$时这些滤波器在$$\left( N-1 \right) $$时刻的输出即是频率分量为$$k\varOmega$$的傅里叶系数$$X\left( k \right)$$。当输入序列$$x\left( n \right)$$中所含频率分量不是$$\varOmega$$的整倍数，而是在$$\left( k-1 \right) \varOmega$$和$$k\varOmega$$之间时，则输入序列经傅里叶变换后在各个滤波器的输出端都可能有它的输出响应，而在第$$k$$个及第$$\left( k-1 \right)$$个滤波器的输出响应中，将有一个或两个都具有较大值。所以利用离散傅里叶变换进行谱分析时，分辨能力决定于频谱谱线间隔$$\varOmega =\frac{2\pi}{NT}=2\pi \frac{f_1}{N}$$并称$$\frac{f_1}{N}$$为频率分辨率或频率分辨单元。

​	离散傅里叶变换相当于一组滤波器的这一性质，使得它在实现脉冲多卜勒雷达信号处理中得到了广泛的应用。

### 3.5.14. DFT与Z变换

列长为$$N$$的有限长序列$$x\left( n \right)$$的$$z$$变换为$$X\left( z \right)$$，而其离散傅里叶变换为$$X\left( k \right)$$，$$X\left( z \right)$$，$$X\left( k \right)$$二者均表示了同一有限长序列$$x\left( n \right)$$的变换，它们之间的关系是：对$$z$$变换采样可得 DFT，而DFT的综合就是Z变换。

由前面的讨论可知，有限长序列$$z$$变换的收敛域是全部$$z$$平面，自然也包含了$$z$$平面的单位圆。如果在单位圆上等间隔取$$N$$个点，如图3.5.15(a)所示，则在此$$N$$个点处的$$z$$变换值为

|      | $$\begin{aligned}X\left( z_k \right) &=\sum_{n=0}^{N-1}{x\left( n \right)}\left. z^{-n} \right|_{z=z_k=e^{\left( j\frac{2\pi}{N}k \right)}=W_{N}^{-k}}\mathrm{}\\&=\sum_{n=0}^{N-1}{x\left( n \right) W_{N}^{nk}}\mathrm{}\\&=\mathrm{DFT}\left[ x\left( n \right) \right] \mathrm{}\\&=X\left( k \right) \end{aligned}$$ | (3.5.63) |
| ---- | :----------------------------------------------------------: | -------: |



$$z_k=W_{N}^{-k}=e^{j\left( \frac{2\pi}{N} \right) k}$$是平面单位圆上幅角为 $$\omega =\frac{2\pi}{N}k$$的点，即$$z$$平面上单位圆等$$N$$分后的第$$k$$点。所以$$x\left( n \right)$$DFT的$$N$$个系数$$X\left( k \right)$$也即$$x\left( n \right)$$的$$z$$变换$$X\left( z \right)$$单位圆上等距离的采样值，如图3.5.15(b)所示。$$z$$变换在单位圆上的值就是$$X\left( e^{j\omega}\right)$$。所以也可以说，$$X\left( k\right)$$是序列傅氏变换$$X\left( e^{j\omega} \right)$$在相应点$$\omega =\frac{2\pi}{N}k=k\omega _N$$上的采样值，其采样间隔为$$\omega =\frac{2\pi}{N}k$$，即
$$
\left\{ \begin{array}{c}
	X\left( k \right) =X\left( e^{jk\omega _N} \right)\\
	\omega _N=\frac{2\pi}{N}\\
\end{array} \right.
$$
由此可见，$$z$$变换的采样可得DFT。

![](.\fig\3.5.15.png)

图3.5.15 DFT与$$z$$变换

(a)$$z$$平面单位圆上等间隔采样的各点

(b)$$X\left( k\right)$$是序列傅氏变换$$X\left( e^{j\omega}\right)$$的采样值

# 3.6 频域采样

由上面讨论可知，采用$DFT$后实现了频域采样。对于任意一个频率特性能否用频率采样的办法去逼近呢？为此，首先应弄清它的限制。再研究经过频率采样后会有什么误差？如何消除误差？采样后所获得的频率特性怎样？

## 3.6.1.对X(z)采样时采样点数的限制

对任一绝对可和的非周期序列x(n)的z变换x(z)在单位圆上，即对
$X\left( {{{\rm{e}}^{j\omega }}} \right)$进行等距采样，则由(3.5.63)式得

$x(k) = x(z)\left| {_{x = w_N^{ - k}}} \right. = \sum\limits_{n =  - \infty }^\infty  {x(n)W_N^{nk}} $

现在要问，实现频域采样以后，信息有没有损失？能不能用序列的频谱$X\left( {{{\rm{e}}^{j\omega }}} \right)$的采样值$x(k)$恢复出原序列$x(n)$设频率采样后所得的x(k)恢复出的有限长序列为$x'(n)$，则

$x'(n) = IDFT[x(k)]$

为了易于看清上述问题，我们先从周期序列$\hat x(t)$开始研究

$\tilde x(n) = IDFS[\tilde x(k)] = \frac{1}{N}\sum\limits_{k = 0}^{N - 1} {\tilde X(k)W_N^{ - kn}}  = \frac{1}{N}\sum\limits_{k = 0}^{N - 1} {X(k)W_N^{ - kn}} $

为探索频率采样后所恢复出的序列$x'(n)$和原序列$x(n)$之间的关系，将(3.6.1)代入上式

$\tilde x(n) =  = \frac{1}{N}\sum\limits_{k = 0}^{N - 1} {[\sum\limits_{m =  - \infty }^\infty  {x(m)W_N^{mk}} ]W_N^{ - kn} = \sum\limits_{m =  - \infty }^\infty  {x(m)} } [\frac{1}{N}\sum\limits_{k = 0}^{N - 1} {X(k)W_N^{ - kn}} ]$

由于

$\frac{1}{N}\sum\limits_{k = 0}^{N - 1} {W_N^{(m - n)k} = \left\{ {\begin{array}{*{20}{c}}
1\\
0
\end{array}} \right.} $

(3.6.2)式说明$\hat x(t)$是原序列$x(n)$以N为周期的周期延拓序列。在第二章我们看到了时域的采样造成频域的周期延拓，现在我们又证明了频域上的采样，同样也造成时域的周期延拓。这正是傅氏变换中时域频域对称关系的反映。

如果$x(n)$是列长为M的有限长序列，则当频域采样点数$N<M$时，即频域的采样间隔不够密，$x(n)$的周期延拓就会出现某些序列交叠在一起，产生混叠现象。这样就不可能从$\hat x(t)$中提取一个周期不失真地恢复出原序列$x(n)$来。因此对于列长为$M$的有限长序列$x(n)$，频率采样不失真的条件是$N \ge M$这时有

${\rm{x'}}(n) = \tilde x'(n){R_N}(n) = \sum\limits_{r =  - \infty }^\infty  {x(n + rN){R_N}(n) = x(n)} $

明显可见，当$x(n)$为无限长序列时，无论$N$取什么值， $x'(n)$都将不可能完全消除混叠误差, 只能随着采样点$N$的增加而逐渐接近$x(n)$。

## 3.6.2 .X(z)的内插公式

由上分析可知，列长为$N$的有限长序列$x(n)$，可从单位圆上$x(z)$的$N$个采样值$x(k)$ 即$x(n)$的DFT恢复，因而这$N$个$X(K)$也应该能完全表达整个$X(K)$函数及频响，也可以说DFT的$X\left( {{{\rm{e}}^{j\omega }}} \right)$综合就是Z变换。这进一步揭示了 DFT与$Z$变换的关系。

$\left\{ {\begin{array}{*{20}{c}}
{x(n) = \frac{1}{N}\sum\limits_{k = 0}^{N - 1} {X(k)W_N^{ - nk}} }\\
{X(Z) = \sum\limits_{n = 0}^{N - 1} {x(n){Z^{ - n}}} }
\end{array}} \right.$

将$x(n)$的表达式代入上式得

$X(z) = \sum\limits_{n = 0}^{N - 1} {[\frac{1}{N}\sum\limits_{k = 0}^{N - 1} {X(k)W_N^{ - nk}} ]{Z^{ - n}}} $

$ = \frac{1}{N}{\sum\limits_{k = 0}^{N - 1} {X(k)\sum\limits_{n = 0}^{N - 1} {(W_N^{ - k}{z^{ - 1}})} } ^n}$

$ = \frac{1}{N}\sum\limits_{k = 0}^{N - 1} {X(k)} \frac{{1 - W_N^{ - kN}{z^{ - N}}}}{{1 - W_N^{ - k}{z^{ - 1}}}}W_N^{ - kN}$

$ = {e^{j\frac{{2\pi }}{N}kN}}$

$=1$

故得

$x(z) = \frac{{1 - {z^{ - N}}}}{N}\sum\limits_{k = 0}^{N - 1} {\frac{{X(k)}}{{1 - W_N^{ - k}{z^{ - 1}}}}} $

这就是$x(z)$的内插公式。在已知$x(k)$时，可据内插公式求得任意z点的$x(z)$值，因此$x(z)$的$N$个采样点的$x(k)$值，包含了$Z$变换的全部信息。(3.6.4)式中的内插函数是${\phi _k}(z)$

|      | $x(z) = \sum\limits_{k = 0}^{N - 1} {X(k){\phi _k}} (z)$     | (3.6.5) |
| ---- | ------------------------------------------------------------ | ------- |
|      | ${\phi _k}(z) = \frac{1}{N}\frac{{1 - {z^{ - N}}}}{{1 - W_N^{ - k}{z^{ - 1}}}}$ | (3.6.6) |

通过代换z={e^{jw}}，可以得到序列$x(n)$的频响

|      | $X({e^{j\omega }}) = \sum\limits_{k = 0}^{N - 1} {X(k){\phi _k}({e^{j\omega }})} $ | (3.6.7) |
| ---- | ------------------------------------------------------------ | ------- |
|      |                                                              |         |

 

| ${\phi _k}\left( {{{\rm{e}}^{j\omega }}} \right) = \frac{1}{N}\frac{{1 - {{\rm{e}}^{ - jN\omega }}}}{{1 - {{\rm{e}}^{ - j\left( {\omega  - k\frac{{2\pi }}{N}} \right)}}}}$ |      |      |
| ------------------------------------------------------------ | ---- | ---- |
| ${\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt}  = \frac{1}{N}\frac{{\sin \left( {\frac{{\omega N}}{2}} \right)}}{{\sin \left[ {\left( {\omega  - \frac{{k2\pi }}{N}} \right)/2} \right]}} \cdot {{\rm{e}}^{ - j\left( {\frac{{N\omega }}{2} - \frac{\omega }{2} + \frac{{k\pi }}{N}} \right)}}$ |      |      |

可将${\phi _k}({e^{j \omega}})$表示为更明了的形式

|      | ${\phi _k}({e^{j\omega }}) = \phi (\omega  - k\frac{{2\pi }}{N})$ |         |
| ---- | ------------------------------------------------------------ | ------- |
|      | $\phi (\omega ) = \frac{1}{N}\frac{{\sin (\frac{{\omega N}}{2})}}{{\frac{\omega }{2}}}{e^{ - j\omega (\frac{{N - 1}}{2})}}$ | (3.6.9) |

因此

|      | $X({e^{j\omega }}) = \sum\limits_{k = 0}^{N - 1} {X(k)\phi (\omega  - k\frac{{2\pi }}{N})} $ | (3.6.10) |
| ---- | ------------------------------------------------------------ | -------- |
|      |                                                              |          |

内插函数$\phi (\omega )$的振幅与相位特性示于图3.6.1。当其变量$\omega=0$(本采样点)时$\phi (\omega )$=1，在其余采样点($\omega  = i\frac{{2\pi }}{N},i = 1,2....N - 1$)上，$\phi (\omega )$=0。因而可知，有以下关系

| $\phi \left( {\omega  - k\frac{{2\pi }}{N}} \right) = \left\{ {\begin{array}{*{20}{c}}<br/>1&{\omega  = k\frac{{2\pi }}{N}}\\<br/>0&{\begin{array}{*{20}{c}}<br/>{\omega  = i\frac{{2\pi }}{N},}&{i \ne k}<br/>\end{array}}<br/>\end{array}} \right.$ |      |      |
| ------------------------------------------------------------ | ---- | ---- |
|                                                              |      |      |

 

![](.\fig\3.6.1.png) 

图3.6.1 内插函数振幅特性与相位特性

即函数$\phi (\omega  - k\frac{{2\pi }}{N})$在本采样点（$\omega  = k\frac{{2\pi }}{N}$,）上为1，而在其他采样点（）上$\omega  = k\frac{{2\pi }}{N}$其值为0。整个正是$X\left( {{{\rm{e}}^{j\omega }}} \right)$正是N个$\phi (\omega  - k\frac{{2\pi }}{N})$函数乘上加权$x(k)$之和。明显可见，各个采样点处的$X\left( {{{\rm{e}}^{j\omega }}} \right)$就等于各 $x(k)$值，因为其余采样点的内插函数在这里都为零值.而采样点之间的值则由各采样值乘$X\left( {{{\rm{e}}^{j\omega }}} \right)$相应的内插函数延伸叠加所形成。

内插函数的另一重要特点是具有如图3.6.1所示的线性相移特性。

总结以上所述，对于有限长序列的$x(z)$及可$X\left( {{{\rm{e}}^{j\omega }}} \right)$有时域序列$x(n)$与频域序列$x(k)$表示的两套表达式

|      | $\left\{ {\begin{array}{*{20}{c}}<br/>{X(z) = \sum\limits_{n = 0}^{N - 1} {x(n){Z^{ - n}}} }\\<br/>{X(z) = \sum\limits_{k = 0}^{N - 1} {X(k){\phi _k}(z)} }<br/>\end{array}} \right.$ |      |
| ---- | ------------------------------------------------------------ | ---- |
|      |                                                              |      |

及

|      | $\left\{ {\begin{array}{*{20}{c}}<br/>{X({e^{j\omega }}) = \sum\limits_{n = 0}^{N - 1} {x(n){e^{ - j\omega n}}} }\\<br/>{X({e^{j\omega }}) = \sum\limits_{k = 0}^{N - 1} {X(k){\phi _k}(\omega  - \frac{{k2\pi }}{N})} }<br/>\end{array}} \right.$ |      |
| ---- | ------------------------------------------------------------ | ---- |
|      |                                                              |      |

 

时域采样定理说明，一个频带有限的信号，可对其进行时域采样而不丢失任何信息，因而,可用数字技术加工时域上的信号。频域采样理论说明，时间有限的信号(有限长序列)，也可对其频域采样(DFT)而不丢失任何信息。DFT的理论使信号不仅在时域，而且在频域也离散化了，因而开辟了在频域釆用数字技术处理的领域，而快速傅里叶变换FFT是计算DFT的快速有效算法。

## 3.7 用$DFT$对连续时间信号逼近的问题

$DFT$的数学性质是确切的，但在许多信号处理的应用中，却很少作为一个最终目的被采用。我们对$DFT$感兴趣主要是因为它是连续傅里叶变换的一个近似。为了利用$DFT$对连续时间信号${x_a}\left( t \right)$进行傅里叶分析，则需先对${x_a}\left( t \right)$进行采样，得到$x\left( n \right)$，再对$x\left( n \right)$进行$DFT$得$X\left( k \right)$。$X\left( k \right)$是$x\left( n \right)$的傅里叶变换$X\left( {{{\rm{e}}^{j\omega }}} \right)$在频率区间[0, 2π]上的$N$点等间隔采样。这里$x\left( n \right)$和$X\left( k \right)$均为有限长序列。但是，由傅里叶变换理论可知，若信号的持续时间为有限长、则其频谱无限宽；若信号的频谱为有限宽，则其持续时间无限长。严格地讲持续时间有限的带限信号是不存在的。

为能满足$DFT$的变换条件，实际上对频谱很宽的信号，为防止时域采样后产生频谱混叠失真，可用前置滤波器滤除幅度较小的高频分量，使连续时间信号的带宽小于折叠频率。对于持续时间很长的信号，采样点数太多以致无法存贮和计算，只好截取为有限列长进行$DFT$。从工程实际角度看，滤除幅度很小的高频分量和截去幅度很小部分的时间信号是允许的。

由上述可见，用$DFT$对连续时间信号进行傅里叶分析必然是近似的，近似的准确程度严格地说是被分析波形的一个函数。特別要指出，两个变换之间的差异是因$DFT$需要对连续时间信号采样和截断为有限列长而产生的。这里主要有两个问题，即两变换间相对数值的确定；以及在计算的变换与所需的变换之间造成误差的三种可能现象：混叠现象、栅栏效应和频谱泄漏。下面分别讨论之。

### 3.7.1.计算的变换与所需变换间相对数值的确定

假设连续时间非周期性信号的变换定义为 (3.2.1)式和 (3.2.2)式，而周期信号的傅里叶级数的定义则为 (3.2.3)式和 (3.2.4)式。$DFT$的计算可以按 (3.2.1)式所定义的非周期信号的傅里叶变换，或 (3.2.3)式所定义的周期信号的傅里叶系数的近似来进行。

如果我们采用$DFT$的基本定义式 (3.4.1)式去计算一个非周期性信号的傅里叶变换，则频谱的正常幅度电平等于用$DFT$计算所得的频谱分量乘以$T$。

如果已利用真实积分变换定义 (3.2.1)式，或者如上所述，利用$DFT$并乘以T来计算频谱函数，则可用包括因子$1/N$在内的 (3.4.2)式来近似计算 (3.2.2)式所表示的时间函数。在此情况下，最后将各时间分量乘以$NF = f$，即得正常幅度电平。所以从时间到频率，再从频率到时间的整个过程总共乘了$T \cdot NF = 1$也即幅度电平未受影响。

傅里叶级数系数的表示式 (3.2.3)式实际上是求被积式的平均值.如果采用 (3.4.1)式的$DFT$公式来近似确定(3.2.3)式所表示的一周期性函数的傅里叶级数系数时，则频谱的正常幅度电平等于$DFT$所求出的频谱分量乘以$T$，再除以$t_p^{}$（$t_p^{}$为周期性时间函数的有效周期）。由于
$(T/{t_p}) = \left( {1/N} \right)$，因此，如果利用$DFT$的定义(3.4.1)式、(3.4.2)式来计算正规的傅里叶级数，则$\left( {1/N} \right)$因子最好放在$DFT$的正变换式中，而不是逆变换式中。

在许多实际问题中，各变换分量的实际电平往往无关紧要。确定信号特性的是频谱中各分量之间的相对电平，相对电平关系保持不变就可以了。

### 3.7.2.计算的变换与所需变换间的误差

**1．混叠现象**

混叠现象在前面已详细讨论过。避免混叠现象的唯一办法是保证采样率足够高。这就要求在确定采样率之前，对频谱的性质要有所了解。下面着重讨论一下应用$DFT$时，为避免混叠所必须考虑的一些重要参数关系。

假设所处理的离散时间信号是从连续时间函数采样得出的，或者为了分析的目的选取相应的连续时间信号作为参考。并假设所处理的信号是基带信号，在采样前已利用低通模拟滤波器进行前置滤波，以避免高于折叠频率的分量出现。这样为避免混叠现象，则要求采样频率

|      | ${f_s} \ge 2{f_h}$ | (3.7.1) |
| ---- | :----------------: | ------: |


${f_s}$为信号的最高频率，而采样周期$T$必须满足

|      | $T \le \frac{1}{{2{f_s}}}$ | (3.7.2) |
| ---- | :------------------------: | ------: |

设F表示频率分量间的增量，它就是前面提到的频率分辨率$F = \frac{{{f_s}}}{N}$，为${t_p}$最小记录长度，也就是前面提到的周期性函数的有效周期。${t_p}$应按照所需的频率分辨率进行选择

|      | ${t_p} = \frac{1}{F}$ | (3.7.3) |
| ---- | :-------------------: | ------: |

(3.7.2)和(3.7.3)两式说明了在高频容量与频率分辨率间存在着矛盾。增加高频容量，$T$就必然减小，在采样点数N给定的情况下，记录长度必然缩短，从而降低了频率的分辨率。相反，要提高分辨率就必须要增加,在采样点数$N$给定时，必然导致$T$的增加，因而减少了高频的容暈。

在高频容量${f_h}$与频率分辨率$F$两个参数中，保持其中一个不变而增加另一个的唯一办法，就是增加在一记录长度内的点数$N$,如果${f_h}$和都
$F$已给定，则$N$必须满足

|      | $N \ge \frac{{2{f_h}}}{F}$ | (3.7.4) |
| ---- | :------------------------: | ------: |

这是未采用任何特殊数据处理(例如加窗处理)情况下，为实现基本的$DFT$算法所必须满足的最低条件。

***例*** 一估算实数信号频谱的处理器，采样点数必须是2的整数次方，假设对数据未作任何的修正，规定的指标是：

(1) 频率间的分辨率$F \le 0.5Hz$

(2) 信号的最高频率${f_h} \le 250Hz$

求下列参数：

(a) 最短的记录长度

(b) 采样点间的最大时间

(c) 在记录中的最少点数$D$ 

解：

(a)根据要求的分辨力确定最小记录长度

| ${t_p} = \frac{1}{F} = \frac{1}{{0.5}} = 2s$ |
| :------------------------------------------: |

记录长度必须满足

| ${t_p} \ge 2s$ |
| :------------: |

(b)从信号的最高频率确定最大的采样时间间隔

|      | $T \le \frac{1}{{2{f_s}}} = \frac{1}{{2 \times 250Hz}} = 2 \times {10^{ - 3}}s$ |      |
| ---- | :----------------------------------------------------------: | ---- |

(c)记录中的最少点数为

|      | $N \ge \frac{{2{f_h}}}{F} = \frac{{2 \times 250}}{{0.5}} = 1000$ |      |
| ---- | :----------------------------------------------------------: | ---- |

因此该处理器的一个适当的点数选为$N = {2^{10}} = 1024$。



**2．栅栏效应**

栅栏效应是因为用$DFT$计算频谱只限制为基频的整数倍而不可能将频谱视为一连续函数而产生的。就一定意义而言，栅栏效应表现为当用$DFT$计算一整个频谱，就好像通过一个“栅栏”来观看一个图景一样，只能在离散点的地方看到真实图景。如果不附加任何特殊处理，则在两个离散的变换线之间若有一特别大的频谱分量，将无法检测出来。

减少栅栏效应的一个方法就是在原记录末端填加一些零值点来变动时间周期内的点数， 并保持记录不变。从而在保持原有频谱连续形式不变的情况下，变更了谱线的位置。这样，原来看不到的频谱分量就能移动到可见的位置上。

必须注意，当在记录信号末端填加零点时，所用窗函数的宽度却不能由于增加了零点而按较长的长度选择，而必须按照数据记录的实际长度来选择窗函数。关于窗函数的有关知识将在下节介绍。

**例程 3.7.1**

求16点序列$x\left( n \right)$​的频谱及补零到32和64点后的频谱。

```matlab
N1 = 16;
n = 0:15;
x = sin(2*pi*n/N1) + cos(4*pi*n/N1);

N2 = 32;
n2 = 0:31;
x2 = [x, zeros(1,16)]; 

N3 = 64;
n3 = 0:63;
x3 = [x, zeros(1,48)]; 

L1 = 0:15;
dft_16 = fft(x,16);
L2 = 0:31;
dft_32 = fft(x2,32);
L3 = 0:63;
dft_64 = fft(x3,64);

nx = 0:15;
K = 512;
dw = 2*pi/K;
k = 0:511;
X = x*exp(1i*dw*nx'*k);

subplot(4,1,1); plot(k*dw/(2*pi),abs(X));
subplot(4,1,2); stem(L1/N1,abs(dft_16));
subplot(4,1,3); stem(L2/32,abs(dft_32));
subplot(4,1,4); stem(L3/64,abs(dft_64));
```

<img src=".\fig\3.7.1.png" style="zoom: 67%;" >

 

3． 频谱泄漏

实际工作往往需要把信号的观察时间限制在一定的时间间隔之内。设有一延伸到无限远处的离散时间信号${x_1}\left( n \right)$，其频谱为${X_1}\left( {{{\rm{e}}^{j\omega }}} \right)$（仅表示出周期频谱中周期的一部分)如图3.7.1所示。我们无法等待足够长的时间取用无限个数据，因而就要选择一段时间信号进行分析。

<img src=".\fig\3.7.2.png" style="zoom:50%;" >

​                                                                                                       图3.7.1 信号截断时产生的频潜泄漏现象

取用有限个数据，即将信号截断的过程，就等于将信号乘以窗函数。如果窗函数是一矩形窗函数，数据项数突然被截断，而窗内各项数据并不改变，如图中${x_2}\left( n \right)$所示。时域的截断，在频域相当于所研究的波形的频谱${X_1}\left( {{{\rm{e}}^{j\omega }}} \right)$与矩形窗函数频谱周期卷积过程。这一卷积造成的失真频谱见图3.7.1中的${X_2}\left( {{{\rm{e}}^{j\omega }}} \right)$。

<img src=".\fig\3.7.3.png" style="zoom:50%;" >

​                                                                                              图3.7.2频率为${f_s}/N$的整倍数及为${f_s}/N$的非整倍数信号

​                                                                                                             (a)频率为${f_s}/N$的整倍数的信号

​                                                                                                             (b)频率不是${f_s}/N$的整倍数的信号

 

可以看到：频谱分量从其正常频谱扩展开来，称为“泄漏”。又如图3.7.2(a)所示的${x_1}^\prime \left( n \right)$的频率${f_1}$是${f_s}/N$的整倍数，即

|      | ${f_1} = k\frac{{{f_s}}}{N} = \frac{k}{{NT}}$ |      |
| ---- | :-------------------------------------------: | ---- |

这说明在处理长度$NT$内有信号的$k$个整周期。这时由${x_1}^\prime \left( t \right)$构成的以$NT$为周期的周期性信号是连续的。当${x_2}^\prime \left( t \right)$的频率不是${f_s}/N$的整倍数时，则在$NT$的处理长度内，就不是恰好为信号周期的整数倍，由${x_2}^\prime \left( t \right)$以$NT$为周期进行周期延拓所得到的周期性信号就岀现了不连续点，如图3.7.2(b)所示，造成了频谱分量从其正常频谱扩展开来，在$DFT$等效滤波器组的各个副瓣将有大小不同的数值输出。我们再一次看到了频谱泄漏现象。

应该指出，泄漏是不能与混叠完全分开的，因为泄漏将导致频谱的扩展，从而使频谱的最高频率超过折叠频率，造成混叠。

因为我们无法取用无限个数据，所以在进行离散傅里叶变换吋，时域中的截断是必须的，因此泄漏效应是离散傅里叶变换所固有的，必须设法进行抑制。

## **3.8** ***加权技术与窗函数***

由上面分析可以想到要抑制“泄漏”可以通过窗函数加权抑制$DFT$的等效滤波器的振幅特性的副瓣，或用窗函数加权使有限长度的输入信号周期延拓后在边界上尽量减少不连续程度的方法实现。在后面的FIR滤波器设计中，为获得有限长单位采样响应，需要用窗函数截断无限长单位采样响应序列；在功率谱估计中也要用到窗函加权问题。由此可见窗函数加权技术在数字信号处理中的重要地位。

在用窗函数加权时，有一个问题必须注意。一般文献上给出的窗函数$w\left( n \right)$都是偶对称的时间序列，即$w\left( n \right)\quad n =  - \frac{N}{2} \cdots , - 1,0,1, \cdots  + \frac{N}{2}$

这里，$N$是一个偶数，而窗函数议$w\left( n \right)$共有$N+1$个采样值。但实际中常需要单边表示的窗函数，例如在$N$为偶数点的离散傅里叶变换时，处理区间为：$n = 0$\~$N - 1$。因此，必须把偶对称表示的窗函数向右平移$\frac{N}{2}$点，让左端点与$n=0$重合。如除去右端的一个采样值(一般为零值)，则窗函数$w\left( n \right)$便在$n = 0,1,2...N - 1$点上定义，构成了适用于离散傅里叶变换的单边窗函数序列。也可将被加权的序列向左平移$\frac{N}{2}$点，作用是一样的。位移$\frac{N}{2}$点只影响相位特性，并不影响振幅特性。本节主要研究加权的作用及窗函数的性能。

### **3.8.1.** ***加权的作用***

现对离散傅里叶变换的等效滤波器的单位采样响应进行加权，即${h_k}\left( n \right) = w\left( n \right)W_N^{(N - 1 - n)k}$

式中$w\left( n \right)$称为一窗函数，用不同的窗函数对单位采样响应进行加权可以得到等效滤波器不同的振幅频率特性。

若$w\left( n \right) = 1,{\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} n = 0, \cdots  \cdots N - 1$，称为矩形窗。这时加权后的单位采样响应与等效滤波器原有的单位采样响应一样

|      | ${h_k}\left( n \right) = \left\{ {\begin{array}{*{20}{l}}{W_N^{\left( {N - 1 - n} \right)k}}&{n = 0,1,2, \cdots N - 1}\\0&{n < 0{\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} n \ge N}\end{array}} \right.$ | (3.8.1) |
| ---- | ------------------------------------------------------------ | ------- |
|      |                                                              |         |

其频率响应为${H_k}\left( {{{\rm{e}}^{j\omega }}} \right) = \frac{{\sin \left[ {\frac{N}{2}\left( {\omega  - \frac{{2\pi }}{N}k} \right)} \right]}}{{\sin \left[ {\frac{1}{2}\left( {\omega  - \frac{{2\pi }}{N}k} \right)} \right]}}{{\rm{e}}^{ - j\frac{{N - 1}}{2}\left( {\omega  + \frac{{2\pi }}{N}k} \right)}}$

其中$k$为零所对应的频率特性由下式表示$H\left( {{{\rm{e}}^{j\omega }}} \right) = \frac{{\sin \frac{{N\omega }}{2}}}{{\sin \frac{\omega }{2}}}{{\rm{e}}^{ - j\left( {\frac{{N - 1}}{2}} \right)\omega }}$

前已指出，这种频率特性的第一副瓣峰值比$\omega  = 0$处的主瓣峰值低13.3dB,约为主瓣幅度的$1/4$\~$1/5$左右。采用合适的窗函数进行加权，就能使对应的频率特性副瓣压低下来。例如，采用余弦加权

|      | $w(n) = \cos \pi \frac{n}{N}\quad n =  - \frac{N}{2}, \cdots  - 1,01, \cdots  + \frac{N}{2}$ | (3.8.2) |
| ---- | ------------------------------------------------------------ | ------- |
|      |                                                              |         |

为适用于离散傅里叶变换加权，需将偶对称的余弦窗移位$\frac{N}{2}$后而采用正弦窗函数的形式，即

|      | $w\left( n \right) = \cos \left( {\pi \frac{n}{N} - \frac{\pi }{2}} \right) = \sin \pi \frac{n}{N}$ | (3.8.3) |
| ---- | ------------------------------------------------------------ | ------- |
|      |                                                              |         |

这时对应的加权单位采样响应为       

|      | ${h_k}\left( n \right) = \sin \left( {\pi \frac{n}{N}} \right)W_N^{\left( {N - 1 - n} \right)k}\quad n = 0,1,2, \cdots N - 1$ | (3.8.4) |
| ---- | ------------------------------------------------------------ | ------- |
|      |                                                              |         |

其频率特性可通过$z$变换求得
$\begin{array}{l}
{H_k}\left( {{{\rm{e}}^{j\omega }}} \right) = {H_k}{\left. {\left( z \right)} \right|_{z = {{\rm{e}}^{j\omega }}}}\\
{\rm{      }}{\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt}  = \sum\limits_{n = 0}^{N - 1} {\left[ {\sin \left( {\pi \frac{n}{N}} \right)W_N^{\left( {N - 1 - n} \right)k}} \right]{z^{ - n}}} \\
{\rm{      }}{\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt}  = {W^{\left( {N - 1} \right)k}}\sum\limits_{n = 0}^{N - 1} {\left[ {\sin \left( {\pi \frac{n}{N}} \right)W_N^{ - kn}} \right]{z^{ - n}}} 
\end{array}$

暂不考虑求和号外的相移因子$W_N^{\left( {N - 1} \right)k}$可求出

|      | $\begin{array}{l}{H_k}\left( {{{\rm{e}}^{j\omega }}} \right) = \sum\limits_{n = 0}^{N - 1} {\left[ {\sin \left( {\pi \frac{n}{N}} \right){{\rm{e}}^{j\frac{{2\pi }}{N}kn}}} \right]{z^{ - n}}} \\{\rm{        }}{\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\rm{ = }}\frac{1}{{2j}}\sum\limits_{n = 0}^{N - 1} {\left[ {{{\rm{e}}^{j\left( {\frac{{\pi n}}{N}} \right)}} - {{\rm{e}}^{ - j\left( {\frac{{\pi n}}{N}} \right)}}} \right]{{\rm{e}}^{j\frac{{2\pi }}{N}kn}} \cdot {{\rm{e}}^{ - j\omega n}}} \\{\rm{        }}{\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\rm{ = }}\frac{1}{{2j}}\sum\limits_{n = 0}^{N - 1} {{{\rm{e}}^{\left\{ { - jn\left[ {\omega  - \left( {k + \frac{1}{2}} \right)\frac{{2\pi }}{N}} \right]} \right\}}}}  - \frac{1}{{2j}}\sum\limits_{n = 0}^{N - 1} {{{\rm{e}}^{\left\{ { - jn\left[ {\omega  - \left( {k - \frac{1}{2}} \right)\frac{{2\pi }}{N}} \right]} \right\}}}}\end{array}$ | (3.8.5) |
| ---- | ------------------------------------------------------------ | ------- |
|      |                                                              |         |

把上式的最后两求和式总和起来，可得

$\begin{array}{l}
{H_k}\left( {{{\rm{e}}^{j\omega }}} \right) = \frac{1}{{2j}}\left\{ {\frac{{\sin \frac{N}{2}\left[ {\omega  - \left( {k - \frac{1}{2}} \right)\frac{{2\pi }}{N}} \right]}}{{\sin \frac{1}{2}\left[ {\omega  - \left( {k + \frac{1}{2}} \right)\frac{{2\pi }}{N}} \right]}}{e^{ - j\frac{{N - 1}}{2}\left[ {\omega  - \left( {k + \frac{1}{2}} \right)\frac{{2\pi }}{N}} \right]}} - \frac{{\sin \frac{N}{2}\left[ {\omega  - \left( {k - \frac{1}{2}} \right)\frac{{2\pi }}{N}} \right]}}{{\sin \frac{1}{2}\left[ {\omega  - \left( {k - \frac{1}{2}} \right)\frac{{2\pi }}{N}} \right]}}{{\rm{e}}^{ - j\frac{{N - 1}}{2}\left[ {\omega  - \left( {k - \frac{1}{2}} \right)\frac{{2\pi }}{N}} \right]}}} \right\}\\
{\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt}  = \frac{1}{{2j}}\left\{ {\frac{{\sin \frac{N}{2}\left[ {\omega  - \left( {k + \frac{1}{2}} \right)\frac{{2\pi }}{N}} \right]}}{{\sin \frac{1}{2}\left[ {\omega  - \left( {k + \frac{1}{2}} \right)\frac{{2\pi }}{N}} \right]}} - \frac{{\sin \frac{N}{2}\left[ {\omega  - \left( {k - \frac{1}{2}} \right)\frac{{2\pi }}{N}} \right]}}{{\sin \frac{1}{2}\left[ {\omega  - \left( {k - \frac{1}{2}} \right)\frac{{2\pi }}{N}} \right]}}{{\rm{e}}^{ - j\frac{{(N - 1)\pi }}{N}}}} \right\}{{\rm{e}}^{ - j\frac{{N - 1}}{2}\left[ {\omega  - \left( {k + \frac{1}{2}} \right)\frac{{2\pi }}{N}} \right]}}
\end{array}$

由于${{\rm{e}}^{ - j\frac{{N - 1}}{N}\pi }} =  - {{\rm{e}}^{j\frac{\pi }{N}}}$，故有

|      | $\begin{array}{l}{H_k}\left( {{e^{j\omega }}} \right) = \left\{ {\frac{1}{2}\frac{{\sin \frac{N}{2}\left[ {\omega  - \left( {k + \frac{1}{2}} \right)\frac{{2\pi }}{N}} \right]}}{{\sin \frac{1}{2}\left[ {\omega  - \left( {k + \frac{1}{2}} \right)\frac{{2\pi }}{N}} \right]}}{e^{ - j\frac{\pi }{{2N}}}} + \frac{1}{2}\frac{{\sin \frac{N}{2}\left[ {\omega  - \left( {k - \frac{1}{2}} \right)\frac{{2\pi }}{N}} \right]}}{{\sin \frac{1}{2}\left[ {\omega  - \left( {k - \frac{1}{2}} \right)\frac{{2\pi }}{N}} \right]}}{e^{j\frac{\pi }{{2N}}}}} \right\}\\{\rm{       }} \times {\kern 1pt} {\kern 1pt} {\kern 1pt} {e^{ - j}}\left\{ {\frac{{N - 1}}{2}\left[ {\omega  - \left( {k + \frac{1}{2}} \right)\frac{{2\pi }}{N}} \right] + \frac{\pi }{2} - \frac{\pi }{{2N}}} \right\}\end{array}$ | (3.8.6) |
| ---- | ------------------------------------------------------------ | ------- |
|      |                                                              |         |

在(3.8.6)式的相位中还应加上面提到过的相位因子才是${H_k}\left( {{{\rm{e}}^{j\omega }}} \right)$的完整表达式。

由(3.8.6)式可见，余弦加权后的频率特性${H_k}\left( {{{\rm{e}}^{j\omega }}} \right)$是由两相邻的中心频率间隔为$2π/N$的矩形窗加权的频率特性矢量合成的。由于$N>1$，故括号内的两个振幅频率特性间的相位差$π/N$很小，因此矢量合成接近于代数相加，如图3.8.1所示。由图可见，这时两个相邻的振幅频率特性的副瓣接近相减。因此通过选择合适的窗函数确实可以压低等效滤波器频率特性副瓣，达到抑制“频谱泄漏”的目的。由图3.8.1还可以看出，加权后还会引起频率特性的主瓣加宽，峰值响应降低的副作用。

我们也可以在离散傅里叶变换式中对输入序列$x\left( n \right)$直接进行加权。这时，合适窗函数的加权作用是使被加权序列在边缘（$n=0$和$n=N-1$附近)比矩形窗函数圆滑而减小了陡峭的边缘所引起的副瓣分量。

<img src=".\fig\3.8.1.png">

图3.8.1对离散傅里叶变换等效滤波器单位采样

响应余弦加权后的频率响应

### **3.8.2.** ***常用的窗函数***

下面讨论几种常用的窗函数及其主要性能指标。各窗函数的幅度响应以分贝形式表示，定义为

|      | ${W_{dB}}\left( \omega  \right) = 20{\log _{10}}\frac{{\left  |  {W\left( {{{\rm{e}}^{j\omega }}} \right)} \right | }}{{W\left( {{{\rm{e}}^{j0}}} \right)}}$ | (3.8.7) |
| ---- | ------------------------------------------------------------ | ------- |
|      |                                                              |         |

$W\left( {{{\rm{e}}^{j\omega }}} \right)$为$w\left( n \right)$的傅里叶变换,$W\left( {{{\rm{e}}^{j0}}} \right)$为该变换的直流值。

**1．** ***矩形窗（Rectangular Window）***

|      | $w\left( n \right) = 1,\quad n =  - \frac{N}{2}, \cdots , - 1,0,1 \cdots \frac{N}{2}$ | (3.8.8) |
| ---- | ------------------------------------------------------------ | ------- |
|      |                                                              |         |

式中$N$为偶数。对序列的截断，实际上就是加矩形窗，其对应的频谱为

|      | $W\left( {{{\rm{e}}^{j\omega }}} \right) = \frac{{\sin \frac{{\left( {N + 1} \right)}}{2}\omega }}{{\sin \frac{\omega }{2}}}$ | (3.8.9) |
| ---- | ------------------------------------------------------------ | ------- |
|      |                                                              |         |

上述窗函数序列长为$N+1$个点。例如取偶数点，即令

|      | $w\left( n \right) = 1,\quad n =  - \frac{N}{2}, \cdots , - 1,0,1 \cdots \frac{N}{2}$ | (3.8.10) |
| ---- | ------------------------------------------------------------ | -------- |
|      |                                                              |          |

对应的谱函数为

|      | $W\left( {{e^{j\omega }}} \right) = {W_R}\left( {{e^{j\omega }}} \right) = \sum\limits_{n =  - \frac{N}{2}}^{\left( {\frac{N}{2} - 1} \right)} {{e^{ - j\omega m}}}  = {e^{j\omega \frac{N}{2}}}\sum\limits_{n = 0}^{N - 1} {{e^{ - j\omega n}}}  = \frac{{\sin \frac{{N\omega }}{2}}}{{\sin \frac{\omega }{2}}}{e^{j\frac{\omega }{2}}}$ | (3.8.11) |
| ---- | ------------------------------------------------------------ | -------- |
|      |                                                              |          |

以后我们就取(3.8.11)式所表示的函数为矩形窗频谱。

如果用幅度函数$W\left( \omega  \right)$与相位函数${{\rm{e}}^{ - j\omega \alpha }}$来表示窗函数的频谱$W\left( {{{\rm{e}}^{j\omega }}} \right)$，即
$W\left( {{{\rm{e}}^{j\omega }}} \right) = W\left( \omega  \right){{\rm{e}}^{ - j\omega \alpha }}$ 则上述窗函数的频谱幅度函数$W\left( \omega  \right)$具有$\frac{{\sin Nx}}{{\sin x}}$的形式，其频谱的主瓣宽度，以两个零交点之间的间隔计算，为
$2 \times \frac{{2\pi }}{N}$,第一副瓣电平比主瓣峰值低13dB左右。图3.8.2示出了矩形窗函数及其对应的频谱函数。本节所述的所有窗函数及其频谱图，都是根据相应的窗函数及其 频谱函数表达式在微机上绘成的。

单边表示的矩形窗函数为

|      | $w\left( n \right) = 1,\quad n = 0,1,2 \cdots N - 1$ | (3.8.12) |
| ---- | ---------------------------------------------------- | -------- |
|      |                                                      |          |

它所对应的频谱函数为

|      | ${W_R}\left( {{{\rm{e}}^{j\omega }}} \right) = \frac{{\sin \frac{{N\omega }}{2}}}{{\sin \frac{\omega }{2}}}{{\rm{e}}^{j\left[ {\frac{{N - 1}}{2}\alpha } \right]}}$ | (3.8.13) |
| ---- | ------------------------------------------------------------ | -------- |
|      |                                                              |          |

可以看出与(3.8.11)式相比，有一个因序列移位$\frac{N}{2}$点所出现的相移因子${{\rm{e}}^{ - j\frac{N}{2}\omega }}$。

***例程3.8.1***

矩形窗

```
L = 51;

w = rectwin(L);

wvtool(w)
```

<img src=".\fig\3.8.2.png"> 

(a) 矩形窗$w\left( n \right)$ (b)$W\left( \omega  \right)$的归一化对数幅度图形

图3.8.2 矩形窗及其频谱幅度宽度

 

**2．** ***三角形窗(Triangular Window)***

三角形窗又称巴持利特(Bartlett)窗。偶对称表达的三角形窗定义为     

|      | $w\left( n \right) = 1.0 - \frac{{|n|}} {{\frac{N}{2}}},\quad n =  - \frac{N}{2}, \cdots , - 1,0,1 \cdots \frac{N}{2}$ | (3.8.14) |
| ---- | ------------------------------------------------------------ | -------- |
|      |                                                              |          |

单边表示的三角形窗定义为 

|      | $w\left( n \right) = \left\{ {\begin{array}{*{20}{c}}{\frac{n}{N}}&{n = 0,1,2, \cdots ,\frac{N}{2}}\\{w\left( {N - n} \right)}&{n = \frac{N}{2},\frac{N}{2} + 1, \cdots N - 1}\end{array}} \right.$ | (3.8.15) |
| ---- | ------------------------------------------------------------ | -------- |
|      |                                                              |          |

它所对应的频谱函数为

|      | $W\left( {{{\rm{e}}^{j\omega }}} \right) = {\left[ {\frac{N}{2}\frac{{\sin \left( {\frac{N}{4}\omega } \right)}}{{\sin \left( {\frac{\omega }{2}} \right)}}} \right]^2}{{\rm{e}}^{ - j\left[ {\left( {\frac{N}{2} - 1} \right)\omega } \right]}}$ | (3.8.16) |
| ---- | ------------------------------------------------------------ | -------- |
|      |                                                              |          |

其零交点之间的主瓣宽度是矩形窗的两倍，第一个副瓣电平比主瓣峰值低26dB左右。三角形窗是最简单的，频谱函数 $W\left( {{e^{j\omega }}} \right)$为非负的一种窗函数。三角形窗序列及其频谱如图3.8.3所示。

***例程3.8.2***

三角窗

```
L = 51;

w = triang(L);

wvtool(w)
```

<img src=".\fig\3.8.3.png"> 

(a)三角形窗$w\left( n \right)$ (b)$W\left( \omega  \right)$的归一化对数幅度图形

图3.8.3 三角形窗及其频谱幅度函数

 

**3．** ***汉宁窗(Hann Window)***

汉宁窗也称余弦平方窗或升余弦窗，其偶对称表示式为 

|      | $\begin{array}{l}w\left( n \right) = {\cos ^2}\left( {\frac{n}{N}\pi } \right)\\{\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt}  = \frac{1}{2}\left[ {1 + \cos \left( {\frac{{2n}}{N}\pi } \right)} \right]\\{\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt}  = \frac{1}{2} + \frac{1}{2}\cos \left( {\frac{{2n}}{N}\pi } \right){\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} n =  - \frac{N}{2} \cdots , - 1,0,1, \cdots  + \frac{N}{2}\end{array}$ | (3.8.17) |
| ---- | ------------------------------------------------------------ | -------- |
|      |                                                              |          |

单边表示为        

|      | $w\left( n \right) = {\sin ^2}\left( {\frac{n}{N}\pi } \right) = \frac{1}{2}\left[ {1 - \cos \left( {\frac{{2n}}{N}\pi } \right)} \right]\quad n = 0,1,2, \cdots ,N - 1$ | (3.8.18) |
| ---- | ------------------------------------------------------------ | -------- |
|      |                                                              |          |

由(3.8.17)式，据欧拉公式可得

|      | $\begin{array}{l}w\left( n \right) = \frac{1}{2} + \frac{1}{2}\left( {\frac{1}{2}{{\rm{e}}^{j\frac{{2n}}{N}\pi }} + \frac{1}{2}{{\rm{e}}^{ - j\frac{{2n}}{N}\pi }}} \right)\\{\rm{    }}{\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt}  = \frac{1}{2} + \frac{1}{4}{{\rm{e}}^{j\frac{{2n}}{N}\pi }} + \frac{1}{4}{{\rm{e}}^{ - j\frac{{2n}}{N}\pi }}\end{array}$ | (3.8.19) |
| ---- | ------------------------------------------------------------ | -------- |
|      |                                                              |          |

已知矩形窗的频谱函数是           

|      | $w\left( n \right) = 1 \leftrightarrow {W_R}\left( {{{\rm{e}}^{ - j\omega }}} \right) = \frac{{\sin \left( {\frac{{N\omega }}{2}} \right)}}{{\sin \left( {\frac{\omega }{2}} \right)}}{e^{j\frac{\omega }{2}}}$ | (3.8.20) |
| ---- | ------------------------------------------------------------ | -------- |
|      |                                                              |          |

由变换的频移定理可          

|      | $\left\{ {\begin{array}{*{20}{c}}{w\left( n \right) = 1 \cdot {{\rm{e}}^{j\frac{{2\pi }}{N}n}} \leftrightarrow {W_R}\left[ {{{\rm{e}}^{j\left( {\omega  - \frac{{2\pi }}{N}} \right)}}} \right]}\\{w\left( n \right) = 1 \cdot {{\rm{e}}^{ - j\frac{{2\pi }}{N}n}} \leftrightarrow {W_R}\left[ {{{\rm{e}}^{j\left( {\omega  + \frac{{2\pi }}{N}} \right)}}} \right]}\end{array}} \right.$ | (3.8.21) |
| ---- | ------------------------------------------------------------ | -------- |
|      |                                                              |          |

将频谱函数表达为

|      | $W\left( {{{\rm{e}}^{j\omega }}} \right) = W\left( \omega  \right){{\rm{e}}^{ - j\omega \alpha }}$ |      |
| ---- | ------------------------------------------------------------ | ---- |
|      |                                                              |      |

这样，利用上述关系可以得到用矩形窗的频谱幅度函数${W_R}\left( \omega  \right)$来表示偶对称式汉宁窗的频谱函数为     

|      | $W\left( \omega  \right) \approx \frac{1}{2}{W_R}\left( \omega  \right) + \frac{1}{4}{W_R}\left( {\omega  - \frac{{2\pi }}{N}} \right) + \frac{1}{4}{W_R}\left( {\omega  + \frac{{2\pi }}{N}} \right)$ | (3.8.22) |
| ---- | ------------------------------------------------------------ | -------- |
|      |                                                              |          |

这个频谱特性如图3.8.4 (a)，(b)所示，是由三个互有频移的不同幅值的矩形窗频谱幅度函数相加而成，这将使副瓣大为抵消，能量更有效的集中在主瓣内，但却使主瓣加宽了一倍。

<img src=".\fig\3.8.4.png"> 

图3.8.4 汉宁窗频谱

(a)三个矩形窗幅度谱的叠加 (b)汉宁窗谱$W(\omega )$主瓣

 

把$N$点偶对称表示的汉宁窗函数右移$N/2$点，可得单边表示的汉宁窗，其对应的频谱函数为

|      | $\begin{array}{l}W\left( {{{\rm{e}}^{j\omega }}} \right) = \frac{1}{2}{W_R}\left( \omega  \right){{\rm{e}}^{ - j\frac{N}{2}\omega }} + \frac{1}{4}{W_R}\left( {\omega  - \frac{{2\pi }}{N}} \right){{\rm{e}}^{ - j\frac{N}{2}\left( {\omega  - \frac{{2\pi }}{N}} \right)}} + \frac{1}{4}{W_R}\left( {\omega  + \frac{{2\pi }}{N}} \right){{\rm{e}}^{ - j\frac{N}{2}\left( {\omega  + \frac{{2\pi }}{N}} \right)}}\\{\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt}  = \left[ {\frac{1}{2}{W_R}\left( \omega  \right) + \frac{1}{4}{W_R}\left( {\omega  - \frac{{2\pi }}{N}} \right) + \frac{1}{4}{W_R}\left( {\omega  + \frac{{2\pi }}{N}} \right)} \right]{{\rm{e}}^{ - j\frac{N}{2}\omega }}\end{array}$ | (3.8.23) |
| ---- | ------------------------------------------------------------ | -------- |
|      |                                                              |          |

注意，与偶对称表示的汉宁加权的不同，(3.8.23)式中两个频移的矩形窗幅度函数前的符号是负的。

在离散傅里叶变换中，直接实现对输入序列$x(n)$的汉宁窗加权时，可不在时域进行$x(n)$与$w(n)$相乘，而在输出的频谱序列$X(k)$上进行线性组合来实现。已知汉宁加权后的离散傅里叶变换${X_W}\left( k \right)$为

|      | $\begin{array}{l}{X_W}(k) = \sum\limits_{n = 0}^{N - 1} {w\left( n \right)x\left( n \right){{\rm{e}}^{ - j\left( {\frac{{2\pi }}{N}} \right)kn}}} \\{\rm{     }}{\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt}  = \sum\limits_{n = 0}^{N - 1} {\left[ {\frac{1}{2} - \frac{1}{4}{e^{j\frac{{2\pi }}{N}n}} - \frac{1}{4}{e^{ - j\frac{{2\pi }}{N}n}}} \right]x\left( n \right){{\rm{e}}^{ - j\left( {\frac{{2n}}{N}} \right)kn}}} \\{\rm{     }}{\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt}  = \frac{1}{2}\sum\limits_{n = 0}^{N - 1} {x\left( n \right){{\rm{e}}^{ - j{{\left( {\frac{{2\pi }}{N}} \right)}^{kn}}}}}  - \frac{1}{4}\sum\limits_{n = 0}^{N - 1} {x\left( n \right){{\rm{e}}^{ - j\left( {\frac{{2n}}{N}} \right)\left( {k - 1} \right)n}}}  - \frac{1}{4}\sum\limits_{n = 0}^{N - 1} {x\left( n \right){{\rm{e}}^{ - j\left( {\frac{{2\pi }}{N}} \right)\left( {k + 1} \right)n}}} \end{array}$ | (3.8.24) |
| ---- | ------------------------------------------------------------ | -------- |
|      |                                                              |          |

由上式可知，汉宁窗加权的离散傅里叶变换输出${X_W}\left( k \right)$是矩形窗加权的离散傅里叶变换$X(k)$的线性组合，即        

|      | $\begin{array}{l}{X_W}\left( k \right) = \frac{1}{2}X\left( k \right) - \frac{1}{4}X\left( {k - 1} \right) - \frac{1}{4}X\left( {k + 1} \right)\\{\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt}  = \frac{1}{2}\left\{ {X\left( k \right) - \frac{1}{2}\left[ {X\left( {k - 1} \right) + X\left( {k + 1} \right)} \right]} \right\}\end{array}$ | (3.8.25) |
| ---- | ------------------------------------------------------------ | -------- |
|      |                                                              |          |

这种输出$X(k)$的组合需要附加$2N$次复加及$2N$次右移(实现乘$1/2$)操作来实现。汉宁窗加权的这些特点，在快速离散傅里叶变换运算中特別受到注意。

其实，汉宁窗是一族窗函数中的一个，这族窗函数的偶对称表示式为        

|      | $w\left( n \right) = {\cos ^\alpha }\left( {\frac{{n\pi }}{N}} \right)\quad n =  - \frac{N}{2} \cdots , - 1,0,1, \cdots \frac{N}{2}$ | (3.8.26) |
| ---- | ------------------------------------------------------------ | -------- |
|      |                                                              |          |

单边表示为         

|      | $w\left( n \right) = {\sin ^\alpha }\left( {\frac{{n\pi }}{N}} \right)\quad n = 0,1,2, \cdots N - 1$ | (3.8.27) |
| ---- | ------------------------------------------------------------ | -------- |
|      |                                                              |          |

一般取$\alpha  = 1,2,3,4$。当$\alpha  = 1$时，就是我们前面遇到的余弦窗。$\alpha  = 2$，就是上面介绍的汉宁窗。当$\alpha $越大时，窗函数${\cos ^\alpha }\left( x \right)$序列越平滑，对应的频谱函数的副瓣电平就越下降，副瓣跌落越快速。但主瓣则变得越来越宽。图3.8.5示出了余弦窗及其频谱。图3.8.6示出了汉宁窗及其频谱。

***例程3.8.3***

余弦窗

```
L = 51;

r = 1; % r = 2时 就是余弦窗

w = tukeywin(L,r);

wvtool(w)
```

<img src=".\fig\3.8.5.png"> 

$W\left( \omega  \right)$的归一化对数幅度图形

图3.8.5 余弦窗及其频谱幅度函数

 

***例程3.8.4***

汉宁窗

```
L = 51;

w = hann(L);

wvtool(w)
```

<img src=".\fig\3.8.6.png"> 

$W\left( \omega  \right)$的归一化对数幅度图形

图3.8.6 汉宁窗及其幅度频谱函数



**4．** ***海明窗(Hamming Window)***

海明窗也称改进的升余弦窗。受汉宁窗启发，可设法调整相邻矩形窗频谱的大小以更好地获取副瓣相消，为此可设加权窗函数为

|      | $w\left( n \right) = \alpha  + \left( {1 - \alpha } \right)\cos \left( {\frac{{2\pi }}{N}n} \right)$ | (3.8.28) |
| ---- | ------------------------------------------------------------ | -------- |
|      |                                                              |          |

对应的频谱函数为   

|      | $W\left( \omega  \right) = \alpha {W_R}\left( \omega  \right) + \frac{1}{2}\left( {1 - \alpha } \right)\left[ {{W_R}\left( {\omega  - \frac{{2\pi }}{N}} \right) + {W_R}\left( {\omega  + \frac{{2\pi }}{N}} \right)} \right]$ | (3.8.29) |
| ---- | ------------------------------------------------------------ | -------- |
|      |                                                              |          |

改变可调整的比例系数$\alpha $就可改变相邻三个矩形窗频谱幅度的大小，若选$\alpha  = 0.54$，就是所谓 “海明窗”可使副瓣电平有显著的改善。

海明窗的偶对称表示为    

|      | $w\left( n \right) = 0.54 + 0.46\cos \left( {\frac{{2\pi }}{N}n} \right)\quad n =  - \frac{N}{2}, \cdots  - 1,0,1, \cdots ,\frac{N}{2}$ | (3.8.30) |
| ---- | ------------------------------------------------------------ | -------- |
|      |                                                              |          |

单边表示为

|      | $w\left( n \right) = 0.54 - 0.46\cos \left( {\frac{{2\pi }}{N}n} \right)\quad n = 0.1,2, \cdots ,N - 1$ | (3.8.31) |
| ---- | ------------------------------------------------------------ | -------- |
|      |                                                              |          |

所得到的频谱幅度函数为

|      | $W\left( \omega  \right) = 0.54{W_R}\left( \omega  \right) + 0.23\left[ {{W_R}\left( {\omega  - \frac{{2\pi }}{N}} \right) + {W_R}\left( {\omega  + \frac{{2\pi }}{N}} \right)} \right]$ | (3.8.32) |
| ---- | ------------------------------------------------------------ | -------- |
|      |                                                              |          |

结果达到99. 96%的能量集中在主瓣内，在与汉宁窗相等的主瓣宽度下,获得了更好的副瓣抑制。若选$\alpha $=0.53856,则副瓣电平是-43dB。图3.8.7示出了海明窗及其频谱，可以看到，在第一副瓣处出现了很深的凹陷。

海明加权后的离散傅里叶变换也可用$X(k)$来表达

|      | ${X_w}\left( k \right) = 0.54X\left( k \right) - 0.23\left[ {X\left( {k - 1} \right) + X\left( {k - 1} \right)} \right]$ | (3.8.33) |
| ---- | ------------------------------------------------------------ | -------- |
|      |                                                              |          |

它不能像汉宁窗那洋用简单的右移来代替与系数作乘法，而需做实数乘复数的乘法。

***例程3.8.5***

海明窗

```
L = 51;

w = hamming(L);

wvtool(w)
```

 

<img src=".\fig\3.8.7.png"> 

图3.8.7 海明窗及其幅度频谱函数

 

**5．** ***布拉克曼窗(Blackman Window)***

布拉克曼窗也称二阶升余弦窗。汉宁、海明加权都是由三个中心频率不同的矩形窗频谱线性组合而成。布拉克曼利用更多的矩形窗频谱线性组合构成布拉克曼窗，其偶对称表示为

|      | $w\left( n \right) = \sum\limits_{m = 0}^{K - 1} {{a_m}} \cos \left( {\frac{{2\pi }}{N}mn} \right)\quad n =  - \frac{N}{2}, \cdots , - 1,0,1 \cdots \frac{N}{2}$ | (3.8.34) |
| ---- | ------------------------------------------------------------ | -------- |
|      |                                                              |          |

单边表示

|      | $w\left( n \right) = \sum\limits_{m = 0}^{K - 1} {{{( - 1)}^m}{a_m}\cos \left( {\frac{{2\pi }}{N}mn} \right)} \quad n = 0,1,2 \cdots N - 1$ | (3.8.35) |
| ---- | ------------------------------------------------------------ | -------- |
|      |                                                              |          |

单边表示的布拉克曼窗幅度频谱函数为

|      | $W\left( \omega  \right) = \sum\limits_{m = 0}^{K - 1} {{{( - 1)}^m}\frac{{{a_m}}}{2}\left[ {{W_R}\left( {\omega  - \frac{{2\pi }}{N}m} \right) + {W_R}\left( {\omega  + \frac{{2\pi }}{N}m} \right)} \right]} $ | (3.8.36) |
| ---- | ------------------------------------------------------------ | -------- |
|      |                                                              |          |

这个窗函数中系数的选择应满足以下约束条件

|      | $\sum\limits_{m = 0}^{K - 1} {{a_m}}  = 1.0$ | (3.8.37) |
| ---- | -------------------------------------------- | -------- |
|      |                                              |          |

因此，汉宁、海明窗是${a_0},{a_1}$不为零，而其它系数都为零的布拉克曼窗。假如布拉克曼窗有$K$个非零的系数${a_m}$，则其振幅频谱将由($2K - 1$)个中心频率不同的矩形窗频谱线性组合而成。显然，要使窗函数频谱的主瓣宽度窄，则$K$值不能选得很大。布拉克曼找到($K=3$)时在$\omega  = 3.5(2\pi /N)$及$\omega  = 4.5(2\pi /N)$处出现零点的窗序列系数${a_m}$，其准确值及近似值如下式所示

|      | $\left. \begin{array}{l}{a_0} = \frac{{7938}}{{18608}} \approx 0.42\\{a_1} = \frac{{9240}}{{18608}} \approx 0.5\\{a_2} = \frac{{1430}}{{18608}} \approx 0.08\end{array} \right\}$ | (3.8.38) |
| ---- | ------------------------------------------------------------ | -------- |
|      |                                                              |          |

按照 (3.8.38) 式的系数近似得出的窗函数，称为布拉克曼窗，其偶对称表示

|      | $\begin{array}{l}w\left( n \right) = 0.42 + 0.50\cos \left( {\frac{{2\pi }}{N}n} \right) + 0.08\cos \left( {\frac{{2\pi }}{N}2n} \right)\\{\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} n =  - \frac{N}{2}, \cdots , - 1,0,1 \cdots \frac{N}{2}\end{array}$ | (3.8.39) |
| ---- | ------------------------------------------------------------ | -------- |
|      |                                                              |          |

单边表示

|      | $\begin{array}{l}w\left( n \right) = 0.42 - 0.50\cos \left( {\frac{{2\pi }}{N}n} \right) + 0.08\cos \left( {\frac{{2\pi }}{N}2n} \right)\\{\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} n = 0,1,2, \cdots  \cdot N - 1\end{array}$ | (3.8.40) |
| ---- | ------------------------------------------------------------ | -------- |
|      |                                                              |          |

单边表示的频谱幅度函数为

|      | $\begin{array}{l}W\left( \omega  \right) = 0.42{W_R}\left( \omega  \right) + 0.25\left[ {{W_R}\left( {\omega  - \frac{{2\pi }}{N}} \right) + {W_R}\left( {\omega  + \frac{{2\pi }}{N}} \right)} \right] + \\{\rm{             }}0.04\left[ {{W_R}\left( {\omega  - \frac{{4\pi }}{N}} \right) + {W_R}\left( {\omega  + \frac{{4\pi }}{N}} \right)} \right]\end{array}$ | (3.8.41) |
| ---- | ------------------------------------------------------------ | -------- |
|      |                                                              |          |

这样可以得到更低的副瓣，但主瓣宽度却进一步加宽到矩形窗的三倍。

用准确的系数构成的窗函数，称之为“准确的”布拉克曼窗。图3.8.8、3.8.9分别示出了布拉克曼窗和“准确的”布拉克曼窗，以及它们的频谱函数。布拉克曼窗的副瓣电平为-58dB。“准确的”布拉克曼窗的副瓣电平却为-51dB。-66dB？

***例程3.8.6***

布拉克曼窗

```
L = 51;

w = blackman(L);

wvtool(w)
```



<img src=".\fig\3.8.8.png"> 

$(a)$布拉克曼窗$w\left( n \right)$ $(b)$$W\left( \omega  \right)$的归一化对数幅度图形

图3.8.8 布拉克曼窗及其幅度频谱函数

<img src=".\fig\3.8.9.png"> 

$(a)$ “准确的”布拉克曼窗$w\left( n \right)$ $(b)$ $W\left( \omega  \right)$的归一化对数幅度图形

图3.8.9  “准确的”布拉克曼窗及其频谱幅度函数

 

哈利斯(Harris)曾找到了布拉克曼窗的一组三项及四项非零系数，如表3.8.1所示。由这些系数所构成的窗函数称为布拉克曼—哈利斯窗，可获得很小的副瓣电平。图3.8.10 及图3.8.11 分别示出了三项系数及四项系数时的布拉克曼—哈利斯窗及其频谱函数。布拉克曼—哈利斯窗取三项系数时可得最大副瓣电平为-67dB，取四项系数时可得最大副瓣电平为-92dB。

|              | ${a_m}$***系数值*** | ***表3.8.1*** |
| ------------ | ------------------- | ------------- |
| 最大副瓣电平 | 三 项 系 数         | 四 项 系 数   |
| -67dB        | -92dB               |               |
| ${a_0}$      | 0.42323             | 0.35875       |
| ${a_1}$      | 0.49755             | 0.48829       |
| ${a_2}$      | 0.07922             | 0.14128       |
| ${a_3}$      |                     | 0.01168       |

 

***例程3.8.7***

布拉克曼—哈利斯窗

```
L = 51;

w = blackmanharris(L);

% a = [0.35875 0.48829 0.14128 0.01168]; % 取四项系数

% a = [0.42323 0.49755 0.07922 0]; %取三项系数

wvtool(w)
```

<img src=".\fig\3.8.10.png"> 

$(a)$ 三项系数布拉克曼—哈利斯窗$w\left( n \right)$ $W\left( \omega  \right)$的归一化对数幅度图形

图3.8.10 三项系数布拉克曼—哈利斯窗及其频谱幅度函数 

<img src=".\fig\3.8.11.png"> 

$(a)$ 四项系数布拉克曼—哈利斯窗$w\left( n \right)$$(b)$ $W\left( \omega  \right)$的归一化对数幅度图形

图3.8.11 四项系数布拉克曼—哈利斯窗及其频谱幅度函数

 

**6．** ***最优化窗*** 

这是指在某种优化准则下得出的窗函数。

\1) 高斯窗(Gaussian Window)

已经知道，任何一种信号时宽$T$、频宽$W$之积$TW$满足下式

|      | $TW \ge \frac{1}{{4\pi }}$ | (3.8.42) |
| ---- | -------------------------- | -------- |
|      |                            |          |

在最小时宽频宽积即($TW = \frac{1}{{4\pi }}$​)的优化准则下得出的是高斯波形，因此，可选择高斯波形作窗函数。高斯波形是一直延伸到无穷大去的，但是若在波形三倍均方值的地方进行截断, 则误差很小。高斯窗如下式所示

|      | $w\left( n \right) = {e^{ - \frac{1}{2}{{\left[ {a\frac{n}{{{N \mathord{\left/{\vphantom {N 2}} \right.} 2}}}} \right]}^{\rm{2}}}}}{\rm{     }}0 \le \left| n \right| \le \frac{{N - 1}}{2}$ | (3.8.43) |
| ---- | ------------------------------------------------------------ | -------- |
|      |                                                              |          |

有限列长的高斯形窗相当于高斯形窗与矩形窗相乘。因此，有限列长的高斯形窗的频谱函数应是高斯窗频谱与矩形窗频谱的卷积，即

|      | $\begin{array}{l}W\left( \omega  \right) = \frac{1}{2}\frac{{\sqrt {2\pi } }}{a}{{\rm{e}}^{ - \frac{1}{2}{{\left[ {\frac{\omega }{a}} \right]}^2}}}*{W_R}\left( \omega  \right)\\{\rm{         }} \approx \frac{N}{2}\frac{{\sqrt {2\pi } }}{a}{{\rm{e}}^{ - \frac{1}{2}{{\left[ {\frac{\omega }{a}} \right]}^2}}}{\rm{   }}a > 2.5,\omega \end{array}$ | (3.8.44) |
| ---- | ------------------------------------------------------------ | -------- |
|      |                                                              |          |

$a$是标准差值的倒数，是频谱宽度的一种度量。图3.8.12为$a = 3$时的高斯窗及其频谱。

 

***例程3.8.8***

高斯窗

```
L = 51;

a = 3;

w = gausswin(L, a);

wvtool(w)
```

<img src=".\fig\3.8.12.png"> 

$(a)$ 高斯窗$w\left( n \right)$ $(b)$ $W\left( \omega  \right)$的归一化对数幅度图形

图3.8.12 $a=3$时的高斯窗及其频谱幅度函数

 

2) 凯塞窗(Kaiser Window)

凯塞窗的最优化准则是：对于有限的信号能量，要求确定一个有限时宽$T$的信号波形，它使得频宽$W$内的能量为最大。凯塞窗的定义如下

|      | $w\left( n \right) = \frac{{{I_0}\left[ {\pi a\sqrt {1.0 - {{\left( {\frac{n}{{N/2}}} \right)}^2}} } \right]}}{{{I_0}\left( {\pi a} \right)}}{\rm{      }}0 \le \left|  n \right| \le \frac{N}{2}$ | (3.8.45) |
| ---- | ------------------------------------------------------------ | -------- |
|      |                                                              |          |

式中${I_0}\left( x \right) = 1 + \sum\limits_{k = 1}^\infty  {{{\left[ {\frac{1}{{k!}}{{\left( {\frac{x}{2}} \right)}^k}} \right]}^2}} $是零阶第一类修正贝塞尔函数。凯塞—贝塞尔窗的频谱幅度函数可近似为

|      | $W\left( \omega  \right) \approx \frac{N}{{{I_0}(a\pi )}}\frac{{{\mathop{\rm sh}\nolimits} \left[ {\sqrt {{a^2}{\pi ^2} - {{\left( {\frac{{N\omega }}{2}} \right)}^2}} } \right]}}{{\sqrt {{a^2}{\pi ^2} - {{\left( {\frac{{N\omega }}{2}} \right)}^2}} }}$ | (3.8.46) |
| ---- | ------------------------------------------------------------ | -------- |
|      |                                                              |          |

上面公式中的$\pi a$是时宽、频宽积的一半。

 

***例程3.8.9***

凯塞窗

```
L = 51;

w = kaiser(L, 2.5);

wvtool(w)
```

<img src=".\fig\3.8.13.png"> 

$(a)$ 凯塞窗$w\left( n \right)$ $(b)$ $W\left( \omega  \right)$的归一化对数幅度图形

图3.8.13 $\beta  = 2.5$时的凯塞窗及其频谱幅度函数

至此，我们结束关于离散傅里叶变换的讨论。至于二维离散傅里叶变换，限于篇幅本章未作介绍。但在掌握一维离散傅里叶变换的基础上，参阅有关文献，读者是不难掌握二维离散傅里叶变换的。

除离散傅里叶变换外，还有其它一些变换，如沃尔什变换，数论变换等。它们与离散傅里叶变换相比，都有局限性，只适用于某些场合，而且不易估计误差。至今离散傅里叶变换仍是数字信号处理中最重要和最基本的变换。限于篇幅对沃尔什变换也就不作介绍了。

 

## ***小结***

本章首先总结和讨论了傅里叶变换的所有可能形式，并在此基础上引出了离散傅里叶级数，讨论了它的有关性质（这是为讨论离散傅里叶变换性质服务的）。再根据有限长序列和周期序列间的关系导出了有限长序列的傅里叶变换表示式——离散傅里叶变换。详细讨论了离散傅里叶变换的性质和利用离散傅里叶变换实现线性卷积时要考虑的因素。对这些性质的深刻理解和掌握可使我们更好的理解离散傅里叶变换，使其在数字信号处理中获得更好的更广泛的应用。在介绍$z$变换与$DFT$关系的基础上，讨论了频率采样理论。我们还将离散傅里叶变换看作连续傅里叶变换的近似，指出了在逼近中存在的问题：（1）它们相对数值的确定；（2)造成误差的三种可能现象：混叠现象、栅栏效应、频谱泄露。提出了解决这些问题的办法，特别是针对抑制“泄露”提出了窗函数加权技术，介绍了各种常用窗函数的特性。这就进一步使离散傅里叶变换理论与其在数字信号处理实际运用中的问题紧密相连。窗函数加权技术在数字信号处理的其它方面也得到了广泛的应用。

傅里叶变换建立了连续时域与连续频域之间的联系，而离散傅里叶变换则建立了离散时域与离散频域之间的联系，在性质方面它们也十分相似。

时域信号的采样造成了频域信号的周期延拓，同样，频域信号的采样也造成时域信号的周期延拓，且一个域中两采样点间增量的倒数，必是另一域中函数的周期。这些概念在数字信号处理中是十分重要的，应很好记住。

傅里叶变换在连续时间信号处理中主要起解析工具的作用，而离散傅里叶变换则不但能起解析工具的作用，而且适合于电子计算机进行计算。特别如本章一开始就提出的，由于存着快速计算离散傅里叶变换算法——$FFT$，而使离散傅里叶变换在实现各种数字信号处理方法中扮演着重要角色。

 





